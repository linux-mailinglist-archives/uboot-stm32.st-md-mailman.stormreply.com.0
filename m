Return-Path: <uboot-stm32-bounces@st-md-mailman.stormreply.com>
X-Original-To: lists+uboot-stm32@lfdr.de
Delivered-To: lists+uboot-stm32@lfdr.de
Received: from stm-ict-prod-mailman-01.stormreply.prv (st-md-mailman.stormreply.com [52.209.6.89])
	by mail.lfdr.de (Postfix) with ESMTPS id A291DCE3A2
	for <lists+uboot-stm32@lfdr.de>; Mon,  7 Oct 2019 15:29:43 +0200 (CEST)
Received: from ip-172-31-3-76.eu-west-1.compute.internal (localhost [127.0.0.1])
	by stm-ict-prod-mailman-01.stormreply.prv (Postfix) with ESMTP id 6B7B0C36B0B
	for <lists+uboot-stm32@lfdr.de>; Mon,  7 Oct 2019 13:29:43 +0000 (UTC)
Received: from mx07-00178001.pphosted.com (mx08-00178001.pphosted.com
 [91.207.212.93])
 (using TLSv1.2 with cipher ECDHE-RSA-AES256-GCM-SHA384 (256/256 bits))
 (No client certificate requested)
 by stm-ict-prod-mailman-01.stormreply.prv (Postfix) with ESMTPS id 19C57C36B0C
 for <uboot-stm32@st-md-mailman.stormreply.com>;
 Mon,  7 Oct 2019 13:29:42 +0000 (UTC)
Received: from pps.filterd (m0046661.ppops.net [127.0.0.1])
 by mx08-00178001.pphosted.com (8.16.0.42/8.16.0.42) with SMTP id
 x97DKqtl011745; Mon, 7 Oct 2019 15:29:36 +0200
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=st.com;
 h=from : to : subject :
 date : message-id : in-reply-to : references : mime-version : content-type
 : content-transfer-encoding; s=STMicroelectronics;
 bh=Brez9250gVgbbYyxzSbYfckNocVqUbLc4IkC99TZHc4=;
 b=bCNsv6bK3Z695J6FCRE5EcUvZq95e70xz9pux8eMJ9AQCKHcE6Yrr1bzfSyNzcXzX3Q8
 9OcrGPvyLIgsYB8gfKgjwe/uMBktlVhQnrHI2/fLmMqpNQF73zbqA/KQrXkpYOVkK/8G
 x/8ILlvKx9AbFiB2RZhTSxXtnPnF775qlBJHX9FJ+H7fBPBgsSaoH3d7W/27u5it3Ut/
 E/dVPgS9F3d8WuuNxjrIE+gDOQfPlVJYaMNSJ0tftestHHLfRJgDNk12HZCSYgaFOLZw
 wBaYjX6Jh8KXc/5xGbk39bsINrFUWixXcsR5xtPJGuBuZ1o7syKUN5A6ZvR6XlZuodq8 XA== 
Received: from beta.dmz-eu.st.com (beta.dmz-eu.st.com [164.129.1.35])
 by mx08-00178001.pphosted.com with ESMTP id 2vej2p2jjt-1
 (version=TLSv1.2 cipher=ECDHE-RSA-AES256-GCM-SHA384 bits=256 verify=NOT);
 Mon, 07 Oct 2019 15:29:36 +0200
Received: from euls16034.sgp.st.com (euls16034.sgp.st.com [10.75.44.20])
 by beta.dmz-eu.st.com (STMicroelectronics) with ESMTP id CF07510002A;
 Mon,  7 Oct 2019 15:29:35 +0200 (CEST)
Received: from Webmail-eu.st.com (Safex1hubcas21.st.com [10.75.90.44])
 by euls16034.sgp.st.com (STMicroelectronics) with ESMTP id C37EE2BFDF5;
 Mon,  7 Oct 2019 15:29:35 +0200 (CEST)
Received: from SAFEX1HUBCAS22.st.com (10.75.90.93) by SAFEX1HUBCAS21.st.com
 (10.75.90.44) with Microsoft SMTP Server (TLS) id 14.3.439.0; Mon, 7 Oct 2019
 15:29:35 +0200
Received: from localhost (10.201.23.97) by Webmail-ga.st.com (10.75.90.48)
 with Microsoft SMTP Server (TLS) id 14.3.439.0; Mon, 7 Oct 2019 15:29:34
 +0200
From: =?UTF-8?q?Yannick=20Fertr=C3=A9?= <yannick.fertre@st.com>
To: Vikas Manocha <vikas.manocha@st.com>, Benjamin Gaignard
 <benjamin.gaignard@st.com>, Albert Aribaud <albert.u.boot@aribaud.net>,
 Patrick Delaunay <patrick.delaunay@st.com>,
 Simon Glass <sjg@chromium.org>, Anatolij Gustschin <agust@denx.de>,
 Patrice Chotard <patrice.chotard@st.com>,
 Yannick Fertre <yannick.fertre@st.com>, Philippe Cornu
 <philippe.cornu@st.com>, Jens Wiklander <jens.wiklander@linaro.org>, "Eugen
 Hristev" <eugen.hristev@microchip.com>, Heinrich Schuchardt
 <xypron.glpk@gmx.de>, Simon Goldschmidt <simon.k.r.goldschmidt@gmail.com>,
 <u-boot@lists.denx.de>, <uboot-stm32@st-md-mailman.stormreply.com>
Date: Mon, 7 Oct 2019 15:29:06 +0200
Message-ID: <1570454955-21298-7-git-send-email-yannick.fertre@st.com>
X-Mailer: git-send-email 2.7.4
In-Reply-To: <1570454955-21298-1-git-send-email-yannick.fertre@st.com>
References: <1570454955-21298-1-git-send-email-yannick.fertre@st.com>
MIME-Version: 1.0
X-Originating-IP: [10.201.23.97]
X-Proofpoint-Virus-Version: vendor=fsecure engine=2.50.10434:6.0.95,1.0.8
 definitions=2019-10-07_02:2019-10-07,2019-10-07 signatures=0
Subject: [Uboot-stm32] [PATCH v5 06/15] video: add MIPI DSI host controller
	bridge
X-BeenThere: uboot-stm32@st-md-mailman.stormreply.com
X-Mailman-Version: 2.1.15
Precedence: list
List-Id: <uboot-stm32.st-md-mailman.stormreply.com>
List-Unsubscribe: <https://st-md-mailman.stormreply.com/mailman/options/uboot-stm32>, 
 <mailto:uboot-stm32-request@st-md-mailman.stormreply.com?subject=unsubscribe>
List-Archive: <http://st-md-mailman.stormreply.com/pipermail/uboot-stm32/>
List-Post: <mailto:uboot-stm32@st-md-mailman.stormreply.com>
List-Help: <mailto:uboot-stm32-request@st-md-mailman.stormreply.com?subject=help>
List-Subscribe: <https://st-md-mailman.stormreply.com/mailman/listinfo/uboot-stm32>, 
 <mailto:uboot-stm32-request@st-md-mailman.stormreply.com?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: uboot-stm32-bounces@st-md-mailman.stormreply.com
Sender: "Uboot-stm32" <uboot-stm32-bounces@st-md-mailman.stormreply.com>

QWRkIGEgU3lub3BzeXMgRGVzaWdud2FyZSBNSVBJIERTSSBob3N0IGJyaWRnZSBkcml2ZXIsIGJh
c2VkIG9uIHRoZQpSb2NrY2hpcCB2ZXJzaW9uIGZyb20gcm9ja2NoaXAvZHctbWlwaS1kc2kuYyB3
aXRoIHBoeSAmIGJyaWRnZSBBUElzLgoKU2lnbmVkLW9mZi1ieTogWWFubmljayBGZXJ0csOpIDx5
YW5uaWNrLmZlcnRyZUBzdC5jb20+Ci0tLQogZHJpdmVycy92aWRlby9LY29uZmlnICAgICAgIHwg
IDEwICsKIGRyaXZlcnMvdmlkZW8vTWFrZWZpbGUgICAgICB8ICAgMSArCiBkcml2ZXJzL3ZpZGVv
L2R3X21pcGlfZHNpLmMgfCA4MzggKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysr
KysrKysrKysKIDMgZmlsZXMgY2hhbmdlZCwgODQ5IGluc2VydGlvbnMoKykKIGNyZWF0ZSBtb2Rl
IDEwMDY0NCBkcml2ZXJzL3ZpZGVvL2R3X21pcGlfZHNpLmMKCmRpZmYgLS1naXQgYS9kcml2ZXJz
L3ZpZGVvL0tjb25maWcgYi9kcml2ZXJzL3ZpZGVvL0tjb25maWcKaW5kZXggY2RhZjYxNi4uZmRj
YjAzYyAxMDA2NDQKLS0tIGEvZHJpdmVycy92aWRlby9LY29uZmlnCisrKyBiL2RyaXZlcnMvdmlk
ZW8vS2NvbmZpZwpAQCAtNjk3LDYgKzY5NywxNiBAQCBjb25maWcgVklERU9fRFNJX0hPU1RfU0FO
REJPWAogCSAgYSBjb21tdW5pY2F0aW9uIHByb3RvY29sIGJldHdlZW4gdGhlIGhvc3QgYW5kIHRo
ZSBkZXZpY2UKIAkgIChwYW5lbCwgYnJpZGdlKS4KIAorY29uZmlnIFZJREVPX0RXX01JUElfRFNJ
CisJYm9vbAorCXNlbGVjdCBWSURFT19NSVBJX0RTSQorCWhlbHAKKwkgIEVuYWJsZXMgdGhlIGNv
bW1vbiBkcml2ZXIgY29kZSBmb3IgdGhlIFN5bm9wc2lzIERlc2lnbndhcmUKKwkgIE1JUEkgRFNJ
IGJsb2NrIGZvdW5kIGluIFNvQ3MgZnJvbSB2YXJpb3VzIHZlbmRvcnMuCisJICBBcyB0aGlzIGRv
ZXMgbm90IHByb3ZpZGUgYW55IGZ1bmN0aW9uYWxpdHkgYnkgaXRzZWxmIChidXQKKwkgIHJhdGhl
ciByZXF1aXJlcyBhIFNvQy1zcGVjaWZpYyBnbHVlIGRyaXZlciB0byBjYWxsIGl0KSwgaXQKKwkg
IGNhbiBub3QgYmUgZW5hYmxlZCBmcm9tIHRoZSBjb25maWd1cmF0aW9uIG1lbnUuCisKIGNvbmZp
ZyBWSURFT19TSU1QTEUKIAlib29sICJTaW1wbGUgZGlzcGxheSBkcml2ZXIgZm9yIHByZWNvbmZp
Z3VyZWQgZGlzcGxheSIKIAloZWxwCmRpZmYgLS1naXQgYS9kcml2ZXJzL3ZpZGVvL01ha2VmaWxl
IGIvZHJpdmVycy92aWRlby9NYWtlZmlsZQppbmRleCAwN2FhY2E5Li4wZDM1NDcwIDEwMDY0NAot
LS0gYS9kcml2ZXJzL3ZpZGVvL01ha2VmaWxlCisrKyBiL2RyaXZlcnMvdmlkZW8vTWFrZWZpbGUK
QEAgLTQ1LDYgKzQ1LDcgQEAgb2JqLSQoQ09ORklHX1ZJREVPX0JST0FEV0VMTF9JR0QpICs9IGJy
b2Fkd2VsbF9pZ2Qubwogb2JqLSQoQ09ORklHX1ZJREVPX0NPUkVCT09UKSArPSBjb3JlYm9vdC5v
CiBvYmotJChDT05GSUdfVklERU9fREE4WFgpICs9IGRhOHh4LWZiLm8gdmlkZW9tb2Rlcy5vCiBv
YmotJChDT05GSUdfVklERU9fRFdfSERNSSkgKz0gZHdfaGRtaS5vCitvYmotJChDT05GSUdfVklE
RU9fRFdfTUlQSV9EU0kpICs9IGR3X21pcGlfZHNpLm8KIG9iai0kKENPTkZJR19WSURFT19FRkkp
ICs9IGVmaS5vCiBvYmotJChDT05GSUdfVklERU9fRlNMX0RDVV9GQikgKz0gZnNsX2RjdV9mYi5v
IHZpZGVvbW9kZXMubwogb2JqLSQoQ09ORklHX1ZJREVPX0lQVVYzKSArPSBpbXgvCmRpZmYgLS1n
aXQgYS9kcml2ZXJzL3ZpZGVvL2R3X21pcGlfZHNpLmMgYi9kcml2ZXJzL3ZpZGVvL2R3X21pcGlf
ZHNpLmMKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMC4uMDRiMDdlMwotLS0gL2Rl
di9udWxsCisrKyBiL2RyaXZlcnMvdmlkZW8vZHdfbWlwaV9kc2kuYwpAQCAtMCwwICsxLDgzOCBA
QAorLy8gU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQTC0yLjArCisvKgorICogQ29weXJpZ2h0
IChDKSAyMDE2LCBGdXpob3UgUm9ja2NoaXAgRWxlY3Ryb25pY3MgQ28uLCBMdGQKKyAqIENvcHly
aWdodCAoQykgMjAxOSwgU1RNaWNyb2VsZWN0cm9uaWNzIC0gQWxsIFJpZ2h0cyBSZXNlcnZlZAor
ICogQXV0aG9yKHMpOiBQaGlsaXBwZSBDb3JudSA8cGhpbGlwcGUuY29ybnVAc3QuY29tPiBmb3Ig
U1RNaWNyb2VsZWN0cm9uaWNzLgorICogICAgICAgICAgICBZYW5uaWNrIEZlcnRyZSA8eWFubmlj
ay5mZXJ0cmVAc3QuY29tPiBmb3IgU1RNaWNyb2VsZWN0cm9uaWNzLgorICoKKyAqIFRoaXMgZ2Vu
ZXJpYyBTeW5vcHN5cyBEZXNpZ25XYXJlIE1JUEkgRFNJIGhvc3QgZHJpdmVyIGlzIGluc3BpcmVk
IGZyb20KKyAqIHRoZSBMaW51eCBLZXJuZWwgZHJpdmVyIGRyaXZlcnMvZ3B1L2RybS9icmlkZ2Uv
c3lub3BzeXMvZHctbWlwaS1kc2kuYy4KKyAqLworCisjaW5jbHVkZSA8Y29tbW9uLmg+CisjaW5j
bHVkZSA8Y2xrLmg+CisjaW5jbHVkZSA8ZHNpX2hvc3QuaD4KKyNpbmNsdWRlIDxkbS5oPgorI2lu
Y2x1ZGUgPGVycm5vLmg+CisjaW5jbHVkZSA8cGFuZWwuaD4KKyNpbmNsdWRlIDx2aWRlby5oPgor
I2luY2x1ZGUgPGFzbS9pby5oPgorI2luY2x1ZGUgPGFzbS9hcmNoL2dwaW8uaD4KKyNpbmNsdWRl
IDxkbS9kZXZpY2UtaW50ZXJuYWwuaD4KKyNpbmNsdWRlIDxsaW51eC9pb3BvbGwuaD4KKyNpbmNs
dWRlIDx2aWRlb19icmlkZ2UuaD4KKworI2RlZmluZSBIV1ZFUl8xMzEJCQkweDMxMzMzMTAwCS8q
IElQIHZlcnNpb24gMS4zMSAqLworCisjZGVmaW5lIERTSV9WRVJTSU9OCQkJMHgwMAorI2RlZmlu
ZSBWRVJTSU9OCQkJCUdFTk1BU0soMzEsIDgpCisKKyNkZWZpbmUgRFNJX1BXUl9VUAkJCTB4MDQK
KyNkZWZpbmUgUkVTRVQJCQkJMAorI2RlZmluZSBQT1dFUlVQCQkJCUJJVCgwKQorCisjZGVmaW5l
IERTSV9DTEtNR1JfQ0ZHCQkJMHgwOAorI2RlZmluZSBUT19DTEtfRElWSVNJT04oZGl2KQkJKCgo
ZGl2KSAmIDB4ZmYpIDw8IDgpCisjZGVmaW5lIFRYX0VTQ19DTEtfRElWSVNJT04oZGl2KQkoKGRp
dikgJiAweGZmKQorCisjZGVmaW5lIERTSV9EUElfVkNJRAkJCTB4MGMKKyNkZWZpbmUgRFBJX1ZD
SUQodmNpZCkJCQkoKHZjaWQpICYgMHgzKQorCisjZGVmaW5lIERTSV9EUElfQ09MT1JfQ09ESU5H
CQkweDEwCisjZGVmaW5lIExPT1NFTFkxOF9FTgkJCUJJVCg4KQorI2RlZmluZSBEUElfQ09MT1Jf
Q09ESU5HXzE2QklUXzEJMHgwCisjZGVmaW5lIERQSV9DT0xPUl9DT0RJTkdfMTZCSVRfMgkweDEK
KyNkZWZpbmUgRFBJX0NPTE9SX0NPRElOR18xNkJJVF8zCTB4MgorI2RlZmluZSBEUElfQ09MT1Jf
Q09ESU5HXzE4QklUXzEJMHgzCisjZGVmaW5lIERQSV9DT0xPUl9DT0RJTkdfMThCSVRfMgkweDQK
KyNkZWZpbmUgRFBJX0NPTE9SX0NPRElOR18yNEJJVAkJMHg1CisKKyNkZWZpbmUgRFNJX0RQSV9D
RkdfUE9MCQkJMHgxNAorI2RlZmluZSBDT0xPUk1fQUNUSVZFX0xPVwkJQklUKDQpCisjZGVmaW5l
IFNIVVREX0FDVElWRV9MT1cJCUJJVCgzKQorI2RlZmluZSBIU1lOQ19BQ1RJVkVfTE9XCQlCSVQo
MikKKyNkZWZpbmUgVlNZTkNfQUNUSVZFX0xPVwkJQklUKDEpCisjZGVmaW5lIERBVEFFTl9BQ1RJ
VkVfTE9XCQlCSVQoMCkKKworI2RlZmluZSBEU0lfRFBJX0xQX0NNRF9USU0JCTB4MTgKKyNkZWZp
bmUgT1VUVkFDVF9MUENNRF9USU1FKHApCQkoKChwKSAmIDB4ZmYpIDw8IDE2KQorI2RlZmluZSBJ
TlZBQ1RfTFBDTURfVElNRShwKQkJKChwKSAmIDB4ZmYpCisKKyNkZWZpbmUgRFNJX0RCSV9WQ0lE
CQkJMHgxYworI2RlZmluZSBEU0lfREJJX0NGRwkJCTB4MjAKKyNkZWZpbmUgRFNJX0RCSV9QQVJU
SVRJT05JTkdfRU4JCTB4MjQKKyNkZWZpbmUgRFNJX0RCSV9DTURTSVpFCQkJMHgyOAorCisjZGVm
aW5lIERTSV9QQ0tIRExfQ0ZHCQkJMHgyYworI2RlZmluZSBDUkNfUlhfRU4JCQlCSVQoNCkKKyNk
ZWZpbmUgRUNDX1JYX0VOCQkJQklUKDMpCisjZGVmaW5lIEJUQV9FTgkJCQlCSVQoMikKKyNkZWZp
bmUgRU9UUF9SWF9FTgkJCUJJVCgxKQorI2RlZmluZSBFT1RQX1RYX0VOCQkJQklUKDApCisKKyNk
ZWZpbmUgRFNJX0dFTl9WQ0lECQkJMHgzMAorCisjZGVmaW5lIERTSV9NT0RFX0NGRwkJCTB4MzQK
KyNkZWZpbmUgRU5BQkxFX1ZJREVPX01PREUJCTAKKyNkZWZpbmUgRU5BQkxFX0NNRF9NT0RFCQkJ
QklUKDApCisKKyNkZWZpbmUgRFNJX1ZJRF9NT0RFX0NGRwkJMHgzOAorI2RlZmluZSBFTkFCTEVf
TE9XX1BPV0VSCQkoMHgzZiA8PCA4KQorI2RlZmluZSBFTkFCTEVfTE9XX1BPV0VSX01BU0sJCSgw
eDNmIDw8IDgpCisjZGVmaW5lIFZJRF9NT0RFX1RZUEVfTk9OX0JVUlNUX1NZTkNfUFVMU0VTCTB4
MAorI2RlZmluZSBWSURfTU9ERV9UWVBFX05PTl9CVVJTVF9TWU5DX0VWRU5UUwkweDEKKyNkZWZp
bmUgVklEX01PREVfVFlQRV9CVVJTVAkJCTB4MgorI2RlZmluZSBWSURfTU9ERV9UWVBFX01BU0sJ
CQkweDMKKworI2RlZmluZSBEU0lfVklEX1BLVF9TSVpFCQkweDNjCisjZGVmaW5lIFZJRF9QS1Rf
U0laRShwKQkJCSgocCkgJiAweDNmZmYpCisKKyNkZWZpbmUgRFNJX1ZJRF9OVU1fQ0hVTktTCQkw
eDQwCisjZGVmaW5lIFZJRF9OVU1fQ0hVTktTKGMpCQkoKGMpICYgMHgxZmZmKQorCisjZGVmaW5l
IERTSV9WSURfTlVMTF9TSVpFCQkweDQ0CisjZGVmaW5lIFZJRF9OVUxMX1NJWkUoYikJCSgoYikg
JiAweDFmZmYpCisKKyNkZWZpbmUgRFNJX1ZJRF9IU0FfVElNRQkJMHg0OAorI2RlZmluZSBEU0lf
VklEX0hCUF9USU1FCQkweDRjCisjZGVmaW5lIERTSV9WSURfSExJTkVfVElNRQkJMHg1MAorI2Rl
ZmluZSBEU0lfVklEX1ZTQV9MSU5FUwkJMHg1NAorI2RlZmluZSBEU0lfVklEX1ZCUF9MSU5FUwkJ
MHg1OAorI2RlZmluZSBEU0lfVklEX1ZGUF9MSU5FUwkJMHg1YworI2RlZmluZSBEU0lfVklEX1ZB
Q1RJVkVfTElORVMJCTB4NjAKKyNkZWZpbmUgRFNJX0VEUElfQ01EX1NJWkUJCTB4NjQKKworI2Rl
ZmluZSBEU0lfQ01EX01PREVfQ0ZHCQkweDY4CisjZGVmaW5lIE1BWF9SRF9QS1RfU0laRV9MUAkJ
QklUKDI0KQorI2RlZmluZSBEQ1NfTFdfVFhfTFAJCQlCSVQoMTkpCisjZGVmaW5lIERDU19TUl8w
UF9UWF9MUAkJCUJJVCgxOCkKKyNkZWZpbmUgRENTX1NXXzFQX1RYX0xQCQkJQklUKDE3KQorI2Rl
ZmluZSBEQ1NfU1dfMFBfVFhfTFAJCQlCSVQoMTYpCisjZGVmaW5lIEdFTl9MV19UWF9MUAkJCUJJ
VCgxNCkKKyNkZWZpbmUgR0VOX1NSXzJQX1RYX0xQCQkJQklUKDEzKQorI2RlZmluZSBHRU5fU1Jf
MVBfVFhfTFAJCQlCSVQoMTIpCisjZGVmaW5lIEdFTl9TUl8wUF9UWF9MUAkJCUJJVCgxMSkKKyNk
ZWZpbmUgR0VOX1NXXzJQX1RYX0xQCQkJQklUKDEwKQorI2RlZmluZSBHRU5fU1dfMVBfVFhfTFAJ
CQlCSVQoOSkKKyNkZWZpbmUgR0VOX1NXXzBQX1RYX0xQCQkJQklUKDgpCisjZGVmaW5lIEFDS19S
UVNUX0VOCQkJQklUKDEpCisjZGVmaW5lIFRFQVJfRlhfRU4JCQlCSVQoMCkKKworI2RlZmluZSBD
TURfTU9ERV9BTExfTFAJCQkoTUFYX1JEX1BLVF9TSVpFX0xQIHwgXAorCQkJCQkgRENTX0xXX1RY
X0xQIHwgXAorCQkJCQkgRENTX1NSXzBQX1RYX0xQIHwgXAorCQkJCQkgRENTX1NXXzFQX1RYX0xQ
IHwgXAorCQkJCQkgRENTX1NXXzBQX1RYX0xQIHwgXAorCQkJCQkgR0VOX0xXX1RYX0xQIHwgXAor
CQkJCQkgR0VOX1NSXzJQX1RYX0xQIHwgXAorCQkJCQkgR0VOX1NSXzFQX1RYX0xQIHwgXAorCQkJ
CQkgR0VOX1NSXzBQX1RYX0xQIHwgXAorCQkJCQkgR0VOX1NXXzJQX1RYX0xQIHwgXAorCQkJCQkg
R0VOX1NXXzFQX1RYX0xQIHwgXAorCQkJCQkgR0VOX1NXXzBQX1RYX0xQKQorCisjZGVmaW5lIERT
SV9HRU5fSERSCQkJMHg2YworI2RlZmluZSBEU0lfR0VOX1BMRF9EQVRBCQkweDcwCisKKyNkZWZp
bmUgRFNJX0NNRF9QS1RfU1RBVFVTCQkweDc0CisjZGVmaW5lIEdFTl9SRF9DTURfQlVTWQkJCUJJ
VCg2KQorI2RlZmluZSBHRU5fUExEX1JfRlVMTAkJCUJJVCg1KQorI2RlZmluZSBHRU5fUExEX1Jf
RU1QVFkJCQlCSVQoNCkKKyNkZWZpbmUgR0VOX1BMRF9XX0ZVTEwJCQlCSVQoMykKKyNkZWZpbmUg
R0VOX1BMRF9XX0VNUFRZCQkJQklUKDIpCisjZGVmaW5lIEdFTl9DTURfRlVMTAkJCUJJVCgxKQor
I2RlZmluZSBHRU5fQ01EX0VNUFRZCQkJQklUKDApCisKKyNkZWZpbmUgRFNJX1RPX0NOVF9DRkcJ
CQkweDc4CisjZGVmaW5lIEhTVFhfVE9fQ05UKHApCQkJKCgocCkgJiAweGZmZmYpIDw8IDE2KQor
I2RlZmluZSBMUFJYX1RPX0NOVChwKQkJCSgocCkgJiAweGZmZmYpCisKKyNkZWZpbmUgRFNJX0hT
X1JEX1RPX0NOVAkJMHg3YworI2RlZmluZSBEU0lfTFBfUkRfVE9fQ05UCQkweDgwCisjZGVmaW5l
IERTSV9IU19XUl9UT19DTlQJCTB4ODQKKyNkZWZpbmUgRFNJX0xQX1dSX1RPX0NOVAkJMHg4OAor
I2RlZmluZSBEU0lfQlRBX1RPX0NOVAkJCTB4OGMKKworI2RlZmluZSBEU0lfTFBDTEtfQ1RSTAkJ
CTB4OTQKKyNkZWZpbmUgQVVUT19DTEtMQU5FX0NUUkwJCUJJVCgxKQorI2RlZmluZSBQSFlfVFhS
RVFVRVNUQ0xLSFMJCUJJVCgwKQorCisjZGVmaW5lIERTSV9QSFlfVE1SX0xQQ0xLX0NGRwkJMHg5
OAorI2RlZmluZSBQSFlfQ0xLSFMyTFBfVElNRShsYmNjKQkJKCgobGJjYykgJiAweDNmZikgPDwg
MTYpCisjZGVmaW5lIFBIWV9DTEtMUDJIU19USU1FKGxiY2MpCQkoKGxiY2MpICYgMHgzZmYpCisK
KyNkZWZpbmUgRFNJX1BIWV9UTVJfQ0ZHCQkJMHg5YworI2RlZmluZSBQSFlfSFMyTFBfVElNRShs
YmNjKQkJKCgobGJjYykgJiAweGZmKSA8PCAyNCkKKyNkZWZpbmUgUEhZX0xQMkhTX1RJTUUobGJj
YykJCSgoKGxiY2MpICYgMHhmZikgPDwgMTYpCisjZGVmaW5lIE1BWF9SRF9USU1FKGxiY2MpCQko
KGxiY2MpICYgMHg3ZmZmKQorI2RlZmluZSBQSFlfSFMyTFBfVElNRV9WMTMxKGxiY2MpCSgoKGxi
Y2MpICYgMHgzZmYpIDw8IDE2KQorI2RlZmluZSBQSFlfTFAySFNfVElNRV9WMTMxKGxiY2MpCSgo
bGJjYykgJiAweDNmZikKKworI2RlZmluZSBEU0lfUEhZX1JTVFoJCQkweGEwCisjZGVmaW5lIFBI
WV9ESVNGT1JDRVBMTAkJCTAKKyNkZWZpbmUgUEhZX0VORk9SQ0VQTEwJCQlCSVQoMykKKyNkZWZp
bmUgUEhZX0RJU0FCTEVDTEsJCQkwCisjZGVmaW5lIFBIWV9FTkFCTEVDTEsJCQlCSVQoMikKKyNk
ZWZpbmUgUEhZX1JTVFoJCQkwCisjZGVmaW5lIFBIWV9VTlJTVFoJCQlCSVQoMSkKKyNkZWZpbmUg
UEhZX1NIVVRET1dOWgkJCTAKKyNkZWZpbmUgUEhZX1VOU0hVVERPV05aCQkJQklUKDApCisKKyNk
ZWZpbmUgRFNJX1BIWV9JRl9DRkcJCQkweGE0CisjZGVmaW5lIFBIWV9TVE9QX1dBSVRfVElNRShj
eWNsZSkJKCgoY3ljbGUpICYgMHhmZikgPDwgOCkKKyNkZWZpbmUgTl9MQU5FUyhuKQkJCSgoKG4p
IC0gMSkgJiAweDMpCisKKyNkZWZpbmUgRFNJX1BIWV9VTFBTX0NUUkwJCTB4YTgKKyNkZWZpbmUg
RFNJX1BIWV9UWF9UUklHR0VSUwkJMHhhYworCisjZGVmaW5lIERTSV9QSFlfU1RBVFVTCQkJMHhi
MAorI2RlZmluZSBQSFlfU1RPUF9TVEFURV9DTEtfTEFORQkJQklUKDIpCisjZGVmaW5lIFBIWV9M
T0NLCQkJQklUKDApCisKKyNkZWZpbmUgRFNJX1BIWV9UU1RfQ1RSTDAJCTB4YjQKKyNkZWZpbmUg
UEhZX1RFU1RDTEsJCQlCSVQoMSkKKyNkZWZpbmUgUEhZX1VOVEVTVENMSwkJCTAKKyNkZWZpbmUg
UEhZX1RFU1RDTFIJCQlCSVQoMCkKKyNkZWZpbmUgUEhZX1VOVEVTVENMUgkJCTAKKworI2RlZmlu
ZSBEU0lfUEhZX1RTVF9DVFJMMQkJMHhiOAorI2RlZmluZSBQSFlfVEVTVEVOCQkJQklUKDE2KQor
I2RlZmluZSBQSFlfVU5URVNURU4JCQkwCisjZGVmaW5lIFBIWV9URVNURE9VVChuKQkJCSgoKG4p
ICYgMHhmZikgPDwgOCkKKyNkZWZpbmUgUEhZX1RFU1RESU4obikJCQkoKG4pICYgMHhmZikKKwor
I2RlZmluZSBEU0lfSU5UX1NUMAkJCTB4YmMKKyNkZWZpbmUgRFNJX0lOVF9TVDEJCQkweGMwCisj
ZGVmaW5lIERTSV9JTlRfTVNLMAkJCTB4YzQKKyNkZWZpbmUgRFNJX0lOVF9NU0sxCQkJMHhjOAor
CisjZGVmaW5lIERTSV9QSFlfVE1SX1JEX0NGRwkJMHhmNAorI2RlZmluZSBNQVhfUkRfVElNRV9W
MTMxKGxiY2MpCQkoKGxiY2MpICYgMHg3ZmZmKQorCisjZGVmaW5lIFBIWV9TVEFUVVNfVElNRU9V
VF9VUwkJMTAwMDAKKyNkZWZpbmUgQ01EX1BLVF9TVEFUVVNfVElNRU9VVF9VUwkyMDAwMAorCisj
ZGVmaW5lIE1TRUNfUEVSX1NFQwkJCTEwMDAKKworc3RydWN0IGR3X21pcGlfZHNpIHsKKwlzdHJ1
Y3QgbWlwaV9kc2lfaG9zdCBkc2lfaG9zdDsKKwlzdHJ1Y3QgbWlwaV9kc2lfZGV2aWNlICpkZXZp
Y2U7CisJdm9pZCBfX2lvbWVtICpiYXNlOworCXVuc2lnbmVkIGludCBsYW5lX21icHM7IC8qIHBl
ciBsYW5lICovCisJdTMyIGNoYW5uZWw7CisJdW5zaWduZWQgaW50IG1heF9kYXRhX2xhbmVzOwor
CWNvbnN0IHN0cnVjdCBtaXBpX2RzaV9waHlfb3BzICpwaHlfb3BzOworfTsKKworc3RhdGljIGlu
dCBkc2lfbW9kZV92cmVmcmVzaChzdHJ1Y3QgZGlzcGxheV90aW1pbmcgKnRpbWluZ3MpCit7CisJ
aW50IHJlZnJlc2ggPSAwOworCXVuc2lnbmVkIGludCBjYWxjX3ZhbDsKKwl1MzIgaHRvdGFsID0g
dGltaW5ncy0+aGFjdGl2ZS50eXAgKyB0aW1pbmdzLT5oZnJvbnRfcG9yY2gudHlwICsKKwkJICAg
ICB0aW1pbmdzLT5oYmFja19wb3JjaC50eXAgKyB0aW1pbmdzLT5oc3luY19sZW4udHlwOworCXUz
MiB2dG90YWwgPSB0aW1pbmdzLT52YWN0aXZlLnR5cCArIHRpbWluZ3MtPnZmcm9udF9wb3JjaC50
eXAgKworCQkgICAgIHRpbWluZ3MtPnZiYWNrX3BvcmNoLnR5cCArIHRpbWluZ3MtPnZzeW5jX2xl
bi50eXA7CisKKwlpZiAoaHRvdGFsID4gMCAmJiB2dG90YWwgPiAwKSB7CisJCWNhbGNfdmFsID0g
dGltaW5ncy0+cGl4ZWxjbG9jay50eXA7CisJCWNhbGNfdmFsIC89IGh0b3RhbDsKKwkJcmVmcmVz
aCA9IChjYWxjX3ZhbCArIHZ0b3RhbCAvIDIpIC8gdnRvdGFsOworCX0KKworCXJldHVybiByZWZy
ZXNoOworfQorCisvKgorICogVGhlIGNvbnRyb2xsZXIgc2hvdWxkIGdlbmVyYXRlIDIgZnJhbWVz
IGJlZm9yZQorICogcHJlcGFyaW5nIHRoZSBwZXJpcGhlcmFsLgorICovCitzdGF0aWMgdm9pZCBk
d19taXBpX2RzaV93YWl0X2Zvcl90d29fZnJhbWVzKHN0cnVjdCBkaXNwbGF5X3RpbWluZyAqdGlt
aW5ncykKK3sKKwlpbnQgcmVmcmVzaCwgdHdvX2ZyYW1lczsKKworCXJlZnJlc2ggPSBkc2lfbW9k
ZV92cmVmcmVzaCh0aW1pbmdzKTsKKwl0d29fZnJhbWVzID0gRElWX1JPVU5EX1VQKE1TRUNfUEVS
X1NFQywgcmVmcmVzaCkgKiAyOworCW1kZWxheSh0d29fZnJhbWVzKTsKK30KKworc3RhdGljIGlu
bGluZSBzdHJ1Y3QgZHdfbWlwaV9kc2kgKmhvc3RfdG9fZHNpKHN0cnVjdCBtaXBpX2RzaV9ob3N0
ICpob3N0KQoreworCXJldHVybiBjb250YWluZXJfb2YoaG9zdCwgc3RydWN0IGR3X21pcGlfZHNp
LCBkc2lfaG9zdCk7Cit9CisKK3N0YXRpYyBpbmxpbmUgdm9pZCBkc2lfd3JpdGUoc3RydWN0IGR3
X21pcGlfZHNpICpkc2ksIHUzMiByZWcsIHUzMiB2YWwpCit7CisJd3JpdGVsKHZhbCwgZHNpLT5i
YXNlICsgcmVnKTsKK30KKworc3RhdGljIGlubGluZSB1MzIgZHNpX3JlYWQoc3RydWN0IGR3X21p
cGlfZHNpICpkc2ksIHUzMiByZWcpCit7CisJcmV0dXJuIHJlYWRsKGRzaS0+YmFzZSArIHJlZyk7
Cit9CisKK3N0YXRpYyBpbnQgZHdfbWlwaV9kc2lfaG9zdF9hdHRhY2goc3RydWN0IG1pcGlfZHNp
X2hvc3QgKmhvc3QsCisJCQkJICAgc3RydWN0IG1pcGlfZHNpX2RldmljZSAqZGV2aWNlKQorewor
CXN0cnVjdCBkd19taXBpX2RzaSAqZHNpID0gaG9zdF90b19kc2koaG9zdCk7CisKKwlpZiAoZGV2
aWNlLT5sYW5lcyA+IGRzaS0+bWF4X2RhdGFfbGFuZXMpIHsKKwkJZGV2X2VycihkZXZpY2UtPmRl
diwKKwkJCSJ0aGUgbnVtYmVyIG9mIGRhdGEgbGFuZXMoJXUpIGlzIHRvbyBtYW55XG4iLAorCQkJ
ZGV2aWNlLT5sYW5lcyk7CisJCXJldHVybiAtRUlOVkFMOworCX0KKworCWRzaS0+Y2hhbm5lbCA9
IGRldmljZS0+Y2hhbm5lbDsKKworCXJldHVybiAwOworfQorCitzdGF0aWMgdm9pZCBkd19taXBp
X21lc3NhZ2VfY29uZmlnKHN0cnVjdCBkd19taXBpX2RzaSAqZHNpLAorCQkJCSAgIGNvbnN0IHN0
cnVjdCBtaXBpX2RzaV9tc2cgKm1zZykKK3sKKwlib29sIGxwbSA9IG1zZy0+ZmxhZ3MgJiBNSVBJ
X0RTSV9NU0dfVVNFX0xQTTsKKwl1MzIgdmFsID0gMDsKKworCWlmIChtc2ctPmZsYWdzICYgTUlQ
SV9EU0lfTVNHX1JFUV9BQ0spCisJCXZhbCB8PSBBQ0tfUlFTVF9FTjsKKwlpZiAobHBtKQorCQl2
YWwgfD0gQ01EX01PREVfQUxMX0xQOworCisJZHNpX3dyaXRlKGRzaSwgRFNJX0xQQ0xLX0NUUkws
IGxwbSA/IDAgOiBQSFlfVFhSRVFVRVNUQ0xLSFMpOworCWRzaV93cml0ZShkc2ksIERTSV9DTURf
TU9ERV9DRkcsIHZhbCk7Cit9CisKK3N0YXRpYyBpbnQgZHdfbWlwaV9kc2lfZ2VuX3BrdF9oZHJf
d3JpdGUoc3RydWN0IGR3X21pcGlfZHNpICpkc2ksIHUzMiBoZHJfdmFsKQoreworCWludCByZXQ7
CisJdTMyIHZhbCwgbWFzazsKKworCXJldCA9IHJlYWRsX3BvbGxfdGltZW91dChkc2ktPmJhc2Ug
KyBEU0lfQ01EX1BLVF9TVEFUVVMsCisJCQkJIHZhbCwgISh2YWwgJiBHRU5fQ01EX0ZVTEwpLAor
CQkJCSBDTURfUEtUX1NUQVRVU19USU1FT1VUX1VTKTsKKwlpZiAocmV0KSB7CisJCWRldl9lcnIo
ZHNpLT5kZXYsICJmYWlsZWQgdG8gZ2V0IGF2YWlsYWJsZSBjb21tYW5kIEZJRk9cbiIpOworCQly
ZXR1cm4gcmV0OworCX0KKworCWRzaV93cml0ZShkc2ksIERTSV9HRU5fSERSLCBoZHJfdmFsKTsK
KworCW1hc2sgPSBHRU5fQ01EX0VNUFRZIHwgR0VOX1BMRF9XX0VNUFRZOworCXJldCA9IHJlYWRs
X3BvbGxfdGltZW91dChkc2ktPmJhc2UgKyBEU0lfQ01EX1BLVF9TVEFUVVMsCisJCQkJIHZhbCwg
KHZhbCAmIG1hc2spID09IG1hc2ssCisJCQkJIENNRF9QS1RfU1RBVFVTX1RJTUVPVVRfVVMpOwor
CWlmIChyZXQpIHsKKwkJZGV2X2Vycihkc2ktPmRldiwgImZhaWxlZCB0byB3cml0ZSBjb21tYW5k
IEZJRk9cbiIpOworCQlyZXR1cm4gcmV0OworCX0KKworCXJldHVybiAwOworfQorCitzdGF0aWMg
aW50IGR3X21pcGlfZHNpX3dyaXRlKHN0cnVjdCBkd19taXBpX2RzaSAqZHNpLAorCQkJICAgICBj
b25zdCBzdHJ1Y3QgbWlwaV9kc2lfcGFja2V0ICpwYWNrZXQpCit7CisJY29uc3QgdTggKnR4X2J1
ZiA9IHBhY2tldC0+cGF5bG9hZDsKKwlpbnQgbGVuID0gcGFja2V0LT5wYXlsb2FkX2xlbmd0aCwg
cGxkX2RhdGFfYnl0ZXMgPSBzaXplb2YodTMyKSwgcmV0OworCV9fbGUzMiB3b3JkOworCXUzMiB2
YWw7CisKKwl3aGlsZSAobGVuKSB7CisJCWlmIChsZW4gPCBwbGRfZGF0YV9ieXRlcykgeworCQkJ
d29yZCA9IDA7CisJCQltZW1jcHkoJndvcmQsIHR4X2J1ZiwgbGVuKTsKKwkJCWRzaV93cml0ZShk
c2ksIERTSV9HRU5fUExEX0RBVEEsIGxlMzJfdG9fY3B1KHdvcmQpKTsKKwkJCWxlbiA9IDA7CisJ
CX0gZWxzZSB7CisJCQltZW1jcHkoJndvcmQsIHR4X2J1ZiwgcGxkX2RhdGFfYnl0ZXMpOworCQkJ
ZHNpX3dyaXRlKGRzaSwgRFNJX0dFTl9QTERfREFUQSwgbGUzMl90b19jcHUod29yZCkpOworCQkJ
dHhfYnVmICs9IHBsZF9kYXRhX2J5dGVzOworCQkJbGVuIC09IHBsZF9kYXRhX2J5dGVzOworCQl9
CisKKwkJcmV0ID0gcmVhZGxfcG9sbF90aW1lb3V0KGRzaS0+YmFzZSArIERTSV9DTURfUEtUX1NU
QVRVUywKKwkJCQkJIHZhbCwgISh2YWwgJiBHRU5fUExEX1dfRlVMTCksCisJCQkJCSBDTURfUEtU
X1NUQVRVU19USU1FT1VUX1VTKTsKKwkJaWYgKHJldCkgeworCQkJZGV2X2Vycihkc2ktPmRldiwK
KwkJCQkiZmFpbGVkIHRvIGdldCBhdmFpbGFibGUgd3JpdGUgcGF5bG9hZCBGSUZPXG4iKTsKKwkJ
CXJldHVybiByZXQ7CisJCX0KKwl9CisKKwl3b3JkID0gMDsKKwltZW1jcHkoJndvcmQsIHBhY2tl
dC0+aGVhZGVyLCBzaXplb2YocGFja2V0LT5oZWFkZXIpKTsKKwlyZXR1cm4gZHdfbWlwaV9kc2lf
Z2VuX3BrdF9oZHJfd3JpdGUoZHNpLCBsZTMyX3RvX2NwdSh3b3JkKSk7Cit9CisKK3N0YXRpYyBp
bnQgZHdfbWlwaV9kc2lfcmVhZChzdHJ1Y3QgZHdfbWlwaV9kc2kgKmRzaSwKKwkJCSAgICBjb25z
dCBzdHJ1Y3QgbWlwaV9kc2lfbXNnICptc2cpCit7CisJaW50IGksIGosIHJldCwgbGVuID0gbXNn
LT5yeF9sZW47CisJdTggKmJ1ZiA9IG1zZy0+cnhfYnVmOworCXUzMiB2YWw7CisKKwkvKiBXYWl0
IGVuZCBvZiB0aGUgcmVhZCBvcGVyYXRpb24gKi8KKwlyZXQgPSByZWFkbF9wb2xsX3RpbWVvdXQo
ZHNpLT5iYXNlICsgRFNJX0NNRF9QS1RfU1RBVFVTLAorCQkJCSB2YWwsICEodmFsICYgR0VOX1JE
X0NNRF9CVVNZKSwKKwkJCQkgQ01EX1BLVF9TVEFUVVNfVElNRU9VVF9VUyk7CisJaWYgKHJldCkg
eworCQlkZXZfZXJyKGRzaS0+ZGV2LCAiVGltZW91dCBkdXJpbmcgcmVhZCBvcGVyYXRpb25cbiIp
OworCQlyZXR1cm4gcmV0OworCX0KKworCWZvciAoaSA9IDA7IGkgPCBsZW47IGkgKz0gNCkgewor
CQkvKiBSZWFkIGZpZm8gbXVzdCBub3QgYmUgZW1wdHkgYmVmb3JlIGFsbCBieXRlcyBhcmUgcmVh
ZCAqLworCQlyZXQgPSByZWFkbF9wb2xsX3RpbWVvdXQoZHNpLT5iYXNlICsgRFNJX0NNRF9QS1Rf
U1RBVFVTLAorCQkJCQkgdmFsLCAhKHZhbCAmIEdFTl9QTERfUl9FTVBUWSksCisJCQkJCSBDTURf
UEtUX1NUQVRVU19USU1FT1VUX1VTKTsKKwkJaWYgKHJldCkgeworCQkJZGV2X2Vycihkc2ktPmRl
diwgIlJlYWQgcGF5bG9hZCBGSUZPIGlzIGVtcHR5XG4iKTsKKwkJCXJldHVybiByZXQ7CisJCX0K
KworCQl2YWwgPSBkc2lfcmVhZChkc2ksIERTSV9HRU5fUExEX0RBVEEpOworCQlmb3IgKGogPSAw
OyBqIDwgNCAmJiBqICsgaSA8IGxlbjsgaisrKQorCQkJYnVmW2kgKyBqXSA9IHZhbCA+PiAoOCAq
IGopOworCX0KKworCXJldHVybiByZXQ7Cit9CisKK3N0YXRpYyBzc2l6ZV90IGR3X21pcGlfZHNp
X2hvc3RfdHJhbnNmZXIoc3RydWN0IG1pcGlfZHNpX2hvc3QgKmhvc3QsCisJCQkJCSBjb25zdCBz
dHJ1Y3QgbWlwaV9kc2lfbXNnICptc2cpCit7CisJc3RydWN0IGR3X21pcGlfZHNpICpkc2kgPSBo
b3N0X3RvX2RzaShob3N0KTsKKwlzdHJ1Y3QgbWlwaV9kc2lfcGFja2V0IHBhY2tldDsKKwlpbnQg
cmV0LCBuYl9ieXRlczsKKworCXJldCA9IG1pcGlfZHNpX2NyZWF0ZV9wYWNrZXQoJnBhY2tldCwg
bXNnKTsKKwlpZiAocmV0KSB7CisJCWRldl9lcnIoZHNpLT5kZXYsICJmYWlsZWQgdG8gY3JlYXRl
IHBhY2tldDogJWRcbiIsIHJldCk7CisJCXJldHVybiByZXQ7CisJfQorCisJZHdfbWlwaV9tZXNz
YWdlX2NvbmZpZyhkc2ksIG1zZyk7CisKKwlyZXQgPSBkd19taXBpX2RzaV93cml0ZShkc2ksICZw
YWNrZXQpOworCWlmIChyZXQpCisJCXJldHVybiByZXQ7CisKKwlpZiAobXNnLT5yeF9idWYgJiYg
bXNnLT5yeF9sZW4pIHsKKwkJcmV0ID0gZHdfbWlwaV9kc2lfcmVhZChkc2ksIG1zZyk7CisJCWlm
IChyZXQpCisJCQlyZXR1cm4gcmV0OworCQluYl9ieXRlcyA9IG1zZy0+cnhfbGVuOworCX0gZWxz
ZSB7CisJCW5iX2J5dGVzID0gcGFja2V0LnNpemU7CisJfQorCisJcmV0dXJuIG5iX2J5dGVzOwor
fQorCitzdGF0aWMgY29uc3Qgc3RydWN0IG1pcGlfZHNpX2hvc3Rfb3BzIGR3X21pcGlfZHNpX2hv
c3Rfb3BzID0geworCS5hdHRhY2ggPSBkd19taXBpX2RzaV9ob3N0X2F0dGFjaCwKKwkudHJhbnNm
ZXIgPSBkd19taXBpX2RzaV9ob3N0X3RyYW5zZmVyLAorfTsKKworc3RhdGljIHZvaWQgZHdfbWlw
aV9kc2lfdmlkZW9fbW9kZV9jb25maWcoc3RydWN0IGR3X21pcGlfZHNpICpkc2kpCit7CisJc3Ry
dWN0IG1pcGlfZHNpX2RldmljZSAqZGV2aWNlID0gZHNpLT5kZXZpY2U7CisJdTMyIHZhbDsKKwor
CS8qCisJICogVE9ETyBkdyBkcnYgaW1wcm92ZW1lbnRzCisJICogZW5hYmxpbmcgbG93IHBvd2Vy
IGlzIHBhbmVsLWRlcGVuZGVudCwgd2Ugc2hvdWxkIHVzZSB0aGUKKwkgKiBwYW5lbCBjb25maWd1
cmF0aW9uIGhlcmUuLi4KKwkgKi8KKwl2YWwgPSBFTkFCTEVfTE9XX1BPV0VSOworCisJaWYgKGRl
dmljZS0+bW9kZV9mbGFncyAmIE1JUElfRFNJX01PREVfVklERU9fQlVSU1QpCisJCXZhbCB8PSBW
SURfTU9ERV9UWVBFX0JVUlNUOworCWVsc2UgaWYgKGRldmljZS0+bW9kZV9mbGFncyAmIE1JUElf
RFNJX01PREVfVklERU9fU1lOQ19QVUxTRSkKKwkJdmFsIHw9IFZJRF9NT0RFX1RZUEVfTk9OX0JV
UlNUX1NZTkNfUFVMU0VTOworCWVsc2UKKwkJdmFsIHw9IFZJRF9NT0RFX1RZUEVfTk9OX0JVUlNU
X1NZTkNfRVZFTlRTOworCisJZHNpX3dyaXRlKGRzaSwgRFNJX1ZJRF9NT0RFX0NGRywgdmFsKTsK
K30KKworc3RhdGljIHZvaWQgZHdfbWlwaV9kc2lfc2V0X21vZGUoc3RydWN0IGR3X21pcGlfZHNp
ICpkc2ksCisJCQkJIHVuc2lnbmVkIGxvbmcgbW9kZV9mbGFncykKK3sKKwljb25zdCBzdHJ1Y3Qg
bWlwaV9kc2lfcGh5X29wcyAqcGh5X29wcyA9IGRzaS0+cGh5X29wczsKKworCWRzaV93cml0ZShk
c2ksIERTSV9QV1JfVVAsIFJFU0VUKTsKKworCWlmIChtb2RlX2ZsYWdzICYgTUlQSV9EU0lfTU9E
RV9WSURFTykgeworCQlkc2lfd3JpdGUoZHNpLCBEU0lfTU9ERV9DRkcsIEVOQUJMRV9WSURFT19N
T0RFKTsKKwkJZHdfbWlwaV9kc2lfdmlkZW9fbW9kZV9jb25maWcoZHNpKTsKKwkJZHNpX3dyaXRl
KGRzaSwgRFNJX0xQQ0xLX0NUUkwsIFBIWV9UWFJFUVVFU1RDTEtIUyk7CisJfSBlbHNlIHsKKwkJ
ZHNpX3dyaXRlKGRzaSwgRFNJX01PREVfQ0ZHLCBFTkFCTEVfQ01EX01PREUpOworCX0KKworCWlm
IChwaHlfb3BzLT5wb3N0X3NldF9tb2RlKQorCQlwaHlfb3BzLT5wb3N0X3NldF9tb2RlKGRzaS0+
ZGV2aWNlLCBtb2RlX2ZsYWdzKTsKKworCWRzaV93cml0ZShkc2ksIERTSV9QV1JfVVAsIFBPV0VS
VVApOworfQorCitzdGF0aWMgdm9pZCBkd19taXBpX2RzaV9pbml0X3BsbChzdHJ1Y3QgZHdfbWlw
aV9kc2kgKmRzaSkKK3sKKwkvKgorCSAqIFRoZSBtYXhpbXVtIHBlcm1pdHRlZCBlc2NhcGUgY2xv
Y2sgaXMgMjBNSHogYW5kIGl0IGlzIGRlcml2ZWQgZnJvbQorCSAqIGxhbmVieXRlY2xrLCB3aGlj
aCBpcyBydW5uaW5nIGF0ICJsYW5lX21icHMgLyA4Ii4gIFRodXMgd2Ugd2FudDoKKwkgKgorCSAq
ICAgICAobGFuZV9tYnBzID4+IDMpIC8gZXNjX2Nsa19kaXZpc2lvbiA8IDIwCisJICogd2hpY2gg
aXM6CisJICogICAgIChsYW5lX21icHMgPj4gMykgLyAyMCA+IGVzY19jbGtfZGl2aXNpb24KKwkg
Ki8KKwl1MzIgZXNjX2Nsa19kaXZpc2lvbiA9IChkc2ktPmxhbmVfbWJwcyA+PiAzKSAvIDIwICsg
MTsKKworCWRzaV93cml0ZShkc2ksIERTSV9QV1JfVVAsIFJFU0VUKTsKKworCS8qCisJICogVE9E
TyBkdyBkcnYgaW1wcm92ZW1lbnRzCisJICogdGltZW91dCBjbG9jayBkaXZpc2lvbiBzaG91bGQg
YmUgY29tcHV0ZWQgd2l0aCB0aGUKKwkgKiBoaWdoIHNwZWVkIHRyYW5zbWlzc2lvbiBjb3VudGVy
IHRpbWVvdXQgYW5kIGJ5dGUgbGFuZS4uLgorCSAqLworCWRzaV93cml0ZShkc2ksIERTSV9DTEtN
R1JfQ0ZHLCBUT19DTEtfRElWSVNJT04oMTApIHwKKwkJICBUWF9FU0NfQ0xLX0RJVklTSU9OKGVz
Y19jbGtfZGl2aXNpb24pKTsKK30KKworc3RhdGljIHZvaWQgZHdfbWlwaV9kc2lfZHBpX2NvbmZp
ZyhzdHJ1Y3QgZHdfbWlwaV9kc2kgKmRzaSwKKwkJCQkgICBzdHJ1Y3QgZGlzcGxheV90aW1pbmcg
KnRpbWluZ3MpCit7CisJc3RydWN0IG1pcGlfZHNpX2RldmljZSAqZGV2aWNlID0gZHNpLT5kZXZp
Y2U7CisJdTMyIHZhbCA9IDAsIGNvbG9yID0gMDsKKworCXN3aXRjaCAoZGV2aWNlLT5mb3JtYXQp
IHsKKwljYXNlIE1JUElfRFNJX0ZNVF9SR0I4ODg6CisJCWNvbG9yID0gRFBJX0NPTE9SX0NPRElO
R18yNEJJVDsKKwkJYnJlYWs7CisJY2FzZSBNSVBJX0RTSV9GTVRfUkdCNjY2OgorCQljb2xvciA9
IERQSV9DT0xPUl9DT0RJTkdfMThCSVRfMiB8IExPT1NFTFkxOF9FTjsKKwkJYnJlYWs7CisJY2Fz
ZSBNSVBJX0RTSV9GTVRfUkdCNjY2X1BBQ0tFRDoKKwkJY29sb3IgPSBEUElfQ09MT1JfQ09ESU5H
XzE4QklUXzE7CisJCWJyZWFrOworCWNhc2UgTUlQSV9EU0lfRk1UX1JHQjU2NToKKwkJY29sb3Ig
PSBEUElfQ09MT1JfQ09ESU5HXzE2QklUXzE7CisJCWJyZWFrOworCX0KKworCWlmIChkZXZpY2Ut
Pm1vZGVfZmxhZ3MgJiBESVNQTEFZX0ZMQUdTX1ZTWU5DX0hJR0gpCisJCXZhbCB8PSBWU1lOQ19B
Q1RJVkVfTE9XOworCWlmIChkZXZpY2UtPm1vZGVfZmxhZ3MgJiBESVNQTEFZX0ZMQUdTX0hTWU5D
X0hJR0gpCisJCXZhbCB8PSBIU1lOQ19BQ1RJVkVfTE9XOworCisJZHNpX3dyaXRlKGRzaSwgRFNJ
X0RQSV9WQ0lELCBEUElfVkNJRChkc2ktPmNoYW5uZWwpKTsKKwlkc2lfd3JpdGUoZHNpLCBEU0lf
RFBJX0NPTE9SX0NPRElORywgY29sb3IpOworCWRzaV93cml0ZShkc2ksIERTSV9EUElfQ0ZHX1BP
TCwgdmFsKTsKKwkvKgorCSAqIFRPRE8gZHcgZHJ2IGltcHJvdmVtZW50cworCSAqIGxhcmdlc3Qg
cGFja2V0IHNpemVzIGR1cmluZyBoZnAgb3IgZHVyaW5nIHZzYS92cGIvdmZwCisJICogc2hvdWxk
IGJlIGNvbXB1dGVkIGFjY29yZGluZyB0byBieXRlIGxhbmUsIGxhbmUgbnVtYmVyIGFuZCBvbmx5
CisJICogaWYgc2VuZGluZyBscCBjbWRzIGluIGhpZ2ggc3BlZWQgaXMgZW5hYmxlIChQSFlfVFhS
RVFVRVNUQ0xLSFMpCisJICovCisJZHNpX3dyaXRlKGRzaSwgRFNJX0RQSV9MUF9DTURfVElNLCBP
VVRWQUNUX0xQQ01EX1RJTUUoNCkKKwkJICB8IElOVkFDVF9MUENNRF9USU1FKDQpKTsKK30KKwor
c3RhdGljIHZvaWQgZHdfbWlwaV9kc2lfcGFja2V0X2hhbmRsZXJfY29uZmlnKHN0cnVjdCBkd19t
aXBpX2RzaSAqZHNpKQoreworCWRzaV93cml0ZShkc2ksIERTSV9QQ0tIRExfQ0ZHLCBDUkNfUlhf
RU4gfCBFQ0NfUlhfRU4gfCBCVEFfRU4pOworfQorCitzdGF0aWMgdm9pZCBkd19taXBpX2RzaV92
aWRlb19wYWNrZXRfY29uZmlnKHN0cnVjdCBkd19taXBpX2RzaSAqZHNpLAorCQkJCQkgICAgc3Ry
dWN0IGRpc3BsYXlfdGltaW5nICp0aW1pbmdzKQoreworCS8qCisJICogVE9ETyBkdyBkcnYgaW1w
cm92ZW1lbnRzCisJICogb25seSBidXJzdCBtb2RlIGlzIHN1cHBvcnRlZCBoZXJlLiBGb3Igbm9u
LWJ1cnN0IHZpZGVvIG1vZGVzLAorCSAqIHdlIHNob3VsZCBjb21wdXRlIERTSV9WSURfUEtUX1NJ
WkUsIERTSV9WQ0NSLk5VTUMgJgorCSAqIERTSV9WTlBDUi5OUFNJWkUuLi4gZXNwZWNpYWxseSBi
ZWNhdXNlIHRoaXMgZHJpdmVyIHN1cHBvcnRzCisJICogbm9uLWJ1cnN0IHZpZGVvIG1vZGVzLCBz
ZWUgZHdfbWlwaV9kc2lfdmlkZW9fbW9kZV9jb25maWcoKS4uLgorCSAqLworCWRzaV93cml0ZShk
c2ksIERTSV9WSURfUEtUX1NJWkUsIFZJRF9QS1RfU0laRSh0aW1pbmdzLT5oYWN0aXZlLnR5cCkp
OworfQorCitzdGF0aWMgdm9pZCBkd19taXBpX2RzaV9jb21tYW5kX21vZGVfY29uZmlnKHN0cnVj
dCBkd19taXBpX2RzaSAqZHNpKQoreworCWNvbnN0IHN0cnVjdCBtaXBpX2RzaV9waHlfb3BzICpw
aHlfb3BzID0gZHNpLT5waHlfb3BzOworCisJLyoKKwkgKiBUT0RPIGR3IGRydiBpbXByb3ZlbWVu
dHMKKwkgKiBjb21wdXRlIGhpZ2ggc3BlZWQgdHJhbnNtaXNzaW9uIGNvdW50ZXIgdGltZW91dCBh
Y2NvcmRpbmcKKwkgKiB0byB0aGUgdGltZW91dCBjbG9jayBkaXZpc2lvbiAoVE9fQ0xLX0RJVklT
SU9OKSBhbmQgYnl0ZSBsYW5lLi4uCisJICovCisJZHNpX3dyaXRlKGRzaSwgRFNJX1RPX0NOVF9D
RkcsIEhTVFhfVE9fQ05UKDEwMDApIHwgTFBSWF9UT19DTlQoMTAwMCkpOworCS8qCisJICogVE9E
TyBkdyBkcnYgaW1wcm92ZW1lbnRzCisJICogdGhlIEJ1cy1UdXJuLUFyb3VuZCBUaW1lb3V0IENv
dW50ZXIgc2hvdWxkIGJlIGNvbXB1dGVkCisJICogYWNjb3JkaW5nIHRvIGJ5dGUgbGFuZS4uLgor
CSAqLworCWRzaV93cml0ZShkc2ksIERTSV9CVEFfVE9fQ05ULCAweGQwMCk7CisJZHNpX3dyaXRl
KGRzaSwgRFNJX01PREVfQ0ZHLCBFTkFCTEVfQ01EX01PREUpOworCisJaWYgKHBoeV9vcHMtPnBv
c3Rfc2V0X21vZGUpCisJCXBoeV9vcHMtPnBvc3Rfc2V0X21vZGUoZHNpLT5kZXZpY2UsIDApOwor
fQorCisvKiBHZXQgbGFuZSBieXRlIGNsb2NrIGN5Y2xlcy4gKi8KK3N0YXRpYyB1MzIgZHdfbWlw
aV9kc2lfZ2V0X2hjb21wb25lbnRfbGJjYyhzdHJ1Y3QgZHdfbWlwaV9kc2kgKmRzaSwKKwkJCQkJ
ICAgc3RydWN0IGRpc3BsYXlfdGltaW5nICp0aW1pbmdzLAorCQkJCQkgICB1MzIgaGNvbXBvbmVu
dCkKK3sKKwl1MzIgZnJhYywgbGJjYzsKKworCWxiY2MgPSBoY29tcG9uZW50ICogZHNpLT5sYW5l
X21icHMgKiBNU0VDX1BFUl9TRUMgLyA4OworCisJZnJhYyA9IGxiY2MgJSAodGltaW5ncy0+cGl4
ZWxjbG9jay50eXAgLyAxMDAwKTsKKwlsYmNjID0gbGJjYyAvICh0aW1pbmdzLT5waXhlbGNsb2Nr
LnR5cCAvIDEwMDApOworCWlmIChmcmFjKQorCQlsYmNjKys7CisKKwlyZXR1cm4gbGJjYzsKK30K
Kworc3RhdGljIHZvaWQgZHdfbWlwaV9kc2lfbGluZV90aW1lcl9jb25maWcoc3RydWN0IGR3X21p
cGlfZHNpICpkc2ksCisJCQkJCSAgc3RydWN0IGRpc3BsYXlfdGltaW5nICp0aW1pbmdzKQorewor
CXUzMiBodG90YWwsIGhzYSwgaGJwLCBsYmNjOworCisJaHRvdGFsID0gdGltaW5ncy0+aGFjdGl2
ZS50eXAgKyB0aW1pbmdzLT5oZnJvbnRfcG9yY2gudHlwICsKKwkJIHRpbWluZ3MtPmhiYWNrX3Bv
cmNoLnR5cCArIHRpbWluZ3MtPmhzeW5jX2xlbi50eXA7CisKKwloc2EgPSB0aW1pbmdzLT5oYmFj
a19wb3JjaC50eXA7CisJaGJwID0gdGltaW5ncy0+aHN5bmNfbGVuLnR5cDsKKworCS8qCisJICog
VE9ETyBkdyBkcnYgaW1wcm92ZW1lbnRzCisJICogY29tcHV0YXRpb25zIGJlbG93IG1heSBiZSBp
bXByb3ZlZC4uLgorCSAqLworCWxiY2MgPSBkd19taXBpX2RzaV9nZXRfaGNvbXBvbmVudF9sYmNj
KGRzaSwgdGltaW5ncywgaHRvdGFsKTsKKwlkc2lfd3JpdGUoZHNpLCBEU0lfVklEX0hMSU5FX1RJ
TUUsIGxiY2MpOworCisJbGJjYyA9IGR3X21pcGlfZHNpX2dldF9oY29tcG9uZW50X2xiY2MoZHNp
LCB0aW1pbmdzLCBoc2EpOworCWRzaV93cml0ZShkc2ksIERTSV9WSURfSFNBX1RJTUUsIGxiY2Mp
OworCisJbGJjYyA9IGR3X21pcGlfZHNpX2dldF9oY29tcG9uZW50X2xiY2MoZHNpLCB0aW1pbmdz
LCBoYnApOworCWRzaV93cml0ZShkc2ksIERTSV9WSURfSEJQX1RJTUUsIGxiY2MpOworfQorCitz
dGF0aWMgdm9pZCBkd19taXBpX2RzaV92ZXJ0aWNhbF90aW1pbmdfY29uZmlnKHN0cnVjdCBkd19t
aXBpX2RzaSAqZHNpLAorCQkJCQkgICAgICAgc3RydWN0IGRpc3BsYXlfdGltaW5nICp0aW1pbmdz
KQoreworCXUzMiB2YWN0aXZlLCB2c2EsIHZmcCwgdmJwOworCisJdmFjdGl2ZSA9IHRpbWluZ3Mt
PnZhY3RpdmUudHlwOworCXZzYSA9ICB0aW1pbmdzLT52YmFja19wb3JjaC50eXA7CisJdmZwID0g
IHRpbWluZ3MtPnZmcm9udF9wb3JjaC50eXA7CisJdmJwID0gdGltaW5ncy0+dnN5bmNfbGVuLnR5
cDsKKworCWRzaV93cml0ZShkc2ksIERTSV9WSURfVkFDVElWRV9MSU5FUywgdmFjdGl2ZSk7CisJ
ZHNpX3dyaXRlKGRzaSwgRFNJX1ZJRF9WU0FfTElORVMsIHZzYSk7CisJZHNpX3dyaXRlKGRzaSwg
RFNJX1ZJRF9WRlBfTElORVMsIHZmcCk7CisJZHNpX3dyaXRlKGRzaSwgRFNJX1ZJRF9WQlBfTElO
RVMsIHZicCk7Cit9CisKK3N0YXRpYyB2b2lkIGR3X21pcGlfZHNpX2RwaHlfdGltaW5nX2NvbmZp
ZyhzdHJ1Y3QgZHdfbWlwaV9kc2kgKmRzaSkKK3sKKwl1MzIgaHdfdmVyc2lvbjsKKworCS8qCisJ
ICogVE9ETyBkdyBkcnYgaW1wcm92ZW1lbnRzCisJICogZGF0YSAmIGNsb2NrIGxhbmUgdGltZXJz
IHNob3VsZCBiZSBjb21wdXRlZCBhY2NvcmRpbmcgdG8gcGFuZWwKKwkgKiBibGFua2luZ3MgYW5k
IHRvIHRoZSBhdXRvbWF0aWMgY2xvY2sgbGFuZSBjb250cm9sIG1vZGUuLi4KKwkgKiBub3RlOiBE
U0lfUEhZX1RNUl9DRkcuTUFYX1JEX1RJTUUgc2hvdWxkIGJlIGluIGxpbmUgd2l0aAorCSAqIERT
SV9DTURfTU9ERV9DRkcuTUFYX1JEX1BLVF9TSVpFX0xQIChzZWUgQ01EX01PREVfQUxMX0xQKQor
CSAqLworCisJaHdfdmVyc2lvbiA9IGRzaV9yZWFkKGRzaSwgRFNJX1ZFUlNJT04pICYgVkVSU0lP
TjsKKworCWlmIChod192ZXJzaW9uID49IEhXVkVSXzEzMSkgeworCQlkc2lfd3JpdGUoZHNpLCBE
U0lfUEhZX1RNUl9DRkcsIFBIWV9IUzJMUF9USU1FX1YxMzEoMHg0MCkgfAorCQkJICBQSFlfTFAy
SFNfVElNRV9WMTMxKDB4NDApKTsKKwkJZHNpX3dyaXRlKGRzaSwgRFNJX1BIWV9UTVJfUkRfQ0ZH
LCBNQVhfUkRfVElNRV9WMTMxKDEwMDAwKSk7CisJfSBlbHNlIHsKKwkJZHNpX3dyaXRlKGRzaSwg
RFNJX1BIWV9UTVJfQ0ZHLCBQSFlfSFMyTFBfVElNRSgweDQwKSB8CisJCQkgIFBIWV9MUDJIU19U
SU1FKDB4NDApIHwgTUFYX1JEX1RJTUUoMTAwMDApKTsKKwl9CisKKwlkc2lfd3JpdGUoZHNpLCBE
U0lfUEhZX1RNUl9MUENMS19DRkcsIFBIWV9DTEtIUzJMUF9USU1FKDB4NDApCisJCSAgfCBQSFlf
Q0xLTFAySFNfVElNRSgweDQwKSk7Cit9CisKK3N0YXRpYyB2b2lkIGR3X21pcGlfZHNpX2RwaHlf
aW50ZXJmYWNlX2NvbmZpZyhzdHJ1Y3QgZHdfbWlwaV9kc2kgKmRzaSkKK3sKKwlzdHJ1Y3QgbWlw
aV9kc2lfZGV2aWNlICpkZXZpY2UgPSBkc2ktPmRldmljZTsKKworCS8qCisJICogVE9ETyBkdyBk
cnYgaW1wcm92ZW1lbnRzCisJICogc3RvcCB3YWl0IHRpbWUgc2hvdWxkIGJlIHRoZSBtYXhpbXVt
IGJldHdlZW4gaG9zdCBkc2kKKwkgKiBhbmQgcGFuZWwgc3RvcCB3YWl0IHRpbWVzCisJICovCisJ
ZHNpX3dyaXRlKGRzaSwgRFNJX1BIWV9JRl9DRkcsIFBIWV9TVE9QX1dBSVRfVElNRSgweDIwKSB8
CisJCSAgTl9MQU5FUyhkZXZpY2UtPmxhbmVzKSk7Cit9CisKK3N0YXRpYyB2b2lkIGR3X21pcGlf
ZHNpX2RwaHlfaW5pdChzdHJ1Y3QgZHdfbWlwaV9kc2kgKmRzaSkKK3sKKwkvKiBDbGVhciBQSFkg
c3RhdGUgKi8KKwlkc2lfd3JpdGUoZHNpLCBEU0lfUEhZX1JTVFosIFBIWV9ESVNGT1JDRVBMTCB8
IFBIWV9ESVNBQkxFQ0xLCisJCSAgfCBQSFlfUlNUWiB8IFBIWV9TSFVURE9XTlopOworCWRzaV93
cml0ZShkc2ksIERTSV9QSFlfVFNUX0NUUkwwLCBQSFlfVU5URVNUQ0xSKTsKKwlkc2lfd3JpdGUo
ZHNpLCBEU0lfUEhZX1RTVF9DVFJMMCwgUEhZX1RFU1RDTFIpOworCWRzaV93cml0ZShkc2ksIERT
SV9QSFlfVFNUX0NUUkwwLCBQSFlfVU5URVNUQ0xSKTsKK30KKworc3RhdGljIHZvaWQgZHdfbWlw
aV9kc2lfZHBoeV9lbmFibGUoc3RydWN0IGR3X21pcGlfZHNpICpkc2kpCit7CisJdTMyIHZhbDsK
KwlpbnQgcmV0OworCisJZHNpX3dyaXRlKGRzaSwgRFNJX1BIWV9SU1RaLCBQSFlfRU5GT1JDRVBM
TCB8IFBIWV9FTkFCTEVDTEsgfAorCQkgIFBIWV9VTlJTVFogfCBQSFlfVU5TSFVURE9XTlopOwor
CisJcmV0ID0gcmVhZGxfcG9sbF90aW1lb3V0KGRzaS0+YmFzZSArIERTSV9QSFlfU1RBVFVTLCB2
YWwsCisJCQkJIHZhbCAmIFBIWV9MT0NLLCBQSFlfU1RBVFVTX1RJTUVPVVRfVVMpOworCWlmIChy
ZXQpCisJCWRldl93YXJuKGRzaS0+ZGV2LCAiZmFpbGVkIHRvIHdhaXQgcGh5IGxvY2sgc3RhdGVc
biIpOworCisJcmV0ID0gcmVhZGxfcG9sbF90aW1lb3V0KGRzaS0+YmFzZSArIERTSV9QSFlfU1RB
VFVTLAorCQkJCSB2YWwsIHZhbCAmIFBIWV9TVE9QX1NUQVRFX0NMS19MQU5FLAorCQkJCSBQSFlf
U1RBVFVTX1RJTUVPVVRfVVMpOworCWlmIChyZXQpCisJCWRldl93YXJuKGRzaS0+ZGV2LCAiZmFp
bGVkIHRvIHdhaXQgcGh5IGNsayBsYW5lIHN0b3Agc3RhdGVcbiIpOworfQorCitzdGF0aWMgdm9p
ZCBkd19taXBpX2RzaV9jbGVhcl9lcnIoc3RydWN0IGR3X21pcGlfZHNpICpkc2kpCit7CisJZHNp
X3JlYWQoZHNpLCBEU0lfSU5UX1NUMCk7CisJZHNpX3JlYWQoZHNpLCBEU0lfSU5UX1NUMSk7CisJ
ZHNpX3dyaXRlKGRzaSwgRFNJX0lOVF9NU0swLCAwKTsKKwlkc2lfd3JpdGUoZHNpLCBEU0lfSU5U
X01TSzEsIDApOworfQorCitzdGF0aWMgdm9pZCBkd19taXBpX2RzaV9icmlkZ2Vfc2V0KHN0cnVj
dCBkd19taXBpX2RzaSAqZHNpLAorCQkJCSAgIHN0cnVjdCBkaXNwbGF5X3RpbWluZyAqdGltaW5n
cykKK3sKKwljb25zdCBzdHJ1Y3QgbWlwaV9kc2lfcGh5X29wcyAqcGh5X29wcyA9IGRzaS0+cGh5
X29wczsKKwlzdHJ1Y3QgbWlwaV9kc2lfZGV2aWNlICpkZXZpY2UgPSBkc2ktPmRldmljZTsKKwlp
bnQgcmV0OworCisJcmV0ID0gcGh5X29wcy0+Z2V0X2xhbmVfbWJwcyhkc2ktPmRldmljZSwgdGlt
aW5ncywgZGV2aWNlLT5sYW5lcywKKwkJCQkgICAgIGRldmljZS0+Zm9ybWF0LCAmZHNpLT5sYW5l
X21icHMpOworCWlmIChyZXQpCisJCWRldl93YXJuKGRzaS0+ZGV2LCAiUGh5IGdldF9sYW5lX21i
cHMoKSBmYWlsZWRcbiIpOworCisJZHdfbWlwaV9kc2lfaW5pdF9wbGwoZHNpKTsKKwlkd19taXBp
X2RzaV9kcGlfY29uZmlnKGRzaSwgdGltaW5ncyk7CisJZHdfbWlwaV9kc2lfcGFja2V0X2hhbmRs
ZXJfY29uZmlnKGRzaSk7CisJZHdfbWlwaV9kc2lfdmlkZW9fbW9kZV9jb25maWcoZHNpKTsKKwlk
d19taXBpX2RzaV92aWRlb19wYWNrZXRfY29uZmlnKGRzaSwgdGltaW5ncyk7CisJZHdfbWlwaV9k
c2lfY29tbWFuZF9tb2RlX2NvbmZpZyhkc2kpOworCWR3X21pcGlfZHNpX2xpbmVfdGltZXJfY29u
ZmlnKGRzaSwgdGltaW5ncyk7CisJZHdfbWlwaV9kc2lfdmVydGljYWxfdGltaW5nX2NvbmZpZyhk
c2ksIHRpbWluZ3MpOworCisJZHdfbWlwaV9kc2lfZHBoeV9pbml0KGRzaSk7CisJZHdfbWlwaV9k
c2lfZHBoeV90aW1pbmdfY29uZmlnKGRzaSk7CisJZHdfbWlwaV9kc2lfZHBoeV9pbnRlcmZhY2Vf
Y29uZmlnKGRzaSk7CisKKwlkd19taXBpX2RzaV9jbGVhcl9lcnIoZHNpKTsKKworCXJldCA9IHBo
eV9vcHMtPmluaXQoZHNpLT5kZXZpY2UpOworCWlmIChyZXQpCisJCWRldl93YXJuKGRzaS0+ZGV2
LCAiUGh5IGluaXQoKSBmYWlsZWRcbiIpOworCisJZHdfbWlwaV9kc2lfZHBoeV9lbmFibGUoZHNp
KTsKKworCWR3X21pcGlfZHNpX3dhaXRfZm9yX3R3b19mcmFtZXModGltaW5ncyk7CisKKwkvKiBT
d2l0Y2ggdG8gY21kIG1vZGUgZm9yIHBhbmVsLWJyaWRnZSBwcmVfZW5hYmxlICYgcGFuZWwgcHJl
cGFyZSAqLworCWR3X21pcGlfZHNpX3NldF9tb2RlKGRzaSwgMCk7Cit9CisKK3N0YXRpYyBpbnQg
ZHdfbWlwaV9kc2lfaW5pdChzdHJ1Y3QgdWRldmljZSAqZGV2LAorCQkJICAgIHN0cnVjdCBtaXBp
X2RzaV9kZXZpY2UgKmRldmljZSwKKwkJCSAgICBzdHJ1Y3QgZGlzcGxheV90aW1pbmcgKnRpbWlu
Z3MsCisJCQkgICAgdW5zaWduZWQgaW50IG1heF9kYXRhX2xhbmVzLAorCQkJICAgIGNvbnN0IHN0
cnVjdCBtaXBpX2RzaV9waHlfb3BzICpwaHlfb3BzKQoreworCXN0cnVjdCBkd19taXBpX2RzaSAq
ZHNpID0gZGV2X2dldF9wcml2KGRldik7CisJc3RydWN0IGNsayBjbGs7CisJaW50IHJldDsKKwor
CWlmICghcGh5X29wcy0+aW5pdCB8fCAhcGh5X29wcy0+Z2V0X2xhbmVfbWJwcykgeworCQlkZXZf
ZXJyKGRldmljZS0+ZGV2LCAiUGh5IG5vdCBwcm9wZXJseSBjb25maWd1cmVkXG4iKTsKKwkJcmV0
dXJuIC1FTk9ERVY7CisJfQorCisJZHNpLT5waHlfb3BzID0gcGh5X29wczsKKwlkc2ktPm1heF9k
YXRhX2xhbmVzID0gbWF4X2RhdGFfbGFuZXM7CisJZHNpLT5kZXZpY2UgPSBkZXZpY2U7CisJZHNp
LT5kc2lfaG9zdC5vcHMgPSAmZHdfbWlwaV9kc2lfaG9zdF9vcHM7CisJZGV2aWNlLT5ob3N0ID0g
JmRzaS0+ZHNpX2hvc3Q7CisKKwlkc2ktPmJhc2UgPSAodm9pZCAqKWRldl9yZWFkX2FkZHIoZGV2
aWNlLT5kZXYpOworCWlmICgoZmR0X2FkZHJfdClkc2ktPmJhc2UgPT0gRkRUX0FERFJfVF9OT05F
KSB7CisJCWRldl9lcnIoZGV2aWNlLT5kZXYsICJkc2kgZHQgcmVnaXN0ZXIgYWRkcmVzcyBlcnJv
clxuIik7CisJCXJldHVybiAtRUlOVkFMOworCX0KKworCXJldCA9IGNsa19nZXRfYnlfbmFtZShk
ZXZpY2UtPmRldiwgInB4X2NsayIsICZjbGspOworCWlmIChyZXQpIHsKKwkJZGV2X2VycihkZXZp
Y2UtPmRldiwgInBlcmlwaGVyYWwgY2xvY2sgZ2V0IGVycm9yICVkXG4iLCByZXQpOworCQlyZXR1
cm4gcmV0OworCX0KKworCS8qICBnZXQgdGhlIHBpeGVsIGNsb2NrIHNldCBieSB0aGUgY2xvY2sg
ZnJhbWV3b3JrICovCisJdGltaW5ncy0+cGl4ZWxjbG9jay50eXAgPSBjbGtfZ2V0X3JhdGUoJmNs
ayk7CisKKwlkd19taXBpX2RzaV9icmlkZ2Vfc2V0KGRzaSwgdGltaW5ncyk7CisKKwlyZXR1cm4g
MDsKK30KKworc3RhdGljIGludCBkd19taXBpX2RzaV9lbmFibGUoc3RydWN0IHVkZXZpY2UgKmRl
dikKK3sKKwlzdHJ1Y3QgZHdfbWlwaV9kc2kgKmRzaSA9IGRldl9nZXRfcHJpdihkZXYpOworCisJ
LyogU3dpdGNoIHRvIHZpZGVvIG1vZGUgZm9yIHBhbmVsLWJyaWRnZSBlbmFibGUgJiBwYW5lbCBl
bmFibGUgKi8KKwlkd19taXBpX2RzaV9zZXRfbW9kZShkc2ksIE1JUElfRFNJX01PREVfVklERU8p
OworCisJcmV0dXJuIDA7Cit9CisKK3N0cnVjdCBkc2lfaG9zdF9vcHMgZHdfbWlwaV9kc2lfb3Bz
ID0geworCS5pbml0ID0gZHdfbWlwaV9kc2lfaW5pdCwKKwkuZW5hYmxlID0gZHdfbWlwaV9kc2lf
ZW5hYmxlLAorfTsKKworc3RhdGljIGludCBkd19taXBpX2RzaV9wcm9iZShzdHJ1Y3QgdWRldmlj
ZSAqZGV2KQoreworCXJldHVybiAwOworfQorCitzdGF0aWMgY29uc3Qgc3RydWN0IHVkZXZpY2Vf
aWQgZHdfbWlwaV9kc2lfaWRzW10gPSB7CisJeyAuY29tcGF0aWJsZSA9ICJzeW5vcHN5cyxkdy1t
aXBpLWRzaSIgfSwKKwl7IH0KK307CisKK1VfQk9PVF9EUklWRVIoZHdfbWlwaV9kc2kpID0gewor
CS5uYW1lCQkJPSAiZHdfbWlwaV9kc2kiLAorCS5pZAkJCT0gVUNMQVNTX0RTSV9IT1NULAorCS5v
Zl9tYXRjaAkJPSBkd19taXBpX2RzaV9pZHMsCisJLnByb2JlCQkJPSBkd19taXBpX2RzaV9wcm9i
ZSwKKwkub3BzCQkJPSAmZHdfbWlwaV9kc2lfb3BzLAorCS5wcml2X2F1dG9fYWxsb2Nfc2l6ZQk9
IHNpemVvZihzdHJ1Y3QgZHdfbWlwaV9kc2kpLAorfTsKKworTU9EVUxFX0FVVEhPUigiQ2hyaXMg
WmhvbmcgPHp5d0Byb2NrLWNoaXBzLmNvbT4iKTsKK01PRFVMRV9BVVRIT1IoIlBoaWxpcHBlIENv
cm51IDxwaGlsaXBwZS5jb3JudUBzdC5jb20+Iik7CitNT0RVTEVfQVVUSE9SKCJZYW5uaWNrIEZl
cnRyw6kgPHlhbm5pY2suZmVydHJlQHN0LmNvbT4iKTsKK01PRFVMRV9ERVNDUklQVElPTigiRFcg
TUlQSSBEU0kgaG9zdCBjb250cm9sbGVyIGRyaXZlciIpOworTU9EVUxFX0xJQ0VOU0UoIkdQTCIp
OworTU9EVUxFX0FMSUFTKCJwbGF0Zm9ybTpkdy1taXBpLWRzaSIpOwotLSAKMi43LjQKCl9fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fClVib290LXN0bTMyIG1h
aWxpbmcgbGlzdApVYm9vdC1zdG0zMkBzdC1tZC1tYWlsbWFuLnN0b3JtcmVwbHkuY29tCmh0dHBz
Oi8vc3QtbWQtbWFpbG1hbi5zdG9ybXJlcGx5LmNvbS9tYWlsbWFuL2xpc3RpbmZvL3Vib290LXN0
bTMyCg==
