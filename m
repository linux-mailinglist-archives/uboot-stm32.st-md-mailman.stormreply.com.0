Return-Path: <uboot-stm32-bounces@st-md-mailman.stormreply.com>
X-Original-To: lists+uboot-stm32@lfdr.de
Delivered-To: lists+uboot-stm32@lfdr.de
Received: from stm-ict-prod-mailman-01.stormreply.prv (st-md-mailman.stormreply.com [52.209.6.89])
	by mail.lfdr.de (Postfix) with ESMTPS id 97230B1B2E
	for <lists+uboot-stm32@lfdr.de>; Fri, 13 Sep 2019 11:53:44 +0200 (CEST)
Received: from ip-172-31-3-76.eu-west-1.compute.internal (localhost [127.0.0.1])
	by stm-ict-prod-mailman-01.stormreply.prv (Postfix) with ESMTP id 6429BC35E06
	for <lists+uboot-stm32@lfdr.de>; Fri, 13 Sep 2019 09:53:44 +0000 (UTC)
Received: from mx07-00178001.pphosted.com (mx08-00178001.pphosted.com
 [91.207.212.93])
 (using TLSv1.2 with cipher ECDHE-RSA-AES256-GCM-SHA384 (256/256 bits))
 (No client certificate requested)
 by stm-ict-prod-mailman-01.stormreply.prv (Postfix) with ESMTPS id 30866C36B3F
 for <uboot-stm32@st-md-mailman.stormreply.com>;
 Fri, 13 Sep 2019 09:48:45 +0000 (UTC)
Received: from pps.filterd (m0046661.ppops.net [127.0.0.1])
 by mx08-00178001.pphosted.com (8.16.0.42/8.16.0.42) with SMTP id
 x8D9jnSO018758; Fri, 13 Sep 2019 11:48:40 +0200
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=st.com;
 h=from : to : subject :
 date : message-id : in-reply-to : references : mime-version : content-type
 : content-transfer-encoding; s=STMicroelectronics;
 bh=2vjdPOmEktEBBXLkQHxoMH68uYQbPggeYI6btq0OM+0=;
 b=VVo8FlKWWtw9vrgvmDuQhaIPoEs/4AM5+K1hUZI+6xBQzTcJbwrWH2EriCoyciwfBft/
 /OxK/UTY/LrDnFLmlQY23+ZkOTY41TCQwRIKPl3gjwjK2L7Y0xgKbsNwntVZ7F1hsscH
 JsS0KtgH67WryqNM37uGWcSTnmUFWEsFfkTtdTbGcDUSTGJQ9wXQhtoZbspfwA34KVFc
 os1O90Gg9csCPDwm1TziKvWgxy4Dwh7Se0WU2+lvzF2KOP34prIPMr2lAMVQBh7UVA88
 AiG9S2PS8XWSP3m2Yo3H6sOUhEkdFpWIz2mub+AmtGJRnek/uWJ7mE5aIIU7icdlvssP ew== 
Received: from beta.dmz-ap.st.com (beta.dmz-ap.st.com [138.198.100.35])
 by mx08-00178001.pphosted.com with ESMTP id 2uyte3v535-1
 (version=TLSv1 cipher=ECDHE-RSA-AES256-SHA bits=256 verify=NOT);
 Fri, 13 Sep 2019 11:48:40 +0200
Received: from euls16034.sgp.st.com (euls16034.sgp.st.com [10.75.44.20])
 by beta.dmz-ap.st.com (STMicroelectronics) with ESMTP id C844223;
 Fri, 13 Sep 2019 09:48:36 +0000 (GMT)
Received: from Webmail-eu.st.com (Safex1hubcas22.st.com [10.75.90.92])
 by euls16034.sgp.st.com (STMicroelectronics) with ESMTP id 854192BB882;
 Fri, 13 Sep 2019 11:48:36 +0200 (CEST)
Received: from SAFEX1HUBCAS21.st.com (10.75.90.45) by Safex1hubcas22.st.com
 (10.75.90.92) with Microsoft SMTP Server (TLS) id 14.3.439.0; Fri, 13 Sep
 2019 11:48:36 +0200
Received: from localhost (10.201.23.97) by Webmail-ga.st.com (10.75.90.48)
 with Microsoft SMTP Server (TLS) id 14.3.439.0; Fri, 13 Sep 2019 11:48:35
 +0200
From: =?UTF-8?q?Yannick=20Fertr=C3=A9?= <yannick.fertre@st.com>
To: Vikas Manocha <vikas.manocha@st.com>, Benjamin Gaignard
 <benjamin.gaignard@st.com>, Albert Aribaud <albert.u.boot@aribaud.net>,
 Patrick Delaunay <patrick.delaunay@st.com>,
 Simon Glass <sjg@chromium.org>, Anatolij Gustschin <agust@denx.de>,
 Patrice Chotard <patrice.chotard@st.com>,
 =?UTF-8?q?Yannick=20Fertr=C3=A9?= <yannick.fertre@st.com>, Philippe Cornu
 <philippe.cornu@st.com>, Jens Wiklander <jens.wiklander@linaro.org>, "Eugen
 Hristev" <eugen.hristev@microchip.com>, Heinrich Schuchardt
 <xypron.glpk@gmx.de>, Simon Goldschmidt <simon.k.r.goldschmidt@gmail.com>,
 <u-boot@lists.denx.de>, <uboot-stm32@st-md-mailman.stormreply.com>
Date: Fri, 13 Sep 2019 11:47:54 +0200
Message-ID: <1568368083-11075-7-git-send-email-yannick.fertre@st.com>
X-Mailer: git-send-email 2.7.4
In-Reply-To: <1568368083-11075-1-git-send-email-yannick.fertre@st.com>
References: <1568368083-11075-1-git-send-email-yannick.fertre@st.com>
MIME-Version: 1.0
X-Originating-IP: [10.201.23.97]
X-Proofpoint-Virus-Version: vendor=fsecure engine=2.50.10434:6.0.70,1.0.8
 definitions=2019-09-13_05:2019-09-11,2019-09-13 signatures=0
X-Mailman-Approved-At: Fri, 13 Sep 2019 09:53:41 +0000
Subject: [Uboot-stm32] [PATCH v4 06/15] video: add MIPI DSI host controller
	bridge
X-BeenThere: uboot-stm32@st-md-mailman.stormreply.com
X-Mailman-Version: 2.1.15
Precedence: list
List-Id: <uboot-stm32.st-md-mailman.stormreply.com>
List-Unsubscribe: <https://st-md-mailman.stormreply.com/mailman/options/uboot-stm32>, 
 <mailto:uboot-stm32-request@st-md-mailman.stormreply.com?subject=unsubscribe>
List-Archive: <http://st-md-mailman.stormreply.com/pipermail/uboot-stm32/>
List-Post: <mailto:uboot-stm32@st-md-mailman.stormreply.com>
List-Help: <mailto:uboot-stm32-request@st-md-mailman.stormreply.com?subject=help>
List-Subscribe: <https://st-md-mailman.stormreply.com/mailman/listinfo/uboot-stm32>, 
 <mailto:uboot-stm32-request@st-md-mailman.stormreply.com?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: uboot-stm32-bounces@st-md-mailman.stormreply.com
Sender: "Uboot-stm32" <uboot-stm32-bounces@st-md-mailman.stormreply.com>

QWRkIGEgU3lub3BzeXMgRGVzaWdud2FyZSBNSVBJIERTSSBob3N0IGJyaWRnZSBkcml2ZXIsIGJh
c2VkIG9uIHRoZQpSb2NrY2hpcCB2ZXJzaW9uIGZyb20gcm9ja2NoaXAvZHctbWlwaS1kc2kuYyB3
aXRoIHBoeSAmIGJyaWRnZSBBUElzLgoKU2lnbmVkLW9mZi1ieTogWWFubmljayBGZXJ0csOpIDx5
YW5uaWNrLmZlcnRyZUBzdC5jb20+Ci0tLQogZHJpdmVycy92aWRlby9LY29uZmlnICAgICAgIHwg
IDEwICsKIGRyaXZlcnMvdmlkZW8vTWFrZWZpbGUgICAgICB8ICAgMSArCiBkcml2ZXJzL3ZpZGVv
L2R3X21pcGlfZHNpLmMgfCA4MzggKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysr
KysrKysrKysKIDMgZmlsZXMgY2hhbmdlZCwgODQ5IGluc2VydGlvbnMoKykKIGNyZWF0ZSBtb2Rl
IDEwMDY0NCBkcml2ZXJzL3ZpZGVvL2R3X21pcGlfZHNpLmMKCmRpZmYgLS1naXQgYS9kcml2ZXJz
L3ZpZGVvL0tjb25maWcgYi9kcml2ZXJzL3ZpZGVvL0tjb25maWcKaW5kZXggNTU0YjdkYi4uYTU1
Y2RjNiAxMDA2NDQKLS0tIGEvZHJpdmVycy92aWRlby9LY29uZmlnCisrKyBiL2RyaXZlcnMvdmlk
ZW8vS2NvbmZpZwpAQCAtNjkzLDYgKzY5MywxNiBAQCBjb25maWcgVklERU9fRFNJX0hPU1RfU0FO
REJPWAogCSAgRW5hYmxlIHN1cHBvcnQgZm9yIHNhbmRib3ggZHNpIGhvc3QgZGV2aWNlIHVzZWQg
Zm9yIHRlc3RpbmcKIAkgIHB1cnBvc2VzLgogCitjb25maWcgVklERU9fRFdfTUlQSV9EU0kKKwli
b29sCisJc2VsZWN0IFZJREVPX01JUElfRFNJCisJaGVscAorCSAgRW5hYmxlcyB0aGUgY29tbW9u
IGRyaXZlciBjb2RlIGZvciB0aGUgU3lub3BzaXMgRGVzaWdud2FyZQorCSAgTUlQSSBEU0kgYmxv
Y2sgZm91bmQgaW4gU29DcyBmcm9tIHZhcmlvdXMgdmVuZG9ycy4KKwkgIEFzIHRoaXMgZG9lcyBu
b3QgcHJvdmlkZSBhbnkgZnVuY3Rpb25hbGl0eSBieSBpdHNlbGYgKGJ1dAorCSAgcmF0aGVyIHJl
cXVpcmVzIGEgU29DLXNwZWNpZmljIGdsdWUgZHJpdmVyIHRvIGNhbGwgaXQpLCBpdAorCSAgY2Fu
IG5vdCBiZSBlbmFibGVkIGZyb20gdGhlIGNvbmZpZ3VyYXRpb24gbWVudS4KKwogY29uZmlnIFZJ
REVPX1NJTVBMRQogCWJvb2wgIlNpbXBsZSBkaXNwbGF5IGRyaXZlciBmb3IgcHJlY29uZmlndXJl
ZCBkaXNwbGF5IgogCWhlbHAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvdmlkZW8vTWFrZWZpbGUgYi9k
cml2ZXJzL3ZpZGVvL01ha2VmaWxlCmluZGV4IDVlZDM1OTAuLjU4MjEwZWMgMTAwNjQ0Ci0tLSBh
L2RyaXZlcnMvdmlkZW8vTWFrZWZpbGUKKysrIGIvZHJpdmVycy92aWRlby9NYWtlZmlsZQpAQCAt
NDUsNiArNDUsNyBAQCBvYmotJChDT05GSUdfVklERU9fQlJPQURXRUxMX0lHRCkgKz0gYnJvYWR3
ZWxsX2lnZC5vCiBvYmotJChDT05GSUdfVklERU9fQ09SRUJPT1QpICs9IGNvcmVib290Lm8KIG9i
ai0kKENPTkZJR19WSURFT19EQThYWCkgKz0gZGE4eHgtZmIubyB2aWRlb21vZGVzLm8KIG9iai0k
KENPTkZJR19WSURFT19EV19IRE1JKSArPSBkd19oZG1pLm8KK29iai0kKENPTkZJR19WSURFT19E
V19NSVBJX0RTSSkgKz0gZHdfbWlwaV9kc2kubwogb2JqLSQoQ09ORklHX1ZJREVPX0VGSSkgKz0g
ZWZpLm8KIG9iai0kKENPTkZJR19WSURFT19GU0xfRENVX0ZCKSArPSBmc2xfZGN1X2ZiLm8gdmlk
ZW9tb2Rlcy5vCiBvYmotJChDT05GSUdfVklERU9fSVBVVjMpICs9IGlteC8KZGlmZiAtLWdpdCBh
L2RyaXZlcnMvdmlkZW8vZHdfbWlwaV9kc2kuYyBiL2RyaXZlcnMvdmlkZW8vZHdfbWlwaV9kc2ku
YwpuZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwLi4wNGIwN2UzCi0tLSAvZGV2L251
bGwKKysrIGIvZHJpdmVycy92aWRlby9kd19taXBpX2RzaS5jCkBAIC0wLDAgKzEsODM4IEBACisv
LyBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMCsKKy8qCisgKiBDb3B5cmlnaHQgKEMp
IDIwMTYsIEZ1emhvdSBSb2NrY2hpcCBFbGVjdHJvbmljcyBDby4sIEx0ZAorICogQ29weXJpZ2h0
IChDKSAyMDE5LCBTVE1pY3JvZWxlY3Ryb25pY3MgLSBBbGwgUmlnaHRzIFJlc2VydmVkCisgKiBB
dXRob3Iocyk6IFBoaWxpcHBlIENvcm51IDxwaGlsaXBwZS5jb3JudUBzdC5jb20+IGZvciBTVE1p
Y3JvZWxlY3Ryb25pY3MuCisgKiAgICAgICAgICAgIFlhbm5pY2sgRmVydHJlIDx5YW5uaWNrLmZl
cnRyZUBzdC5jb20+IGZvciBTVE1pY3JvZWxlY3Ryb25pY3MuCisgKgorICogVGhpcyBnZW5lcmlj
IFN5bm9wc3lzIERlc2lnbldhcmUgTUlQSSBEU0kgaG9zdCBkcml2ZXIgaXMgaW5zcGlyZWQgZnJv
bQorICogdGhlIExpbnV4IEtlcm5lbCBkcml2ZXIgZHJpdmVycy9ncHUvZHJtL2JyaWRnZS9zeW5v
cHN5cy9kdy1taXBpLWRzaS5jLgorICovCisKKyNpbmNsdWRlIDxjb21tb24uaD4KKyNpbmNsdWRl
IDxjbGsuaD4KKyNpbmNsdWRlIDxkc2lfaG9zdC5oPgorI2luY2x1ZGUgPGRtLmg+CisjaW5jbHVk
ZSA8ZXJybm8uaD4KKyNpbmNsdWRlIDxwYW5lbC5oPgorI2luY2x1ZGUgPHZpZGVvLmg+CisjaW5j
bHVkZSA8YXNtL2lvLmg+CisjaW5jbHVkZSA8YXNtL2FyY2gvZ3Bpby5oPgorI2luY2x1ZGUgPGRt
L2RldmljZS1pbnRlcm5hbC5oPgorI2luY2x1ZGUgPGxpbnV4L2lvcG9sbC5oPgorI2luY2x1ZGUg
PHZpZGVvX2JyaWRnZS5oPgorCisjZGVmaW5lIEhXVkVSXzEzMQkJCTB4MzEzMzMxMDAJLyogSVAg
dmVyc2lvbiAxLjMxICovCisKKyNkZWZpbmUgRFNJX1ZFUlNJT04JCQkweDAwCisjZGVmaW5lIFZF
UlNJT04JCQkJR0VOTUFTSygzMSwgOCkKKworI2RlZmluZSBEU0lfUFdSX1VQCQkJMHgwNAorI2Rl
ZmluZSBSRVNFVAkJCQkwCisjZGVmaW5lIFBPV0VSVVAJCQkJQklUKDApCisKKyNkZWZpbmUgRFNJ
X0NMS01HUl9DRkcJCQkweDA4CisjZGVmaW5lIFRPX0NMS19ESVZJU0lPTihkaXYpCQkoKChkaXYp
ICYgMHhmZikgPDwgOCkKKyNkZWZpbmUgVFhfRVNDX0NMS19ESVZJU0lPTihkaXYpCSgoZGl2KSAm
IDB4ZmYpCisKKyNkZWZpbmUgRFNJX0RQSV9WQ0lECQkJMHgwYworI2RlZmluZSBEUElfVkNJRCh2
Y2lkKQkJCSgodmNpZCkgJiAweDMpCisKKyNkZWZpbmUgRFNJX0RQSV9DT0xPUl9DT0RJTkcJCTB4
MTAKKyNkZWZpbmUgTE9PU0VMWTE4X0VOCQkJQklUKDgpCisjZGVmaW5lIERQSV9DT0xPUl9DT0RJ
TkdfMTZCSVRfMQkweDAKKyNkZWZpbmUgRFBJX0NPTE9SX0NPRElOR18xNkJJVF8yCTB4MQorI2Rl
ZmluZSBEUElfQ09MT1JfQ09ESU5HXzE2QklUXzMJMHgyCisjZGVmaW5lIERQSV9DT0xPUl9DT0RJ
TkdfMThCSVRfMQkweDMKKyNkZWZpbmUgRFBJX0NPTE9SX0NPRElOR18xOEJJVF8yCTB4NAorI2Rl
ZmluZSBEUElfQ09MT1JfQ09ESU5HXzI0QklUCQkweDUKKworI2RlZmluZSBEU0lfRFBJX0NGR19Q
T0wJCQkweDE0CisjZGVmaW5lIENPTE9STV9BQ1RJVkVfTE9XCQlCSVQoNCkKKyNkZWZpbmUgU0hV
VERfQUNUSVZFX0xPVwkJQklUKDMpCisjZGVmaW5lIEhTWU5DX0FDVElWRV9MT1cJCUJJVCgyKQor
I2RlZmluZSBWU1lOQ19BQ1RJVkVfTE9XCQlCSVQoMSkKKyNkZWZpbmUgREFUQUVOX0FDVElWRV9M
T1cJCUJJVCgwKQorCisjZGVmaW5lIERTSV9EUElfTFBfQ01EX1RJTQkJMHgxOAorI2RlZmluZSBP
VVRWQUNUX0xQQ01EX1RJTUUocCkJCSgoKHApICYgMHhmZikgPDwgMTYpCisjZGVmaW5lIElOVkFD
VF9MUENNRF9USU1FKHApCQkoKHApICYgMHhmZikKKworI2RlZmluZSBEU0lfREJJX1ZDSUQJCQkw
eDFjCisjZGVmaW5lIERTSV9EQklfQ0ZHCQkJMHgyMAorI2RlZmluZSBEU0lfREJJX1BBUlRJVElP
TklOR19FTgkJMHgyNAorI2RlZmluZSBEU0lfREJJX0NNRFNJWkUJCQkweDI4CisKKyNkZWZpbmUg
RFNJX1BDS0hETF9DRkcJCQkweDJjCisjZGVmaW5lIENSQ19SWF9FTgkJCUJJVCg0KQorI2RlZmlu
ZSBFQ0NfUlhfRU4JCQlCSVQoMykKKyNkZWZpbmUgQlRBX0VOCQkJCUJJVCgyKQorI2RlZmluZSBF
T1RQX1JYX0VOCQkJQklUKDEpCisjZGVmaW5lIEVPVFBfVFhfRU4JCQlCSVQoMCkKKworI2RlZmlu
ZSBEU0lfR0VOX1ZDSUQJCQkweDMwCisKKyNkZWZpbmUgRFNJX01PREVfQ0ZHCQkJMHgzNAorI2Rl
ZmluZSBFTkFCTEVfVklERU9fTU9ERQkJMAorI2RlZmluZSBFTkFCTEVfQ01EX01PREUJCQlCSVQo
MCkKKworI2RlZmluZSBEU0lfVklEX01PREVfQ0ZHCQkweDM4CisjZGVmaW5lIEVOQUJMRV9MT1df
UE9XRVIJCSgweDNmIDw8IDgpCisjZGVmaW5lIEVOQUJMRV9MT1dfUE9XRVJfTUFTSwkJKDB4M2Yg
PDwgOCkKKyNkZWZpbmUgVklEX01PREVfVFlQRV9OT05fQlVSU1RfU1lOQ19QVUxTRVMJMHgwCisj
ZGVmaW5lIFZJRF9NT0RFX1RZUEVfTk9OX0JVUlNUX1NZTkNfRVZFTlRTCTB4MQorI2RlZmluZSBW
SURfTU9ERV9UWVBFX0JVUlNUCQkJMHgyCisjZGVmaW5lIFZJRF9NT0RFX1RZUEVfTUFTSwkJCTB4
MworCisjZGVmaW5lIERTSV9WSURfUEtUX1NJWkUJCTB4M2MKKyNkZWZpbmUgVklEX1BLVF9TSVpF
KHApCQkJKChwKSAmIDB4M2ZmZikKKworI2RlZmluZSBEU0lfVklEX05VTV9DSFVOS1MJCTB4NDAK
KyNkZWZpbmUgVklEX05VTV9DSFVOS1MoYykJCSgoYykgJiAweDFmZmYpCisKKyNkZWZpbmUgRFNJ
X1ZJRF9OVUxMX1NJWkUJCTB4NDQKKyNkZWZpbmUgVklEX05VTExfU0laRShiKQkJKChiKSAmIDB4
MWZmZikKKworI2RlZmluZSBEU0lfVklEX0hTQV9USU1FCQkweDQ4CisjZGVmaW5lIERTSV9WSURf
SEJQX1RJTUUJCTB4NGMKKyNkZWZpbmUgRFNJX1ZJRF9ITElORV9USU1FCQkweDUwCisjZGVmaW5l
IERTSV9WSURfVlNBX0xJTkVTCQkweDU0CisjZGVmaW5lIERTSV9WSURfVkJQX0xJTkVTCQkweDU4
CisjZGVmaW5lIERTSV9WSURfVkZQX0xJTkVTCQkweDVjCisjZGVmaW5lIERTSV9WSURfVkFDVElW
RV9MSU5FUwkJMHg2MAorI2RlZmluZSBEU0lfRURQSV9DTURfU0laRQkJMHg2NAorCisjZGVmaW5l
IERTSV9DTURfTU9ERV9DRkcJCTB4NjgKKyNkZWZpbmUgTUFYX1JEX1BLVF9TSVpFX0xQCQlCSVQo
MjQpCisjZGVmaW5lIERDU19MV19UWF9MUAkJCUJJVCgxOSkKKyNkZWZpbmUgRENTX1NSXzBQX1RY
X0xQCQkJQklUKDE4KQorI2RlZmluZSBEQ1NfU1dfMVBfVFhfTFAJCQlCSVQoMTcpCisjZGVmaW5l
IERDU19TV18wUF9UWF9MUAkJCUJJVCgxNikKKyNkZWZpbmUgR0VOX0xXX1RYX0xQCQkJQklUKDE0
KQorI2RlZmluZSBHRU5fU1JfMlBfVFhfTFAJCQlCSVQoMTMpCisjZGVmaW5lIEdFTl9TUl8xUF9U
WF9MUAkJCUJJVCgxMikKKyNkZWZpbmUgR0VOX1NSXzBQX1RYX0xQCQkJQklUKDExKQorI2RlZmlu
ZSBHRU5fU1dfMlBfVFhfTFAJCQlCSVQoMTApCisjZGVmaW5lIEdFTl9TV18xUF9UWF9MUAkJCUJJ
VCg5KQorI2RlZmluZSBHRU5fU1dfMFBfVFhfTFAJCQlCSVQoOCkKKyNkZWZpbmUgQUNLX1JRU1Rf
RU4JCQlCSVQoMSkKKyNkZWZpbmUgVEVBUl9GWF9FTgkJCUJJVCgwKQorCisjZGVmaW5lIENNRF9N
T0RFX0FMTF9MUAkJCShNQVhfUkRfUEtUX1NJWkVfTFAgfCBcCisJCQkJCSBEQ1NfTFdfVFhfTFAg
fCBcCisJCQkJCSBEQ1NfU1JfMFBfVFhfTFAgfCBcCisJCQkJCSBEQ1NfU1dfMVBfVFhfTFAgfCBc
CisJCQkJCSBEQ1NfU1dfMFBfVFhfTFAgfCBcCisJCQkJCSBHRU5fTFdfVFhfTFAgfCBcCisJCQkJ
CSBHRU5fU1JfMlBfVFhfTFAgfCBcCisJCQkJCSBHRU5fU1JfMVBfVFhfTFAgfCBcCisJCQkJCSBH
RU5fU1JfMFBfVFhfTFAgfCBcCisJCQkJCSBHRU5fU1dfMlBfVFhfTFAgfCBcCisJCQkJCSBHRU5f
U1dfMVBfVFhfTFAgfCBcCisJCQkJCSBHRU5fU1dfMFBfVFhfTFApCisKKyNkZWZpbmUgRFNJX0dF
Tl9IRFIJCQkweDZjCisjZGVmaW5lIERTSV9HRU5fUExEX0RBVEEJCTB4NzAKKworI2RlZmluZSBE
U0lfQ01EX1BLVF9TVEFUVVMJCTB4NzQKKyNkZWZpbmUgR0VOX1JEX0NNRF9CVVNZCQkJQklUKDYp
CisjZGVmaW5lIEdFTl9QTERfUl9GVUxMCQkJQklUKDUpCisjZGVmaW5lIEdFTl9QTERfUl9FTVBU
WQkJCUJJVCg0KQorI2RlZmluZSBHRU5fUExEX1dfRlVMTAkJCUJJVCgzKQorI2RlZmluZSBHRU5f
UExEX1dfRU1QVFkJCQlCSVQoMikKKyNkZWZpbmUgR0VOX0NNRF9GVUxMCQkJQklUKDEpCisjZGVm
aW5lIEdFTl9DTURfRU1QVFkJCQlCSVQoMCkKKworI2RlZmluZSBEU0lfVE9fQ05UX0NGRwkJCTB4
NzgKKyNkZWZpbmUgSFNUWF9UT19DTlQocCkJCQkoKChwKSAmIDB4ZmZmZikgPDwgMTYpCisjZGVm
aW5lIExQUlhfVE9fQ05UKHApCQkJKChwKSAmIDB4ZmZmZikKKworI2RlZmluZSBEU0lfSFNfUkRf
VE9fQ05UCQkweDdjCisjZGVmaW5lIERTSV9MUF9SRF9UT19DTlQJCTB4ODAKKyNkZWZpbmUgRFNJ
X0hTX1dSX1RPX0NOVAkJMHg4NAorI2RlZmluZSBEU0lfTFBfV1JfVE9fQ05UCQkweDg4CisjZGVm
aW5lIERTSV9CVEFfVE9fQ05UCQkJMHg4YworCisjZGVmaW5lIERTSV9MUENMS19DVFJMCQkJMHg5
NAorI2RlZmluZSBBVVRPX0NMS0xBTkVfQ1RSTAkJQklUKDEpCisjZGVmaW5lIFBIWV9UWFJFUVVF
U1RDTEtIUwkJQklUKDApCisKKyNkZWZpbmUgRFNJX1BIWV9UTVJfTFBDTEtfQ0ZHCQkweDk4Cisj
ZGVmaW5lIFBIWV9DTEtIUzJMUF9USU1FKGxiY2MpCQkoKChsYmNjKSAmIDB4M2ZmKSA8PCAxNikK
KyNkZWZpbmUgUEhZX0NMS0xQMkhTX1RJTUUobGJjYykJCSgobGJjYykgJiAweDNmZikKKworI2Rl
ZmluZSBEU0lfUEhZX1RNUl9DRkcJCQkweDljCisjZGVmaW5lIFBIWV9IUzJMUF9USU1FKGxiY2Mp
CQkoKChsYmNjKSAmIDB4ZmYpIDw8IDI0KQorI2RlZmluZSBQSFlfTFAySFNfVElNRShsYmNjKQkJ
KCgobGJjYykgJiAweGZmKSA8PCAxNikKKyNkZWZpbmUgTUFYX1JEX1RJTUUobGJjYykJCSgobGJj
YykgJiAweDdmZmYpCisjZGVmaW5lIFBIWV9IUzJMUF9USU1FX1YxMzEobGJjYykJKCgobGJjYykg
JiAweDNmZikgPDwgMTYpCisjZGVmaW5lIFBIWV9MUDJIU19USU1FX1YxMzEobGJjYykJKChsYmNj
KSAmIDB4M2ZmKQorCisjZGVmaW5lIERTSV9QSFlfUlNUWgkJCTB4YTAKKyNkZWZpbmUgUEhZX0RJ
U0ZPUkNFUExMCQkJMAorI2RlZmluZSBQSFlfRU5GT1JDRVBMTAkJCUJJVCgzKQorI2RlZmluZSBQ
SFlfRElTQUJMRUNMSwkJCTAKKyNkZWZpbmUgUEhZX0VOQUJMRUNMSwkJCUJJVCgyKQorI2RlZmlu
ZSBQSFlfUlNUWgkJCTAKKyNkZWZpbmUgUEhZX1VOUlNUWgkJCUJJVCgxKQorI2RlZmluZSBQSFlf
U0hVVERPV05aCQkJMAorI2RlZmluZSBQSFlfVU5TSFVURE9XTloJCQlCSVQoMCkKKworI2RlZmlu
ZSBEU0lfUEhZX0lGX0NGRwkJCTB4YTQKKyNkZWZpbmUgUEhZX1NUT1BfV0FJVF9USU1FKGN5Y2xl
KQkoKChjeWNsZSkgJiAweGZmKSA8PCA4KQorI2RlZmluZSBOX0xBTkVTKG4pCQkJKCgobikgLSAx
KSAmIDB4MykKKworI2RlZmluZSBEU0lfUEhZX1VMUFNfQ1RSTAkJMHhhOAorI2RlZmluZSBEU0lf
UEhZX1RYX1RSSUdHRVJTCQkweGFjCisKKyNkZWZpbmUgRFNJX1BIWV9TVEFUVVMJCQkweGIwCisj
ZGVmaW5lIFBIWV9TVE9QX1NUQVRFX0NMS19MQU5FCQlCSVQoMikKKyNkZWZpbmUgUEhZX0xPQ0sJ
CQlCSVQoMCkKKworI2RlZmluZSBEU0lfUEhZX1RTVF9DVFJMMAkJMHhiNAorI2RlZmluZSBQSFlf
VEVTVENMSwkJCUJJVCgxKQorI2RlZmluZSBQSFlfVU5URVNUQ0xLCQkJMAorI2RlZmluZSBQSFlf
VEVTVENMUgkJCUJJVCgwKQorI2RlZmluZSBQSFlfVU5URVNUQ0xSCQkJMAorCisjZGVmaW5lIERT
SV9QSFlfVFNUX0NUUkwxCQkweGI4CisjZGVmaW5lIFBIWV9URVNURU4JCQlCSVQoMTYpCisjZGVm
aW5lIFBIWV9VTlRFU1RFTgkJCTAKKyNkZWZpbmUgUEhZX1RFU1RET1VUKG4pCQkJKCgobikgJiAw
eGZmKSA8PCA4KQorI2RlZmluZSBQSFlfVEVTVERJTihuKQkJCSgobikgJiAweGZmKQorCisjZGVm
aW5lIERTSV9JTlRfU1QwCQkJMHhiYworI2RlZmluZSBEU0lfSU5UX1NUMQkJCTB4YzAKKyNkZWZp
bmUgRFNJX0lOVF9NU0swCQkJMHhjNAorI2RlZmluZSBEU0lfSU5UX01TSzEJCQkweGM4CisKKyNk
ZWZpbmUgRFNJX1BIWV9UTVJfUkRfQ0ZHCQkweGY0CisjZGVmaW5lIE1BWF9SRF9USU1FX1YxMzEo
bGJjYykJCSgobGJjYykgJiAweDdmZmYpCisKKyNkZWZpbmUgUEhZX1NUQVRVU19USU1FT1VUX1VT
CQkxMDAwMAorI2RlZmluZSBDTURfUEtUX1NUQVRVU19USU1FT1VUX1VTCTIwMDAwCisKKyNkZWZp
bmUgTVNFQ19QRVJfU0VDCQkJMTAwMAorCitzdHJ1Y3QgZHdfbWlwaV9kc2kgeworCXN0cnVjdCBt
aXBpX2RzaV9ob3N0IGRzaV9ob3N0OworCXN0cnVjdCBtaXBpX2RzaV9kZXZpY2UgKmRldmljZTsK
Kwl2b2lkIF9faW9tZW0gKmJhc2U7CisJdW5zaWduZWQgaW50IGxhbmVfbWJwczsgLyogcGVyIGxh
bmUgKi8KKwl1MzIgY2hhbm5lbDsKKwl1bnNpZ25lZCBpbnQgbWF4X2RhdGFfbGFuZXM7CisJY29u
c3Qgc3RydWN0IG1pcGlfZHNpX3BoeV9vcHMgKnBoeV9vcHM7Cit9OworCitzdGF0aWMgaW50IGRz
aV9tb2RlX3ZyZWZyZXNoKHN0cnVjdCBkaXNwbGF5X3RpbWluZyAqdGltaW5ncykKK3sKKwlpbnQg
cmVmcmVzaCA9IDA7CisJdW5zaWduZWQgaW50IGNhbGNfdmFsOworCXUzMiBodG90YWwgPSB0aW1p
bmdzLT5oYWN0aXZlLnR5cCArIHRpbWluZ3MtPmhmcm9udF9wb3JjaC50eXAgKworCQkgICAgIHRp
bWluZ3MtPmhiYWNrX3BvcmNoLnR5cCArIHRpbWluZ3MtPmhzeW5jX2xlbi50eXA7CisJdTMyIHZ0
b3RhbCA9IHRpbWluZ3MtPnZhY3RpdmUudHlwICsgdGltaW5ncy0+dmZyb250X3BvcmNoLnR5cCAr
CisJCSAgICAgdGltaW5ncy0+dmJhY2tfcG9yY2gudHlwICsgdGltaW5ncy0+dnN5bmNfbGVuLnR5
cDsKKworCWlmIChodG90YWwgPiAwICYmIHZ0b3RhbCA+IDApIHsKKwkJY2FsY192YWwgPSB0aW1p
bmdzLT5waXhlbGNsb2NrLnR5cDsKKwkJY2FsY192YWwgLz0gaHRvdGFsOworCQlyZWZyZXNoID0g
KGNhbGNfdmFsICsgdnRvdGFsIC8gMikgLyB2dG90YWw7CisJfQorCisJcmV0dXJuIHJlZnJlc2g7
Cit9CisKKy8qCisgKiBUaGUgY29udHJvbGxlciBzaG91bGQgZ2VuZXJhdGUgMiBmcmFtZXMgYmVm
b3JlCisgKiBwcmVwYXJpbmcgdGhlIHBlcmlwaGVyYWwuCisgKi8KK3N0YXRpYyB2b2lkIGR3X21p
cGlfZHNpX3dhaXRfZm9yX3R3b19mcmFtZXMoc3RydWN0IGRpc3BsYXlfdGltaW5nICp0aW1pbmdz
KQoreworCWludCByZWZyZXNoLCB0d29fZnJhbWVzOworCisJcmVmcmVzaCA9IGRzaV9tb2RlX3Zy
ZWZyZXNoKHRpbWluZ3MpOworCXR3b19mcmFtZXMgPSBESVZfUk9VTkRfVVAoTVNFQ19QRVJfU0VD
LCByZWZyZXNoKSAqIDI7CisJbWRlbGF5KHR3b19mcmFtZXMpOworfQorCitzdGF0aWMgaW5saW5l
IHN0cnVjdCBkd19taXBpX2RzaSAqaG9zdF90b19kc2koc3RydWN0IG1pcGlfZHNpX2hvc3QgKmhv
c3QpCit7CisJcmV0dXJuIGNvbnRhaW5lcl9vZihob3N0LCBzdHJ1Y3QgZHdfbWlwaV9kc2ksIGRz
aV9ob3N0KTsKK30KKworc3RhdGljIGlubGluZSB2b2lkIGRzaV93cml0ZShzdHJ1Y3QgZHdfbWlw
aV9kc2kgKmRzaSwgdTMyIHJlZywgdTMyIHZhbCkKK3sKKwl3cml0ZWwodmFsLCBkc2ktPmJhc2Ug
KyByZWcpOworfQorCitzdGF0aWMgaW5saW5lIHUzMiBkc2lfcmVhZChzdHJ1Y3QgZHdfbWlwaV9k
c2kgKmRzaSwgdTMyIHJlZykKK3sKKwlyZXR1cm4gcmVhZGwoZHNpLT5iYXNlICsgcmVnKTsKK30K
Kworc3RhdGljIGludCBkd19taXBpX2RzaV9ob3N0X2F0dGFjaChzdHJ1Y3QgbWlwaV9kc2lfaG9z
dCAqaG9zdCwKKwkJCQkgICBzdHJ1Y3QgbWlwaV9kc2lfZGV2aWNlICpkZXZpY2UpCit7CisJc3Ry
dWN0IGR3X21pcGlfZHNpICpkc2kgPSBob3N0X3RvX2RzaShob3N0KTsKKworCWlmIChkZXZpY2Ut
PmxhbmVzID4gZHNpLT5tYXhfZGF0YV9sYW5lcykgeworCQlkZXZfZXJyKGRldmljZS0+ZGV2LAor
CQkJInRoZSBudW1iZXIgb2YgZGF0YSBsYW5lcygldSkgaXMgdG9vIG1hbnlcbiIsCisJCQlkZXZp
Y2UtPmxhbmVzKTsKKwkJcmV0dXJuIC1FSU5WQUw7CisJfQorCisJZHNpLT5jaGFubmVsID0gZGV2
aWNlLT5jaGFubmVsOworCisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyB2b2lkIGR3X21pcGlfbWVz
c2FnZV9jb25maWcoc3RydWN0IGR3X21pcGlfZHNpICpkc2ksCisJCQkJICAgY29uc3Qgc3RydWN0
IG1pcGlfZHNpX21zZyAqbXNnKQoreworCWJvb2wgbHBtID0gbXNnLT5mbGFncyAmIE1JUElfRFNJ
X01TR19VU0VfTFBNOworCXUzMiB2YWwgPSAwOworCisJaWYgKG1zZy0+ZmxhZ3MgJiBNSVBJX0RT
SV9NU0dfUkVRX0FDSykKKwkJdmFsIHw9IEFDS19SUVNUX0VOOworCWlmIChscG0pCisJCXZhbCB8
PSBDTURfTU9ERV9BTExfTFA7CisKKwlkc2lfd3JpdGUoZHNpLCBEU0lfTFBDTEtfQ1RSTCwgbHBt
ID8gMCA6IFBIWV9UWFJFUVVFU1RDTEtIUyk7CisJZHNpX3dyaXRlKGRzaSwgRFNJX0NNRF9NT0RF
X0NGRywgdmFsKTsKK30KKworc3RhdGljIGludCBkd19taXBpX2RzaV9nZW5fcGt0X2hkcl93cml0
ZShzdHJ1Y3QgZHdfbWlwaV9kc2kgKmRzaSwgdTMyIGhkcl92YWwpCit7CisJaW50IHJldDsKKwl1
MzIgdmFsLCBtYXNrOworCisJcmV0ID0gcmVhZGxfcG9sbF90aW1lb3V0KGRzaS0+YmFzZSArIERT
SV9DTURfUEtUX1NUQVRVUywKKwkJCQkgdmFsLCAhKHZhbCAmIEdFTl9DTURfRlVMTCksCisJCQkJ
IENNRF9QS1RfU1RBVFVTX1RJTUVPVVRfVVMpOworCWlmIChyZXQpIHsKKwkJZGV2X2Vycihkc2kt
PmRldiwgImZhaWxlZCB0byBnZXQgYXZhaWxhYmxlIGNvbW1hbmQgRklGT1xuIik7CisJCXJldHVy
biByZXQ7CisJfQorCisJZHNpX3dyaXRlKGRzaSwgRFNJX0dFTl9IRFIsIGhkcl92YWwpOworCisJ
bWFzayA9IEdFTl9DTURfRU1QVFkgfCBHRU5fUExEX1dfRU1QVFk7CisJcmV0ID0gcmVhZGxfcG9s
bF90aW1lb3V0KGRzaS0+YmFzZSArIERTSV9DTURfUEtUX1NUQVRVUywKKwkJCQkgdmFsLCAodmFs
ICYgbWFzaykgPT0gbWFzaywKKwkJCQkgQ01EX1BLVF9TVEFUVVNfVElNRU9VVF9VUyk7CisJaWYg
KHJldCkgeworCQlkZXZfZXJyKGRzaS0+ZGV2LCAiZmFpbGVkIHRvIHdyaXRlIGNvbW1hbmQgRklG
T1xuIik7CisJCXJldHVybiByZXQ7CisJfQorCisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyBpbnQg
ZHdfbWlwaV9kc2lfd3JpdGUoc3RydWN0IGR3X21pcGlfZHNpICpkc2ksCisJCQkgICAgIGNvbnN0
IHN0cnVjdCBtaXBpX2RzaV9wYWNrZXQgKnBhY2tldCkKK3sKKwljb25zdCB1OCAqdHhfYnVmID0g
cGFja2V0LT5wYXlsb2FkOworCWludCBsZW4gPSBwYWNrZXQtPnBheWxvYWRfbGVuZ3RoLCBwbGRf
ZGF0YV9ieXRlcyA9IHNpemVvZih1MzIpLCByZXQ7CisJX19sZTMyIHdvcmQ7CisJdTMyIHZhbDsK
KworCXdoaWxlIChsZW4pIHsKKwkJaWYgKGxlbiA8IHBsZF9kYXRhX2J5dGVzKSB7CisJCQl3b3Jk
ID0gMDsKKwkJCW1lbWNweSgmd29yZCwgdHhfYnVmLCBsZW4pOworCQkJZHNpX3dyaXRlKGRzaSwg
RFNJX0dFTl9QTERfREFUQSwgbGUzMl90b19jcHUod29yZCkpOworCQkJbGVuID0gMDsKKwkJfSBl
bHNlIHsKKwkJCW1lbWNweSgmd29yZCwgdHhfYnVmLCBwbGRfZGF0YV9ieXRlcyk7CisJCQlkc2lf
d3JpdGUoZHNpLCBEU0lfR0VOX1BMRF9EQVRBLCBsZTMyX3RvX2NwdSh3b3JkKSk7CisJCQl0eF9i
dWYgKz0gcGxkX2RhdGFfYnl0ZXM7CisJCQlsZW4gLT0gcGxkX2RhdGFfYnl0ZXM7CisJCX0KKwor
CQlyZXQgPSByZWFkbF9wb2xsX3RpbWVvdXQoZHNpLT5iYXNlICsgRFNJX0NNRF9QS1RfU1RBVFVT
LAorCQkJCQkgdmFsLCAhKHZhbCAmIEdFTl9QTERfV19GVUxMKSwKKwkJCQkJIENNRF9QS1RfU1RB
VFVTX1RJTUVPVVRfVVMpOworCQlpZiAocmV0KSB7CisJCQlkZXZfZXJyKGRzaS0+ZGV2LAorCQkJ
CSJmYWlsZWQgdG8gZ2V0IGF2YWlsYWJsZSB3cml0ZSBwYXlsb2FkIEZJRk9cbiIpOworCQkJcmV0
dXJuIHJldDsKKwkJfQorCX0KKworCXdvcmQgPSAwOworCW1lbWNweSgmd29yZCwgcGFja2V0LT5o
ZWFkZXIsIHNpemVvZihwYWNrZXQtPmhlYWRlcikpOworCXJldHVybiBkd19taXBpX2RzaV9nZW5f
cGt0X2hkcl93cml0ZShkc2ksIGxlMzJfdG9fY3B1KHdvcmQpKTsKK30KKworc3RhdGljIGludCBk
d19taXBpX2RzaV9yZWFkKHN0cnVjdCBkd19taXBpX2RzaSAqZHNpLAorCQkJICAgIGNvbnN0IHN0
cnVjdCBtaXBpX2RzaV9tc2cgKm1zZykKK3sKKwlpbnQgaSwgaiwgcmV0LCBsZW4gPSBtc2ctPnJ4
X2xlbjsKKwl1OCAqYnVmID0gbXNnLT5yeF9idWY7CisJdTMyIHZhbDsKKworCS8qIFdhaXQgZW5k
IG9mIHRoZSByZWFkIG9wZXJhdGlvbiAqLworCXJldCA9IHJlYWRsX3BvbGxfdGltZW91dChkc2kt
PmJhc2UgKyBEU0lfQ01EX1BLVF9TVEFUVVMsCisJCQkJIHZhbCwgISh2YWwgJiBHRU5fUkRfQ01E
X0JVU1kpLAorCQkJCSBDTURfUEtUX1NUQVRVU19USU1FT1VUX1VTKTsKKwlpZiAocmV0KSB7CisJ
CWRldl9lcnIoZHNpLT5kZXYsICJUaW1lb3V0IGR1cmluZyByZWFkIG9wZXJhdGlvblxuIik7CisJ
CXJldHVybiByZXQ7CisJfQorCisJZm9yIChpID0gMDsgaSA8IGxlbjsgaSArPSA0KSB7CisJCS8q
IFJlYWQgZmlmbyBtdXN0IG5vdCBiZSBlbXB0eSBiZWZvcmUgYWxsIGJ5dGVzIGFyZSByZWFkICov
CisJCXJldCA9IHJlYWRsX3BvbGxfdGltZW91dChkc2ktPmJhc2UgKyBEU0lfQ01EX1BLVF9TVEFU
VVMsCisJCQkJCSB2YWwsICEodmFsICYgR0VOX1BMRF9SX0VNUFRZKSwKKwkJCQkJIENNRF9QS1Rf
U1RBVFVTX1RJTUVPVVRfVVMpOworCQlpZiAocmV0KSB7CisJCQlkZXZfZXJyKGRzaS0+ZGV2LCAi
UmVhZCBwYXlsb2FkIEZJRk8gaXMgZW1wdHlcbiIpOworCQkJcmV0dXJuIHJldDsKKwkJfQorCisJ
CXZhbCA9IGRzaV9yZWFkKGRzaSwgRFNJX0dFTl9QTERfREFUQSk7CisJCWZvciAoaiA9IDA7IGog
PCA0ICYmIGogKyBpIDwgbGVuOyBqKyspCisJCQlidWZbaSArIGpdID0gdmFsID4+ICg4ICogaik7
CisJfQorCisJcmV0dXJuIHJldDsKK30KKworc3RhdGljIHNzaXplX3QgZHdfbWlwaV9kc2lfaG9z
dF90cmFuc2ZlcihzdHJ1Y3QgbWlwaV9kc2lfaG9zdCAqaG9zdCwKKwkJCQkJIGNvbnN0IHN0cnVj
dCBtaXBpX2RzaV9tc2cgKm1zZykKK3sKKwlzdHJ1Y3QgZHdfbWlwaV9kc2kgKmRzaSA9IGhvc3Rf
dG9fZHNpKGhvc3QpOworCXN0cnVjdCBtaXBpX2RzaV9wYWNrZXQgcGFja2V0OworCWludCByZXQs
IG5iX2J5dGVzOworCisJcmV0ID0gbWlwaV9kc2lfY3JlYXRlX3BhY2tldCgmcGFja2V0LCBtc2cp
OworCWlmIChyZXQpIHsKKwkJZGV2X2Vycihkc2ktPmRldiwgImZhaWxlZCB0byBjcmVhdGUgcGFj
a2V0OiAlZFxuIiwgcmV0KTsKKwkJcmV0dXJuIHJldDsKKwl9CisKKwlkd19taXBpX21lc3NhZ2Vf
Y29uZmlnKGRzaSwgbXNnKTsKKworCXJldCA9IGR3X21pcGlfZHNpX3dyaXRlKGRzaSwgJnBhY2tl
dCk7CisJaWYgKHJldCkKKwkJcmV0dXJuIHJldDsKKworCWlmIChtc2ctPnJ4X2J1ZiAmJiBtc2ct
PnJ4X2xlbikgeworCQlyZXQgPSBkd19taXBpX2RzaV9yZWFkKGRzaSwgbXNnKTsKKwkJaWYgKHJl
dCkKKwkJCXJldHVybiByZXQ7CisJCW5iX2J5dGVzID0gbXNnLT5yeF9sZW47CisJfSBlbHNlIHsK
KwkJbmJfYnl0ZXMgPSBwYWNrZXQuc2l6ZTsKKwl9CisKKwlyZXR1cm4gbmJfYnl0ZXM7Cit9CisK
K3N0YXRpYyBjb25zdCBzdHJ1Y3QgbWlwaV9kc2lfaG9zdF9vcHMgZHdfbWlwaV9kc2lfaG9zdF9v
cHMgPSB7CisJLmF0dGFjaCA9IGR3X21pcGlfZHNpX2hvc3RfYXR0YWNoLAorCS50cmFuc2ZlciA9
IGR3X21pcGlfZHNpX2hvc3RfdHJhbnNmZXIsCit9OworCitzdGF0aWMgdm9pZCBkd19taXBpX2Rz
aV92aWRlb19tb2RlX2NvbmZpZyhzdHJ1Y3QgZHdfbWlwaV9kc2kgKmRzaSkKK3sKKwlzdHJ1Y3Qg
bWlwaV9kc2lfZGV2aWNlICpkZXZpY2UgPSBkc2ktPmRldmljZTsKKwl1MzIgdmFsOworCisJLyoK
KwkgKiBUT0RPIGR3IGRydiBpbXByb3ZlbWVudHMKKwkgKiBlbmFibGluZyBsb3cgcG93ZXIgaXMg
cGFuZWwtZGVwZW5kZW50LCB3ZSBzaG91bGQgdXNlIHRoZQorCSAqIHBhbmVsIGNvbmZpZ3VyYXRp
b24gaGVyZS4uLgorCSAqLworCXZhbCA9IEVOQUJMRV9MT1dfUE9XRVI7CisKKwlpZiAoZGV2aWNl
LT5tb2RlX2ZsYWdzICYgTUlQSV9EU0lfTU9ERV9WSURFT19CVVJTVCkKKwkJdmFsIHw9IFZJRF9N
T0RFX1RZUEVfQlVSU1Q7CisJZWxzZSBpZiAoZGV2aWNlLT5tb2RlX2ZsYWdzICYgTUlQSV9EU0lf
TU9ERV9WSURFT19TWU5DX1BVTFNFKQorCQl2YWwgfD0gVklEX01PREVfVFlQRV9OT05fQlVSU1Rf
U1lOQ19QVUxTRVM7CisJZWxzZQorCQl2YWwgfD0gVklEX01PREVfVFlQRV9OT05fQlVSU1RfU1lO
Q19FVkVOVFM7CisKKwlkc2lfd3JpdGUoZHNpLCBEU0lfVklEX01PREVfQ0ZHLCB2YWwpOworfQor
CitzdGF0aWMgdm9pZCBkd19taXBpX2RzaV9zZXRfbW9kZShzdHJ1Y3QgZHdfbWlwaV9kc2kgKmRz
aSwKKwkJCQkgdW5zaWduZWQgbG9uZyBtb2RlX2ZsYWdzKQoreworCWNvbnN0IHN0cnVjdCBtaXBp
X2RzaV9waHlfb3BzICpwaHlfb3BzID0gZHNpLT5waHlfb3BzOworCisJZHNpX3dyaXRlKGRzaSwg
RFNJX1BXUl9VUCwgUkVTRVQpOworCisJaWYgKG1vZGVfZmxhZ3MgJiBNSVBJX0RTSV9NT0RFX1ZJ
REVPKSB7CisJCWRzaV93cml0ZShkc2ksIERTSV9NT0RFX0NGRywgRU5BQkxFX1ZJREVPX01PREUp
OworCQlkd19taXBpX2RzaV92aWRlb19tb2RlX2NvbmZpZyhkc2kpOworCQlkc2lfd3JpdGUoZHNp
LCBEU0lfTFBDTEtfQ1RSTCwgUEhZX1RYUkVRVUVTVENMS0hTKTsKKwl9IGVsc2UgeworCQlkc2lf
d3JpdGUoZHNpLCBEU0lfTU9ERV9DRkcsIEVOQUJMRV9DTURfTU9ERSk7CisJfQorCisJaWYgKHBo
eV9vcHMtPnBvc3Rfc2V0X21vZGUpCisJCXBoeV9vcHMtPnBvc3Rfc2V0X21vZGUoZHNpLT5kZXZp
Y2UsIG1vZGVfZmxhZ3MpOworCisJZHNpX3dyaXRlKGRzaSwgRFNJX1BXUl9VUCwgUE9XRVJVUCk7
Cit9CisKK3N0YXRpYyB2b2lkIGR3X21pcGlfZHNpX2luaXRfcGxsKHN0cnVjdCBkd19taXBpX2Rz
aSAqZHNpKQoreworCS8qCisJICogVGhlIG1heGltdW0gcGVybWl0dGVkIGVzY2FwZSBjbG9jayBp
cyAyME1IeiBhbmQgaXQgaXMgZGVyaXZlZCBmcm9tCisJICogbGFuZWJ5dGVjbGssIHdoaWNoIGlz
IHJ1bm5pbmcgYXQgImxhbmVfbWJwcyAvIDgiLiAgVGh1cyB3ZSB3YW50OgorCSAqCisJICogICAg
IChsYW5lX21icHMgPj4gMykgLyBlc2NfY2xrX2RpdmlzaW9uIDwgMjAKKwkgKiB3aGljaCBpczoK
KwkgKiAgICAgKGxhbmVfbWJwcyA+PiAzKSAvIDIwID4gZXNjX2Nsa19kaXZpc2lvbgorCSAqLwor
CXUzMiBlc2NfY2xrX2RpdmlzaW9uID0gKGRzaS0+bGFuZV9tYnBzID4+IDMpIC8gMjAgKyAxOwor
CisJZHNpX3dyaXRlKGRzaSwgRFNJX1BXUl9VUCwgUkVTRVQpOworCisJLyoKKwkgKiBUT0RPIGR3
IGRydiBpbXByb3ZlbWVudHMKKwkgKiB0aW1lb3V0IGNsb2NrIGRpdmlzaW9uIHNob3VsZCBiZSBj
b21wdXRlZCB3aXRoIHRoZQorCSAqIGhpZ2ggc3BlZWQgdHJhbnNtaXNzaW9uIGNvdW50ZXIgdGlt
ZW91dCBhbmQgYnl0ZSBsYW5lLi4uCisJICovCisJZHNpX3dyaXRlKGRzaSwgRFNJX0NMS01HUl9D
RkcsIFRPX0NMS19ESVZJU0lPTigxMCkgfAorCQkgIFRYX0VTQ19DTEtfRElWSVNJT04oZXNjX2Ns
a19kaXZpc2lvbikpOworfQorCitzdGF0aWMgdm9pZCBkd19taXBpX2RzaV9kcGlfY29uZmlnKHN0
cnVjdCBkd19taXBpX2RzaSAqZHNpLAorCQkJCSAgIHN0cnVjdCBkaXNwbGF5X3RpbWluZyAqdGlt
aW5ncykKK3sKKwlzdHJ1Y3QgbWlwaV9kc2lfZGV2aWNlICpkZXZpY2UgPSBkc2ktPmRldmljZTsK
Kwl1MzIgdmFsID0gMCwgY29sb3IgPSAwOworCisJc3dpdGNoIChkZXZpY2UtPmZvcm1hdCkgewor
CWNhc2UgTUlQSV9EU0lfRk1UX1JHQjg4ODoKKwkJY29sb3IgPSBEUElfQ09MT1JfQ09ESU5HXzI0
QklUOworCQlicmVhazsKKwljYXNlIE1JUElfRFNJX0ZNVF9SR0I2NjY6CisJCWNvbG9yID0gRFBJ
X0NPTE9SX0NPRElOR18xOEJJVF8yIHwgTE9PU0VMWTE4X0VOOworCQlicmVhazsKKwljYXNlIE1J
UElfRFNJX0ZNVF9SR0I2NjZfUEFDS0VEOgorCQljb2xvciA9IERQSV9DT0xPUl9DT0RJTkdfMThC
SVRfMTsKKwkJYnJlYWs7CisJY2FzZSBNSVBJX0RTSV9GTVRfUkdCNTY1OgorCQljb2xvciA9IERQ
SV9DT0xPUl9DT0RJTkdfMTZCSVRfMTsKKwkJYnJlYWs7CisJfQorCisJaWYgKGRldmljZS0+bW9k
ZV9mbGFncyAmIERJU1BMQVlfRkxBR1NfVlNZTkNfSElHSCkKKwkJdmFsIHw9IFZTWU5DX0FDVElW
RV9MT1c7CisJaWYgKGRldmljZS0+bW9kZV9mbGFncyAmIERJU1BMQVlfRkxBR1NfSFNZTkNfSElH
SCkKKwkJdmFsIHw9IEhTWU5DX0FDVElWRV9MT1c7CisKKwlkc2lfd3JpdGUoZHNpLCBEU0lfRFBJ
X1ZDSUQsIERQSV9WQ0lEKGRzaS0+Y2hhbm5lbCkpOworCWRzaV93cml0ZShkc2ksIERTSV9EUElf
Q09MT1JfQ09ESU5HLCBjb2xvcik7CisJZHNpX3dyaXRlKGRzaSwgRFNJX0RQSV9DRkdfUE9MLCB2
YWwpOworCS8qCisJICogVE9ETyBkdyBkcnYgaW1wcm92ZW1lbnRzCisJICogbGFyZ2VzdCBwYWNr
ZXQgc2l6ZXMgZHVyaW5nIGhmcCBvciBkdXJpbmcgdnNhL3ZwYi92ZnAKKwkgKiBzaG91bGQgYmUg
Y29tcHV0ZWQgYWNjb3JkaW5nIHRvIGJ5dGUgbGFuZSwgbGFuZSBudW1iZXIgYW5kIG9ubHkKKwkg
KiBpZiBzZW5kaW5nIGxwIGNtZHMgaW4gaGlnaCBzcGVlZCBpcyBlbmFibGUgKFBIWV9UWFJFUVVF
U1RDTEtIUykKKwkgKi8KKwlkc2lfd3JpdGUoZHNpLCBEU0lfRFBJX0xQX0NNRF9USU0sIE9VVFZB
Q1RfTFBDTURfVElNRSg0KQorCQkgIHwgSU5WQUNUX0xQQ01EX1RJTUUoNCkpOworfQorCitzdGF0
aWMgdm9pZCBkd19taXBpX2RzaV9wYWNrZXRfaGFuZGxlcl9jb25maWcoc3RydWN0IGR3X21pcGlf
ZHNpICpkc2kpCit7CisJZHNpX3dyaXRlKGRzaSwgRFNJX1BDS0hETF9DRkcsIENSQ19SWF9FTiB8
IEVDQ19SWF9FTiB8IEJUQV9FTik7Cit9CisKK3N0YXRpYyB2b2lkIGR3X21pcGlfZHNpX3ZpZGVv
X3BhY2tldF9jb25maWcoc3RydWN0IGR3X21pcGlfZHNpICpkc2ksCisJCQkJCSAgICBzdHJ1Y3Qg
ZGlzcGxheV90aW1pbmcgKnRpbWluZ3MpCit7CisJLyoKKwkgKiBUT0RPIGR3IGRydiBpbXByb3Zl
bWVudHMKKwkgKiBvbmx5IGJ1cnN0IG1vZGUgaXMgc3VwcG9ydGVkIGhlcmUuIEZvciBub24tYnVy
c3QgdmlkZW8gbW9kZXMsCisJICogd2Ugc2hvdWxkIGNvbXB1dGUgRFNJX1ZJRF9QS1RfU0laRSwg
RFNJX1ZDQ1IuTlVNQyAmCisJICogRFNJX1ZOUENSLk5QU0laRS4uLiBlc3BlY2lhbGx5IGJlY2F1
c2UgdGhpcyBkcml2ZXIgc3VwcG9ydHMKKwkgKiBub24tYnVyc3QgdmlkZW8gbW9kZXMsIHNlZSBk
d19taXBpX2RzaV92aWRlb19tb2RlX2NvbmZpZygpLi4uCisJICovCisJZHNpX3dyaXRlKGRzaSwg
RFNJX1ZJRF9QS1RfU0laRSwgVklEX1BLVF9TSVpFKHRpbWluZ3MtPmhhY3RpdmUudHlwKSk7Cit9
CisKK3N0YXRpYyB2b2lkIGR3X21pcGlfZHNpX2NvbW1hbmRfbW9kZV9jb25maWcoc3RydWN0IGR3
X21pcGlfZHNpICpkc2kpCit7CisJY29uc3Qgc3RydWN0IG1pcGlfZHNpX3BoeV9vcHMgKnBoeV9v
cHMgPSBkc2ktPnBoeV9vcHM7CisKKwkvKgorCSAqIFRPRE8gZHcgZHJ2IGltcHJvdmVtZW50cwor
CSAqIGNvbXB1dGUgaGlnaCBzcGVlZCB0cmFuc21pc3Npb24gY291bnRlciB0aW1lb3V0IGFjY29y
ZGluZworCSAqIHRvIHRoZSB0aW1lb3V0IGNsb2NrIGRpdmlzaW9uIChUT19DTEtfRElWSVNJT04p
IGFuZCBieXRlIGxhbmUuLi4KKwkgKi8KKwlkc2lfd3JpdGUoZHNpLCBEU0lfVE9fQ05UX0NGRywg
SFNUWF9UT19DTlQoMTAwMCkgfCBMUFJYX1RPX0NOVCgxMDAwKSk7CisJLyoKKwkgKiBUT0RPIGR3
IGRydiBpbXByb3ZlbWVudHMKKwkgKiB0aGUgQnVzLVR1cm4tQXJvdW5kIFRpbWVvdXQgQ291bnRl
ciBzaG91bGQgYmUgY29tcHV0ZWQKKwkgKiBhY2NvcmRpbmcgdG8gYnl0ZSBsYW5lLi4uCisJICov
CisJZHNpX3dyaXRlKGRzaSwgRFNJX0JUQV9UT19DTlQsIDB4ZDAwKTsKKwlkc2lfd3JpdGUoZHNp
LCBEU0lfTU9ERV9DRkcsIEVOQUJMRV9DTURfTU9ERSk7CisKKwlpZiAocGh5X29wcy0+cG9zdF9z
ZXRfbW9kZSkKKwkJcGh5X29wcy0+cG9zdF9zZXRfbW9kZShkc2ktPmRldmljZSwgMCk7Cit9CisK
Ky8qIEdldCBsYW5lIGJ5dGUgY2xvY2sgY3ljbGVzLiAqLworc3RhdGljIHUzMiBkd19taXBpX2Rz
aV9nZXRfaGNvbXBvbmVudF9sYmNjKHN0cnVjdCBkd19taXBpX2RzaSAqZHNpLAorCQkJCQkgICBz
dHJ1Y3QgZGlzcGxheV90aW1pbmcgKnRpbWluZ3MsCisJCQkJCSAgIHUzMiBoY29tcG9uZW50KQor
eworCXUzMiBmcmFjLCBsYmNjOworCisJbGJjYyA9IGhjb21wb25lbnQgKiBkc2ktPmxhbmVfbWJw
cyAqIE1TRUNfUEVSX1NFQyAvIDg7CisKKwlmcmFjID0gbGJjYyAlICh0aW1pbmdzLT5waXhlbGNs
b2NrLnR5cCAvIDEwMDApOworCWxiY2MgPSBsYmNjIC8gKHRpbWluZ3MtPnBpeGVsY2xvY2sudHlw
IC8gMTAwMCk7CisJaWYgKGZyYWMpCisJCWxiY2MrKzsKKworCXJldHVybiBsYmNjOworfQorCitz
dGF0aWMgdm9pZCBkd19taXBpX2RzaV9saW5lX3RpbWVyX2NvbmZpZyhzdHJ1Y3QgZHdfbWlwaV9k
c2kgKmRzaSwKKwkJCQkJICBzdHJ1Y3QgZGlzcGxheV90aW1pbmcgKnRpbWluZ3MpCit7CisJdTMy
IGh0b3RhbCwgaHNhLCBoYnAsIGxiY2M7CisKKwlodG90YWwgPSB0aW1pbmdzLT5oYWN0aXZlLnR5
cCArIHRpbWluZ3MtPmhmcm9udF9wb3JjaC50eXAgKworCQkgdGltaW5ncy0+aGJhY2tfcG9yY2gu
dHlwICsgdGltaW5ncy0+aHN5bmNfbGVuLnR5cDsKKworCWhzYSA9IHRpbWluZ3MtPmhiYWNrX3Bv
cmNoLnR5cDsKKwloYnAgPSB0aW1pbmdzLT5oc3luY19sZW4udHlwOworCisJLyoKKwkgKiBUT0RP
IGR3IGRydiBpbXByb3ZlbWVudHMKKwkgKiBjb21wdXRhdGlvbnMgYmVsb3cgbWF5IGJlIGltcHJv
dmVkLi4uCisJICovCisJbGJjYyA9IGR3X21pcGlfZHNpX2dldF9oY29tcG9uZW50X2xiY2MoZHNp
LCB0aW1pbmdzLCBodG90YWwpOworCWRzaV93cml0ZShkc2ksIERTSV9WSURfSExJTkVfVElNRSwg
bGJjYyk7CisKKwlsYmNjID0gZHdfbWlwaV9kc2lfZ2V0X2hjb21wb25lbnRfbGJjYyhkc2ksIHRp
bWluZ3MsIGhzYSk7CisJZHNpX3dyaXRlKGRzaSwgRFNJX1ZJRF9IU0FfVElNRSwgbGJjYyk7CisK
KwlsYmNjID0gZHdfbWlwaV9kc2lfZ2V0X2hjb21wb25lbnRfbGJjYyhkc2ksIHRpbWluZ3MsIGhi
cCk7CisJZHNpX3dyaXRlKGRzaSwgRFNJX1ZJRF9IQlBfVElNRSwgbGJjYyk7Cit9CisKK3N0YXRp
YyB2b2lkIGR3X21pcGlfZHNpX3ZlcnRpY2FsX3RpbWluZ19jb25maWcoc3RydWN0IGR3X21pcGlf
ZHNpICpkc2ksCisJCQkJCSAgICAgICBzdHJ1Y3QgZGlzcGxheV90aW1pbmcgKnRpbWluZ3MpCit7
CisJdTMyIHZhY3RpdmUsIHZzYSwgdmZwLCB2YnA7CisKKwl2YWN0aXZlID0gdGltaW5ncy0+dmFj
dGl2ZS50eXA7CisJdnNhID0gIHRpbWluZ3MtPnZiYWNrX3BvcmNoLnR5cDsKKwl2ZnAgPSAgdGlt
aW5ncy0+dmZyb250X3BvcmNoLnR5cDsKKwl2YnAgPSB0aW1pbmdzLT52c3luY19sZW4udHlwOwor
CisJZHNpX3dyaXRlKGRzaSwgRFNJX1ZJRF9WQUNUSVZFX0xJTkVTLCB2YWN0aXZlKTsKKwlkc2lf
d3JpdGUoZHNpLCBEU0lfVklEX1ZTQV9MSU5FUywgdnNhKTsKKwlkc2lfd3JpdGUoZHNpLCBEU0lf
VklEX1ZGUF9MSU5FUywgdmZwKTsKKwlkc2lfd3JpdGUoZHNpLCBEU0lfVklEX1ZCUF9MSU5FUywg
dmJwKTsKK30KKworc3RhdGljIHZvaWQgZHdfbWlwaV9kc2lfZHBoeV90aW1pbmdfY29uZmlnKHN0
cnVjdCBkd19taXBpX2RzaSAqZHNpKQoreworCXUzMiBod192ZXJzaW9uOworCisJLyoKKwkgKiBU
T0RPIGR3IGRydiBpbXByb3ZlbWVudHMKKwkgKiBkYXRhICYgY2xvY2sgbGFuZSB0aW1lcnMgc2hv
dWxkIGJlIGNvbXB1dGVkIGFjY29yZGluZyB0byBwYW5lbAorCSAqIGJsYW5raW5ncyBhbmQgdG8g
dGhlIGF1dG9tYXRpYyBjbG9jayBsYW5lIGNvbnRyb2wgbW9kZS4uLgorCSAqIG5vdGU6IERTSV9Q
SFlfVE1SX0NGRy5NQVhfUkRfVElNRSBzaG91bGQgYmUgaW4gbGluZSB3aXRoCisJICogRFNJX0NN
RF9NT0RFX0NGRy5NQVhfUkRfUEtUX1NJWkVfTFAgKHNlZSBDTURfTU9ERV9BTExfTFApCisJICov
CisKKwlod192ZXJzaW9uID0gZHNpX3JlYWQoZHNpLCBEU0lfVkVSU0lPTikgJiBWRVJTSU9OOwor
CisJaWYgKGh3X3ZlcnNpb24gPj0gSFdWRVJfMTMxKSB7CisJCWRzaV93cml0ZShkc2ksIERTSV9Q
SFlfVE1SX0NGRywgUEhZX0hTMkxQX1RJTUVfVjEzMSgweDQwKSB8CisJCQkgIFBIWV9MUDJIU19U
SU1FX1YxMzEoMHg0MCkpOworCQlkc2lfd3JpdGUoZHNpLCBEU0lfUEhZX1RNUl9SRF9DRkcsIE1B
WF9SRF9USU1FX1YxMzEoMTAwMDApKTsKKwl9IGVsc2UgeworCQlkc2lfd3JpdGUoZHNpLCBEU0lf
UEhZX1RNUl9DRkcsIFBIWV9IUzJMUF9USU1FKDB4NDApIHwKKwkJCSAgUEhZX0xQMkhTX1RJTUUo
MHg0MCkgfCBNQVhfUkRfVElNRSgxMDAwMCkpOworCX0KKworCWRzaV93cml0ZShkc2ksIERTSV9Q
SFlfVE1SX0xQQ0xLX0NGRywgUEhZX0NMS0hTMkxQX1RJTUUoMHg0MCkKKwkJICB8IFBIWV9DTEtM
UDJIU19USU1FKDB4NDApKTsKK30KKworc3RhdGljIHZvaWQgZHdfbWlwaV9kc2lfZHBoeV9pbnRl
cmZhY2VfY29uZmlnKHN0cnVjdCBkd19taXBpX2RzaSAqZHNpKQoreworCXN0cnVjdCBtaXBpX2Rz
aV9kZXZpY2UgKmRldmljZSA9IGRzaS0+ZGV2aWNlOworCisJLyoKKwkgKiBUT0RPIGR3IGRydiBp
bXByb3ZlbWVudHMKKwkgKiBzdG9wIHdhaXQgdGltZSBzaG91bGQgYmUgdGhlIG1heGltdW0gYmV0
d2VlbiBob3N0IGRzaQorCSAqIGFuZCBwYW5lbCBzdG9wIHdhaXQgdGltZXMKKwkgKi8KKwlkc2lf
d3JpdGUoZHNpLCBEU0lfUEhZX0lGX0NGRywgUEhZX1NUT1BfV0FJVF9USU1FKDB4MjApIHwKKwkJ
ICBOX0xBTkVTKGRldmljZS0+bGFuZXMpKTsKK30KKworc3RhdGljIHZvaWQgZHdfbWlwaV9kc2lf
ZHBoeV9pbml0KHN0cnVjdCBkd19taXBpX2RzaSAqZHNpKQoreworCS8qIENsZWFyIFBIWSBzdGF0
ZSAqLworCWRzaV93cml0ZShkc2ksIERTSV9QSFlfUlNUWiwgUEhZX0RJU0ZPUkNFUExMIHwgUEhZ
X0RJU0FCTEVDTEsKKwkJICB8IFBIWV9SU1RaIHwgUEhZX1NIVVRET1dOWik7CisJZHNpX3dyaXRl
KGRzaSwgRFNJX1BIWV9UU1RfQ1RSTDAsIFBIWV9VTlRFU1RDTFIpOworCWRzaV93cml0ZShkc2ks
IERTSV9QSFlfVFNUX0NUUkwwLCBQSFlfVEVTVENMUik7CisJZHNpX3dyaXRlKGRzaSwgRFNJX1BI
WV9UU1RfQ1RSTDAsIFBIWV9VTlRFU1RDTFIpOworfQorCitzdGF0aWMgdm9pZCBkd19taXBpX2Rz
aV9kcGh5X2VuYWJsZShzdHJ1Y3QgZHdfbWlwaV9kc2kgKmRzaSkKK3sKKwl1MzIgdmFsOworCWlu
dCByZXQ7CisKKwlkc2lfd3JpdGUoZHNpLCBEU0lfUEhZX1JTVFosIFBIWV9FTkZPUkNFUExMIHwg
UEhZX0VOQUJMRUNMSyB8CisJCSAgUEhZX1VOUlNUWiB8IFBIWV9VTlNIVVRET1dOWik7CisKKwly
ZXQgPSByZWFkbF9wb2xsX3RpbWVvdXQoZHNpLT5iYXNlICsgRFNJX1BIWV9TVEFUVVMsIHZhbCwK
KwkJCQkgdmFsICYgUEhZX0xPQ0ssIFBIWV9TVEFUVVNfVElNRU9VVF9VUyk7CisJaWYgKHJldCkK
KwkJZGV2X3dhcm4oZHNpLT5kZXYsICJmYWlsZWQgdG8gd2FpdCBwaHkgbG9jayBzdGF0ZVxuIik7
CisKKwlyZXQgPSByZWFkbF9wb2xsX3RpbWVvdXQoZHNpLT5iYXNlICsgRFNJX1BIWV9TVEFUVVMs
CisJCQkJIHZhbCwgdmFsICYgUEhZX1NUT1BfU1RBVEVfQ0xLX0xBTkUsCisJCQkJIFBIWV9TVEFU
VVNfVElNRU9VVF9VUyk7CisJaWYgKHJldCkKKwkJZGV2X3dhcm4oZHNpLT5kZXYsICJmYWlsZWQg
dG8gd2FpdCBwaHkgY2xrIGxhbmUgc3RvcCBzdGF0ZVxuIik7Cit9CisKK3N0YXRpYyB2b2lkIGR3
X21pcGlfZHNpX2NsZWFyX2VycihzdHJ1Y3QgZHdfbWlwaV9kc2kgKmRzaSkKK3sKKwlkc2lfcmVh
ZChkc2ksIERTSV9JTlRfU1QwKTsKKwlkc2lfcmVhZChkc2ksIERTSV9JTlRfU1QxKTsKKwlkc2lf
d3JpdGUoZHNpLCBEU0lfSU5UX01TSzAsIDApOworCWRzaV93cml0ZShkc2ksIERTSV9JTlRfTVNL
MSwgMCk7Cit9CisKK3N0YXRpYyB2b2lkIGR3X21pcGlfZHNpX2JyaWRnZV9zZXQoc3RydWN0IGR3
X21pcGlfZHNpICpkc2ksCisJCQkJICAgc3RydWN0IGRpc3BsYXlfdGltaW5nICp0aW1pbmdzKQor
eworCWNvbnN0IHN0cnVjdCBtaXBpX2RzaV9waHlfb3BzICpwaHlfb3BzID0gZHNpLT5waHlfb3Bz
OworCXN0cnVjdCBtaXBpX2RzaV9kZXZpY2UgKmRldmljZSA9IGRzaS0+ZGV2aWNlOworCWludCBy
ZXQ7CisKKwlyZXQgPSBwaHlfb3BzLT5nZXRfbGFuZV9tYnBzKGRzaS0+ZGV2aWNlLCB0aW1pbmdz
LCBkZXZpY2UtPmxhbmVzLAorCQkJCSAgICAgZGV2aWNlLT5mb3JtYXQsICZkc2ktPmxhbmVfbWJw
cyk7CisJaWYgKHJldCkKKwkJZGV2X3dhcm4oZHNpLT5kZXYsICJQaHkgZ2V0X2xhbmVfbWJwcygp
IGZhaWxlZFxuIik7CisKKwlkd19taXBpX2RzaV9pbml0X3BsbChkc2kpOworCWR3X21pcGlfZHNp
X2RwaV9jb25maWcoZHNpLCB0aW1pbmdzKTsKKwlkd19taXBpX2RzaV9wYWNrZXRfaGFuZGxlcl9j
b25maWcoZHNpKTsKKwlkd19taXBpX2RzaV92aWRlb19tb2RlX2NvbmZpZyhkc2kpOworCWR3X21p
cGlfZHNpX3ZpZGVvX3BhY2tldF9jb25maWcoZHNpLCB0aW1pbmdzKTsKKwlkd19taXBpX2RzaV9j
b21tYW5kX21vZGVfY29uZmlnKGRzaSk7CisJZHdfbWlwaV9kc2lfbGluZV90aW1lcl9jb25maWco
ZHNpLCB0aW1pbmdzKTsKKwlkd19taXBpX2RzaV92ZXJ0aWNhbF90aW1pbmdfY29uZmlnKGRzaSwg
dGltaW5ncyk7CisKKwlkd19taXBpX2RzaV9kcGh5X2luaXQoZHNpKTsKKwlkd19taXBpX2RzaV9k
cGh5X3RpbWluZ19jb25maWcoZHNpKTsKKwlkd19taXBpX2RzaV9kcGh5X2ludGVyZmFjZV9jb25m
aWcoZHNpKTsKKworCWR3X21pcGlfZHNpX2NsZWFyX2Vycihkc2kpOworCisJcmV0ID0gcGh5X29w
cy0+aW5pdChkc2ktPmRldmljZSk7CisJaWYgKHJldCkKKwkJZGV2X3dhcm4oZHNpLT5kZXYsICJQ
aHkgaW5pdCgpIGZhaWxlZFxuIik7CisKKwlkd19taXBpX2RzaV9kcGh5X2VuYWJsZShkc2kpOwor
CisJZHdfbWlwaV9kc2lfd2FpdF9mb3JfdHdvX2ZyYW1lcyh0aW1pbmdzKTsKKworCS8qIFN3aXRj
aCB0byBjbWQgbW9kZSBmb3IgcGFuZWwtYnJpZGdlIHByZV9lbmFibGUgJiBwYW5lbCBwcmVwYXJl
ICovCisJZHdfbWlwaV9kc2lfc2V0X21vZGUoZHNpLCAwKTsKK30KKworc3RhdGljIGludCBkd19t
aXBpX2RzaV9pbml0KHN0cnVjdCB1ZGV2aWNlICpkZXYsCisJCQkgICAgc3RydWN0IG1pcGlfZHNp
X2RldmljZSAqZGV2aWNlLAorCQkJICAgIHN0cnVjdCBkaXNwbGF5X3RpbWluZyAqdGltaW5ncywK
KwkJCSAgICB1bnNpZ25lZCBpbnQgbWF4X2RhdGFfbGFuZXMsCisJCQkgICAgY29uc3Qgc3RydWN0
IG1pcGlfZHNpX3BoeV9vcHMgKnBoeV9vcHMpCit7CisJc3RydWN0IGR3X21pcGlfZHNpICpkc2kg
PSBkZXZfZ2V0X3ByaXYoZGV2KTsKKwlzdHJ1Y3QgY2xrIGNsazsKKwlpbnQgcmV0OworCisJaWYg
KCFwaHlfb3BzLT5pbml0IHx8ICFwaHlfb3BzLT5nZXRfbGFuZV9tYnBzKSB7CisJCWRldl9lcnIo
ZGV2aWNlLT5kZXYsICJQaHkgbm90IHByb3Blcmx5IGNvbmZpZ3VyZWRcbiIpOworCQlyZXR1cm4g
LUVOT0RFVjsKKwl9CisKKwlkc2ktPnBoeV9vcHMgPSBwaHlfb3BzOworCWRzaS0+bWF4X2RhdGFf
bGFuZXMgPSBtYXhfZGF0YV9sYW5lczsKKwlkc2ktPmRldmljZSA9IGRldmljZTsKKwlkc2ktPmRz
aV9ob3N0Lm9wcyA9ICZkd19taXBpX2RzaV9ob3N0X29wczsKKwlkZXZpY2UtPmhvc3QgPSAmZHNp
LT5kc2lfaG9zdDsKKworCWRzaS0+YmFzZSA9ICh2b2lkICopZGV2X3JlYWRfYWRkcihkZXZpY2Ut
PmRldik7CisJaWYgKChmZHRfYWRkcl90KWRzaS0+YmFzZSA9PSBGRFRfQUREUl9UX05PTkUpIHsK
KwkJZGV2X2VycihkZXZpY2UtPmRldiwgImRzaSBkdCByZWdpc3RlciBhZGRyZXNzIGVycm9yXG4i
KTsKKwkJcmV0dXJuIC1FSU5WQUw7CisJfQorCisJcmV0ID0gY2xrX2dldF9ieV9uYW1lKGRldmlj
ZS0+ZGV2LCAicHhfY2xrIiwgJmNsayk7CisJaWYgKHJldCkgeworCQlkZXZfZXJyKGRldmljZS0+
ZGV2LCAicGVyaXBoZXJhbCBjbG9jayBnZXQgZXJyb3IgJWRcbiIsIHJldCk7CisJCXJldHVybiBy
ZXQ7CisJfQorCisJLyogIGdldCB0aGUgcGl4ZWwgY2xvY2sgc2V0IGJ5IHRoZSBjbG9jayBmcmFt
ZXdvcmsgKi8KKwl0aW1pbmdzLT5waXhlbGNsb2NrLnR5cCA9IGNsa19nZXRfcmF0ZSgmY2xrKTsK
KworCWR3X21pcGlfZHNpX2JyaWRnZV9zZXQoZHNpLCB0aW1pbmdzKTsKKworCXJldHVybiAwOwor
fQorCitzdGF0aWMgaW50IGR3X21pcGlfZHNpX2VuYWJsZShzdHJ1Y3QgdWRldmljZSAqZGV2KQor
eworCXN0cnVjdCBkd19taXBpX2RzaSAqZHNpID0gZGV2X2dldF9wcml2KGRldik7CisKKwkvKiBT
d2l0Y2ggdG8gdmlkZW8gbW9kZSBmb3IgcGFuZWwtYnJpZGdlIGVuYWJsZSAmIHBhbmVsIGVuYWJs
ZSAqLworCWR3X21pcGlfZHNpX3NldF9tb2RlKGRzaSwgTUlQSV9EU0lfTU9ERV9WSURFTyk7CisK
KwlyZXR1cm4gMDsKK30KKworc3RydWN0IGRzaV9ob3N0X29wcyBkd19taXBpX2RzaV9vcHMgPSB7
CisJLmluaXQgPSBkd19taXBpX2RzaV9pbml0LAorCS5lbmFibGUgPSBkd19taXBpX2RzaV9lbmFi
bGUsCit9OworCitzdGF0aWMgaW50IGR3X21pcGlfZHNpX3Byb2JlKHN0cnVjdCB1ZGV2aWNlICpk
ZXYpCit7CisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyBjb25zdCBzdHJ1Y3QgdWRldmljZV9pZCBk
d19taXBpX2RzaV9pZHNbXSA9IHsKKwl7IC5jb21wYXRpYmxlID0gInN5bm9wc3lzLGR3LW1pcGkt
ZHNpIiB9LAorCXsgfQorfTsKKworVV9CT09UX0RSSVZFUihkd19taXBpX2RzaSkgPSB7CisJLm5h
bWUJCQk9ICJkd19taXBpX2RzaSIsCisJLmlkCQkJPSBVQ0xBU1NfRFNJX0hPU1QsCisJLm9mX21h
dGNoCQk9IGR3X21pcGlfZHNpX2lkcywKKwkucHJvYmUJCQk9IGR3X21pcGlfZHNpX3Byb2JlLAor
CS5vcHMJCQk9ICZkd19taXBpX2RzaV9vcHMsCisJLnByaXZfYXV0b19hbGxvY19zaXplCT0gc2l6
ZW9mKHN0cnVjdCBkd19taXBpX2RzaSksCit9OworCitNT0RVTEVfQVVUSE9SKCJDaHJpcyBaaG9u
ZyA8enl3QHJvY2stY2hpcHMuY29tPiIpOworTU9EVUxFX0FVVEhPUigiUGhpbGlwcGUgQ29ybnUg
PHBoaWxpcHBlLmNvcm51QHN0LmNvbT4iKTsKK01PRFVMRV9BVVRIT1IoIllhbm5pY2sgRmVydHLD
qSA8eWFubmljay5mZXJ0cmVAc3QuY29tPiIpOworTU9EVUxFX0RFU0NSSVBUSU9OKCJEVyBNSVBJ
IERTSSBob3N0IGNvbnRyb2xsZXIgZHJpdmVyIik7CitNT0RVTEVfTElDRU5TRSgiR1BMIik7CitN
T0RVTEVfQUxJQVMoInBsYXRmb3JtOmR3LW1pcGktZHNpIik7Ci0tIAoyLjcuNAoKX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KVWJvb3Qtc3RtMzIgbWFpbGlu
ZyBsaXN0ClVib290LXN0bTMyQHN0LW1kLW1haWxtYW4uc3Rvcm1yZXBseS5jb20KaHR0cHM6Ly9z
dC1tZC1tYWlsbWFuLnN0b3JtcmVwbHkuY29tL21haWxtYW4vbGlzdGluZm8vdWJvb3Qtc3RtMzIK
