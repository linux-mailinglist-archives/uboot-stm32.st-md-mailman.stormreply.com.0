Return-Path: <uboot-stm32-bounces@st-md-mailman.stormreply.com>
X-Original-To: lists+uboot-stm32@lfdr.de
Delivered-To: lists+uboot-stm32@lfdr.de
Received: from stm-ict-prod-mailman-01.stormreply.prv (st-md-mailman.stormreply.com [52.209.6.89])
	by mail.lfdr.de (Postfix) with ESMTPS id 8AFC2CE39F
	for <lists+uboot-stm32@lfdr.de>; Mon,  7 Oct 2019 15:29:39 +0200 (CEST)
Received: from ip-172-31-3-76.eu-west-1.compute.internal (localhost [127.0.0.1])
	by stm-ict-prod-mailman-01.stormreply.prv (Postfix) with ESMTP id 5268DC36B0F
	for <lists+uboot-stm32@lfdr.de>; Mon,  7 Oct 2019 13:29:39 +0000 (UTC)
Received: from mx07-00178001.pphosted.com (mx08-00178001.pphosted.com
 [91.207.212.93])
 (using TLSv1.2 with cipher ECDHE-RSA-AES256-GCM-SHA384 (256/256 bits))
 (No client certificate requested)
 by stm-ict-prod-mailman-01.stormreply.prv (Postfix) with ESMTPS id 0FF8AC36B0A
 for <uboot-stm32@st-md-mailman.stormreply.com>;
 Mon,  7 Oct 2019 13:29:38 +0000 (UTC)
Received: from pps.filterd (m0046661.ppops.net [127.0.0.1])
 by mx08-00178001.pphosted.com (8.16.0.42/8.16.0.42) with SMTP id
 x97DKpKW011728; Mon, 7 Oct 2019 15:29:29 +0200
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=st.com;
 h=from : to : subject :
 date : message-id : in-reply-to : references : mime-version : content-type
 : content-transfer-encoding; s=STMicroelectronics;
 bh=jmIyYEag+bNtzTo/56iRn2ncpbaRYQWwPlRbdvFIcLc=;
 b=v1aES/BLpAqvvMmxZIVjjQwX7V55PcHM9NVXxXzLJlxyuGt7hR/a3LzjGDV9BTt+cYTT
 lBad+pAVtnmwkgbWXRrVUL+UftvGcOYtYKpOYGek8sJUu5QJi2O1pzy46GJccOpPEzxK
 vltwKvjZ7bG4DnLBUgP+kQFV2bZtN+j3t2CTtK7W6epxqVyrMJye1m/129K46dXxAGTM
 jawNTFfdGfpcfc0c7YEwp+GfZ8yrzS7rxvbdhTquk8xooWmpXTOzqe71ZqBPN5puwAFG
 LxyGaampX6XweMtulZLl5znfgJfhNUZ1QBMSPVaN6keRZXwFq18VAfGziOzsY5zDejkH YQ== 
Received: from beta.dmz-eu.st.com (beta.dmz-eu.st.com [164.129.1.35])
 by mx08-00178001.pphosted.com with ESMTP id 2vej2p2jj9-1
 (version=TLSv1.2 cipher=ECDHE-RSA-AES256-GCM-SHA384 bits=256 verify=NOT);
 Mon, 07 Oct 2019 15:29:29 +0200
Received: from euls16034.sgp.st.com (euls16034.sgp.st.com [10.75.44.20])
 by beta.dmz-eu.st.com (STMicroelectronics) with ESMTP id EB5AE10002A;
 Mon,  7 Oct 2019 15:29:28 +0200 (CEST)
Received: from Webmail-eu.st.com (Safex1hubcas21.st.com [10.75.90.44])
 by euls16034.sgp.st.com (STMicroelectronics) with ESMTP id DAB702BFDF5;
 Mon,  7 Oct 2019 15:29:28 +0200 (CEST)
Received: from SAFEX1HUBCAS22.st.com (10.75.90.93) by SAFEX1HUBCAS21.st.com
 (10.75.90.44) with Microsoft SMTP Server (TLS) id 14.3.439.0; Mon, 7 Oct 2019
 15:29:28 +0200
Received: from localhost (10.201.23.97) by Webmail-ga.st.com (10.75.90.48)
 with Microsoft SMTP Server (TLS) id 14.3.439.0; Mon, 7 Oct 2019 15:29:28
 +0200
From: =?UTF-8?q?Yannick=20Fertr=C3=A9?= <yannick.fertre@st.com>
To: Vikas Manocha <vikas.manocha@st.com>, Benjamin Gaignard
 <benjamin.gaignard@st.com>, Albert Aribaud <albert.u.boot@aribaud.net>,
 Patrick Delaunay <patrick.delaunay@st.com>,
 Simon Glass <sjg@chromium.org>, Anatolij Gustschin <agust@denx.de>,
 Patrice Chotard <patrice.chotard@st.com>,
 Yannick Fertre <yannick.fertre@st.com>, Philippe Cornu
 <philippe.cornu@st.com>, Jens Wiklander <jens.wiklander@linaro.org>, "Eugen
 Hristev" <eugen.hristev@microchip.com>, Heinrich Schuchardt
 <xypron.glpk@gmx.de>, Simon Goldschmidt <simon.k.r.goldschmidt@gmail.com>,
 <u-boot@lists.denx.de>, <uboot-stm32@st-md-mailman.stormreply.com>
Date: Mon, 7 Oct 2019 15:29:02 +0200
Message-ID: <1570454955-21298-3-git-send-email-yannick.fertre@st.com>
X-Mailer: git-send-email 2.7.4
In-Reply-To: <1570454955-21298-1-git-send-email-yannick.fertre@st.com>
References: <1570454955-21298-1-git-send-email-yannick.fertre@st.com>
MIME-Version: 1.0
X-Originating-IP: [10.201.23.97]
X-Proofpoint-Virus-Version: vendor=fsecure engine=2.50.10434:6.0.95,1.0.8
 definitions=2019-10-07_02:2019-10-07,2019-10-07 signatures=0
Subject: [Uboot-stm32] [PATCH v5 02/15] video: stm32: stm32_ltdc: add bridge
	to display controller
X-BeenThere: uboot-stm32@st-md-mailman.stormreply.com
X-Mailman-Version: 2.1.15
Precedence: list
List-Id: <uboot-stm32.st-md-mailman.stormreply.com>
List-Unsubscribe: <https://st-md-mailman.stormreply.com/mailman/options/uboot-stm32>, 
 <mailto:uboot-stm32-request@st-md-mailman.stormreply.com?subject=unsubscribe>
List-Archive: <http://st-md-mailman.stormreply.com/pipermail/uboot-stm32/>
List-Post: <mailto:uboot-stm32@st-md-mailman.stormreply.com>
List-Help: <mailto:uboot-stm32-request@st-md-mailman.stormreply.com?subject=help>
List-Subscribe: <https://st-md-mailman.stormreply.com/mailman/listinfo/uboot-stm32>, 
 <mailto:uboot-stm32-request@st-md-mailman.stormreply.com?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: uboot-stm32-bounces@st-md-mailman.stormreply.com
Sender: "Uboot-stm32" <uboot-stm32-bounces@st-md-mailman.stormreply.com>

TWFuYWdlIGEgYnJpZGdlIGluc2VydCBiZXR3ZWVuIHRoZSBkaXNwbGF5IGNvbnRyb2xsZXIgJiBh
IHBhbmVsLgoKU2lnbmVkLW9mZi1ieTogWWFubmljayBGZXJ0csOpIDx5YW5uaWNrLmZlcnRyZUBz
dC5jb20+Ci0tLQogZHJpdmVycy92aWRlby9zdG0zMi9zdG0zMl9sdGRjLmMgfCAxNDMgKysrKysr
KysrKysrKysrKysrKysrKystLS0tLS0tLS0tLS0tLS0tCiAxIGZpbGUgY2hhbmdlZCwgODMgaW5z
ZXJ0aW9ucygrKSwgNjAgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy92aWRlby9z
dG0zMi9zdG0zMl9sdGRjLmMgYi9kcml2ZXJzL3ZpZGVvL3N0bTMyL3N0bTMyX2x0ZGMuYwppbmRl
eCBkYzZjODg5Li41OWZmNjkyIDEwMDY0NAotLS0gYS9kcml2ZXJzL3ZpZGVvL3N0bTMyL3N0bTMy
X2x0ZGMuYworKysgYi9kcml2ZXJzL3ZpZGVvL3N0bTMyL3N0bTMyX2x0ZGMuYwpAQCAtNywxOSAr
NywxOCBAQAogCiAjaW5jbHVkZSA8Y29tbW9uLmg+CiAjaW5jbHVkZSA8Y2xrLmg+CisjaW5jbHVk
ZSA8ZGlzcGxheS5oPgogI2luY2x1ZGUgPGRtLmg+CiAjaW5jbHVkZSA8cGFuZWwuaD4KICNpbmNs
dWRlIDxyZXNldC5oPgogI2luY2x1ZGUgPHZpZGVvLmg+CisjaW5jbHVkZSA8dmlkZW9fYnJpZGdl
Lmg+CiAjaW5jbHVkZSA8YXNtL2lvLmg+CiAjaW5jbHVkZSA8YXNtL2FyY2gvZ3Bpby5oPgogI2lu
Y2x1ZGUgPGRtL2RldmljZS1pbnRlcm5hbC5oPgogCi1ERUNMQVJFX0dMT0JBTF9EQVRBX1BUUjsK
LQogc3RydWN0IHN0bTMyX2x0ZGNfcHJpdiB7CiAJdm9pZCBfX2lvbWVtICpyZWdzOwotCXN0cnVj
dCBkaXNwbGF5X3RpbWluZyB0aW1pbmc7CiAJZW51bSB2aWRlb19sb2cyX2JwcCBsMmJwcDsKIAl1
MzIgYmdfY29sX2FyZ2I7CiAJdTMyIGNyb3BfeCwgY3JvcF95LCBjcm9wX3csIGNyb3BfaDsKQEAg
LTE3NCw4ICsxNzMsOCBAQCBzdGF0aWMgdTMyIHN0bTMyX2x0ZGNfZ2V0X3BpeGVsX2Zvcm1hdChl
bnVtIHZpZGVvX2xvZzJfYnBwIGwyYnBwKQogCWNhc2UgVklERU9fQlBQMjoKIAljYXNlIFZJREVP
X0JQUDQ6CiAJZGVmYXVsdDoKLQkJZGVidWcoIiVzOiB3YXJuaW5nICVkYnBwIG5vdCBzdXBwb3J0
ZWQgeWV0LCAlZGJwcCBpbnN0ZWFkXG4iLAotCQkgICAgICBfX2Z1bmNfXywgVk5CSVRTKGwyYnBw
KSwgVk5CSVRTKFZJREVPX0JQUDE2KSk7CisJCXByX3dhcm4oIiVzOiB3YXJuaW5nICVkYnBwIG5v
dCBzdXBwb3J0ZWQgeWV0LCAlZGJwcCBpbnN0ZWFkXG4iLAorCQkJX19mdW5jX18sIFZOQklUUyhs
MmJwcCksIFZOQklUUyhWSURFT19CUFAxNikpOwogCQlwZiA9IFBGX1JHQjU2NTsKIAkJYnJlYWs7
CiAJfQpAQCAtMjA5LDIzICsyMDgsMjMgQEAgc3RhdGljIHZvaWQgc3RtMzJfbHRkY19lbmFibGUo
c3RydWN0IHN0bTMyX2x0ZGNfcHJpdiAqcHJpdikKIAlzZXRiaXRzX2xlMzIocHJpdi0+cmVncyAr
IExURENfR0NSLCBHQ1JfTFREQ0VOKTsKIH0KIAotc3RhdGljIHZvaWQgc3RtMzJfbHRkY19zZXRf
bW9kZShzdHJ1Y3Qgc3RtMzJfbHRkY19wcml2ICpwcml2KQorc3RhdGljIHZvaWQgc3RtMzJfbHRk
Y19zZXRfbW9kZShzdHJ1Y3Qgc3RtMzJfbHRkY19wcml2ICpwcml2LAorCQkJCXN0cnVjdCBkaXNw
bGF5X3RpbWluZyAqdGltaW5ncykKIHsKIAl2b2lkIF9faW9tZW0gKnJlZ3MgPSBwcml2LT5yZWdz
OwotCXN0cnVjdCBkaXNwbGF5X3RpbWluZyAqdGltaW5nID0gJnByaXYtPnRpbWluZzsKIAl1MzIg
aHN5bmMsIHZzeW5jLCBhY2NfaGJwLCBhY2NfdmJwLCBhY2NfYWN0X3csIGFjY19hY3RfaDsKIAl1
MzIgdG90YWxfdywgdG90YWxfaDsKIAl1MzIgdmFsOwogCiAJLyogQ29udmVydCB2aWRlbyB0aW1p
bmdzIHRvIGx0ZGMgdGltaW5ncyAqLwotCWhzeW5jID0gdGltaW5nLT5oc3luY19sZW4udHlwIC0g
MTsKLQl2c3luYyA9IHRpbWluZy0+dnN5bmNfbGVuLnR5cCAtIDE7Ci0JYWNjX2hicCA9IGhzeW5j
ICsgdGltaW5nLT5oYmFja19wb3JjaC50eXA7Ci0JYWNjX3ZicCA9IHZzeW5jICsgdGltaW5nLT52
YmFja19wb3JjaC50eXA7Ci0JYWNjX2FjdF93ID0gYWNjX2hicCArIHRpbWluZy0+aGFjdGl2ZS50
eXA7Ci0JYWNjX2FjdF9oID0gYWNjX3ZicCArIHRpbWluZy0+dmFjdGl2ZS50eXA7Ci0JdG90YWxf
dyA9IGFjY19hY3RfdyArIHRpbWluZy0+aGZyb250X3BvcmNoLnR5cDsKLQl0b3RhbF9oID0gYWNj
X2FjdF9oICsgdGltaW5nLT52ZnJvbnRfcG9yY2gudHlwOworCWhzeW5jID0gdGltaW5ncy0+aHN5
bmNfbGVuLnR5cCAtIDE7CisJdnN5bmMgPSB0aW1pbmdzLT52c3luY19sZW4udHlwIC0gMTsKKwlh
Y2NfaGJwID0gaHN5bmMgKyB0aW1pbmdzLT5oYmFja19wb3JjaC50eXA7CisJYWNjX3ZicCA9IHZz
eW5jICsgdGltaW5ncy0+dmJhY2tfcG9yY2gudHlwOworCWFjY19hY3RfdyA9IGFjY19oYnAgKyB0
aW1pbmdzLT5oYWN0aXZlLnR5cDsKKwlhY2NfYWN0X2ggPSBhY2NfdmJwICsgdGltaW5ncy0+dmFj
dGl2ZS50eXA7CisJdG90YWxfdyA9IGFjY19hY3RfdyArIHRpbWluZ3MtPmhmcm9udF9wb3JjaC50
eXA7CisJdG90YWxfaCA9IGFjY19hY3RfaCArIHRpbWluZ3MtPnZmcm9udF9wb3JjaC50eXA7CiAK
IAkvKiBTeW5jaHJvbml6YXRpb24gc2l6ZXMgKi8KIAl2YWwgPSAoaHN5bmMgPDwgMTYpIHwgdnN5
bmM7CkBAIC0yNDcsMTQgKzI0NiwxNCBAQCBzdGF0aWMgdm9pZCBzdG0zMl9sdGRjX3NldF9tb2Rl
KHN0cnVjdCBzdG0zMl9sdGRjX3ByaXYgKnByaXYpCiAKIAkvKiBTaWduYWwgcG9sYXJpdGllcyAq
LwogCXZhbCA9IDA7Ci0JZGVidWcoIiVzOiB0aW1pbmctPmZsYWdzIDB4JTA4eFxuIiwgX19mdW5j
X18sIHRpbWluZy0+ZmxhZ3MpOwotCWlmICh0aW1pbmctPmZsYWdzICYgRElTUExBWV9GTEFHU19I
U1lOQ19ISUdIKQorCWRlYnVnKCIlczogdGltaW5nLT5mbGFncyAweCUwOHhcbiIsIF9fZnVuY19f
LCB0aW1pbmdzLT5mbGFncyk7CisJaWYgKHRpbWluZ3MtPmZsYWdzICYgRElTUExBWV9GTEFHU19I
U1lOQ19ISUdIKQogCQl2YWwgfD0gR0NSX0hTUE9MOwotCWlmICh0aW1pbmctPmZsYWdzICYgRElT
UExBWV9GTEFHU19WU1lOQ19ISUdIKQorCWlmICh0aW1pbmdzLT5mbGFncyAmIERJU1BMQVlfRkxB
R1NfVlNZTkNfSElHSCkKIAkJdmFsIHw9IEdDUl9WU1BPTDsKLQlpZiAodGltaW5nLT5mbGFncyAm
IERJU1BMQVlfRkxBR1NfREVfSElHSCkKKwlpZiAodGltaW5ncy0+ZmxhZ3MgJiBESVNQTEFZX0ZM
QUdTX0RFX0hJR0gpCiAJCXZhbCB8PSBHQ1JfREVQT0w7Ci0JaWYgKHRpbWluZy0+ZmxhZ3MgJiBE
SVNQTEFZX0ZMQUdTX1BJWERBVEFfTkVHRURHRSkKKwlpZiAodGltaW5ncy0+ZmxhZ3MgJiBESVNQ
TEFZX0ZMQUdTX1BJWERBVEFfTkVHRURHRSkKIAkJdmFsIHw9IEdDUl9QQ1BPTDsKIAljbHJzZXRi
aXRzX2xlMzIocmVncyArIExURENfR0NSLAogCQkJR0NSX0hTUE9MIHwgR0NSX1ZTUE9MIHwgR0NS
X0RFUE9MIHwgR0NSX1BDUE9MLCB2YWwpOwpAQCAtMzMwLDk2ICszMjksMTIwIEBAIHN0YXRpYyBp
bnQgc3RtMzJfbHRkY19wcm9iZShzdHJ1Y3QgdWRldmljZSAqZGV2KQogCXN0cnVjdCB2aWRlb191
Y19wbGF0ZGF0YSAqdWNfcGxhdCA9IGRldl9nZXRfdWNsYXNzX3BsYXRkYXRhKGRldik7CiAJc3Ry
dWN0IHZpZGVvX3ByaXYgKnVjX3ByaXYgPSBkZXZfZ2V0X3VjbGFzc19wcml2KGRldik7CiAJc3Ry
dWN0IHN0bTMyX2x0ZGNfcHJpdiAqcHJpdiA9IGRldl9nZXRfcHJpdihkZXYpOwotCXN0cnVjdCB1
ZGV2aWNlICpwYW5lbDsKKwlzdHJ1Y3QgdWRldmljZSAqYnJpZGdlID0gTlVMTDsKKwlzdHJ1Y3Qg
dWRldmljZSAqcGFuZWwgPSBOVUxMOworCXN0cnVjdCBkaXNwbGF5X3RpbWluZyB0aW1pbmdzOwog
CXN0cnVjdCBjbGsgcGNsazsKIAlzdHJ1Y3QgcmVzZXRfY3RsIHJzdDsKLQlpbnQgcmF0ZSwgcmV0
OworCWludCByZXQ7CiAKIAlwcml2LT5yZWdzID0gKHZvaWQgKilkZXZfcmVhZF9hZGRyKGRldik7
CiAJaWYgKChmZHRfYWRkcl90KXByaXYtPnJlZ3MgPT0gRkRUX0FERFJfVF9OT05FKSB7Ci0JCWRl
YnVnKCIlczogbHRkYyBkdCByZWdpc3RlciBhZGRyZXNzIGVycm9yXG4iLCBfX2Z1bmNfXyk7CisJ
CWRldl9lcnIoZGV2LCAibHRkYyBkdCByZWdpc3RlciBhZGRyZXNzIGVycm9yXG4iKTsKIAkJcmV0
dXJuIC1FSU5WQUw7CiAJfQogCiAJcmV0ID0gY2xrX2dldF9ieV9pbmRleChkZXYsIDAsICZwY2xr
KTsKIAlpZiAocmV0KSB7Ci0JCWRlYnVnKCIlczogcGVyaXBoZXJhbCBjbG9jayBnZXQgZXJyb3Ig
JWRcbiIsIF9fZnVuY19fLCByZXQpOworCQlkZXZfZXJyKGRldiwgInBlcmlwaGVyYWwgY2xvY2sg
Z2V0IGVycm9yICVkXG4iLCByZXQpOwogCQlyZXR1cm4gcmV0OwogCX0KIAogCXJldCA9IGNsa19l
bmFibGUoJnBjbGspOwogCWlmIChyZXQpIHsKLQkJZGVidWcoIiVzOiBwZXJpcGhlcmFsIGNsb2Nr
IGVuYWJsZSBlcnJvciAlZFxuIiwKLQkJICAgICAgX19mdW5jX18sIHJldCk7CisJCWRldl9lcnIo
ZGV2LCAicGVyaXBoZXJhbCBjbG9jayBlbmFibGUgZXJyb3IgJWRcbiIsIHJldCk7CiAJCXJldHVy
biByZXQ7CiAJfQogCi0JcmV0ID0gcmVzZXRfZ2V0X2J5X2luZGV4KGRldiwgMCwgJnJzdCk7CisJ
cmV0ID0gdWNsYXNzX2ZpcnN0X2RldmljZV9lcnIoVUNMQVNTX1BBTkVMLCAmcGFuZWwpOwogCWlm
IChyZXQpIHsKLQkJZGVidWcoIiVzOiBtaXNzaW5nIGx0ZGMgaGFyZHdhcmUgcmVzZXRcbiIsIF9f
ZnVuY19fKTsKLQkJcmV0dXJuIC1FTk9ERVY7CisJCWlmIChyZXQgIT0gLUVOT0RFVikKKwkJCWRl
dl9lcnIoZGV2LCAicGFuZWwgZGV2aWNlIGVycm9yICVkXG4iLCByZXQpOworCQlyZXR1cm4gcmV0
OwogCX0KIAotCS8qIFJlc2V0ICovCi0JcmVzZXRfZGVhc3NlcnQoJnJzdCk7Ci0KLQlyZXQgPSB1
Y2xhc3NfZmlyc3RfZGV2aWNlKFVDTEFTU19QQU5FTCwgJnBhbmVsKTsKKwlyZXQgPSBwYW5lbF9n
ZXRfZGlzcGxheV90aW1pbmcocGFuZWwsICZ0aW1pbmdzKTsKIAlpZiAocmV0KSB7Ci0JCWRlYnVn
KCIlczogcGFuZWwgZGV2aWNlIGVycm9yICVkXG4iLCBfX2Z1bmNfXywgcmV0KTsKLQkJcmV0dXJu
IHJldDsKKwkJcmV0ID0gZmR0ZGVjX2RlY29kZV9kaXNwbGF5X3RpbWluZyhnZC0+ZmR0X2Jsb2Is
CisJCQkJCQkgICBkZXZfb2Zfb2Zmc2V0KHBhbmVsKSwKKwkJCQkJCSAgIDAsICZ0aW1pbmdzKTsK
KwkJaWYgKHJldCkgeworCQkJZGV2X2VycihkZXYsICJkZWNvZGUgZGlzcGxheSB0aW1pbmcgZXJy
b3IgJWRcbiIsIHJldCk7CisJCQlyZXR1cm4gcmV0OworCQl9CiAJfQogCi0JcmV0ID0gcGFuZWxf
ZW5hYmxlX2JhY2tsaWdodChwYW5lbCk7CisJcmV0ID0gY2xrX3NldF9yYXRlKCZwY2xrLCB0aW1p
bmdzLnBpeGVsY2xvY2sudHlwKTsKKwlpZiAocmV0KQorCQlkZXZfd2FybihkZXYsICJmYWlsIHRv
IHNldCBwaXhlbCBjbG9jayAlZCBoelxuIiwKKwkJCSB0aW1pbmdzLnBpeGVsY2xvY2sudHlwKTsK
KworCWRlYnVnKCIlczogU2V0IHBpeGVsIGNsb2NrIHJlcSAlZCBoeiBnZXQgJWxkIGh6XG4iLCBf
X2Z1bmNfXywKKwkgICAgICB0aW1pbmdzLnBpeGVsY2xvY2sudHlwLCBjbGtfZ2V0X3JhdGUoJnBj
bGspKTsKKworCXJldCA9IHJlc2V0X2dldF9ieV9pbmRleChkZXYsIDAsICZyc3QpOwogCWlmIChy
ZXQpIHsKLQkJZGVidWcoIiVzOiBwYW5lbCAlcyBlbmFibGUgYmFja2xpZ2h0IGVycm9yICVkXG4i
LAotCQkgICAgICBfX2Z1bmNfXywgcGFuZWwtPm5hbWUsIHJldCk7CisJCWRldl9lcnIoZGV2LCAi
bWlzc2luZyBsdGRjIGhhcmR3YXJlIHJlc2V0XG4iKTsKIAkJcmV0dXJuIHJldDsKIAl9CiAKLQly
ZXQgPSBmZHRkZWNfZGVjb2RlX2Rpc3BsYXlfdGltaW5nKGdkLT5mZHRfYmxvYiwKLQkJCQkJICAg
ZGV2X29mX29mZnNldChkZXYpLCAwLAotCQkJCQkgICAmcHJpdi0+dGltaW5nKTsKLQlpZiAocmV0
KSB7Ci0JCWRlYnVnKCIlczogZGVjb2RlIGRpc3BsYXkgdGltaW5nIGVycm9yICVkXG4iLAotCQkg
ICAgICBfX2Z1bmNfXywgcmV0KTsKLQkJcmV0dXJuIC1FSU5WQUw7Ci0JfQorCS8qIFJlc2V0ICov
CisJcmVzZXRfZGVhc3NlcnQoJnJzdCk7CiAKLQlyYXRlID0gY2xrX3NldF9yYXRlKCZwY2xrLCBw
cml2LT50aW1pbmcucGl4ZWxjbG9jay50eXApOwotCWlmIChyYXRlIDwgMCkgewotCQlkZWJ1Zygi
JXM6IGZhaWwgdG8gc2V0IHBpeGVsIGNsb2NrICVkIGh6ICVkIGh6XG4iLAotCQkgICAgICBfX2Z1
bmNfXywgcHJpdi0+dGltaW5nLnBpeGVsY2xvY2sudHlwLCByYXRlKTsKLQkJcmV0dXJuIHJhdGU7
CisJaWYgKElTX0VOQUJMRUQoQ09ORklHX1ZJREVPX0JSSURHRSkpIHsKKwkJcmV0ID0gdWNsYXNz
X2dldF9kZXZpY2UoVUNMQVNTX1ZJREVPX0JSSURHRSwgMCwgJmJyaWRnZSk7CisJCWlmIChyZXQp
CisJCQlkZWJ1ZygiTm8gdmlkZW8gYnJpZGdlLCBvciBubyBiYWNrbGlnaHQgb24gYnJpZGdlXG4i
KTsKKworCQlpZiAoYnJpZGdlKSB7CisJCQlyZXQgPSB2aWRlb19icmlkZ2VfYXR0YWNoKGJyaWRn
ZSk7CisJCQlpZiAocmV0KSB7CisJCQkJZGV2X2VycihkZXYsICJmYWlsIHRvIGF0dGFjaCBicmlk
Z2VcbiIpOworCQkJCXJldHVybiByZXQ7CisJCQl9CisJCX0KIAl9CiAKLQlkZWJ1ZygiJXM6IFNl
dCBwaXhlbCBjbG9jayByZXEgJWQgaHogZ2V0ICVkIGh6XG4iLCBfX2Z1bmNfXywKLQkgICAgICBw
cml2LT50aW1pbmcucGl4ZWxjbG9jay50eXAsIHJhdGUpOwotCiAJLyogVE9ETyBCZWxvdyBwYXJh
bWV0ZXJzIGFyZSBoYXJkLWNvZGVkIGZvciB0aGUgbW9tZW50Li4uICovCiAJcHJpdi0+bDJicHAg
PSBWSURFT19CUFAxNjsKIAlwcml2LT5iZ19jb2xfYXJnYiA9IDB4RkZGRkZGRkY7IC8qIHdoaXRl
IG5vIHRyYW5zcGFyZW5jeSAqLwogCXByaXYtPmNyb3BfeCA9IDA7CiAJcHJpdi0+Y3JvcF95ID0g
MDsKLQlwcml2LT5jcm9wX3cgPSBwcml2LT50aW1pbmcuaGFjdGl2ZS50eXA7Ci0JcHJpdi0+Y3Jv
cF9oID0gcHJpdi0+dGltaW5nLnZhY3RpdmUudHlwOworCXByaXYtPmNyb3BfdyA9IHRpbWluZ3Mu
aGFjdGl2ZS50eXA7CisJcHJpdi0+Y3JvcF9oID0gdGltaW5ncy52YWN0aXZlLnR5cDsKIAlwcml2
LT5hbHBoYSA9IDB4RkY7CiAKIAlkZWJ1ZygiJXM6ICVkeCVkICVkYnBwIGZyYW1lIGJ1ZmZlciBh
dCAweCVseFxuIiwgX19mdW5jX18sCi0JICAgICAgcHJpdi0+dGltaW5nLmhhY3RpdmUudHlwLCBw
cml2LT50aW1pbmcudmFjdGl2ZS50eXAsCisJICAgICAgdGltaW5ncy5oYWN0aXZlLnR5cCwgdGlt
aW5ncy52YWN0aXZlLnR5cCwKIAkgICAgICBWTkJJVFMocHJpdi0+bDJicHApLCB1Y19wbGF0LT5i
YXNlKTsKIAlkZWJ1ZygiJXM6IGNyb3AgJWQsJWQgJWR4JWQgYmcgMHglMDh4IGFscGhhICVkXG4i
LCBfX2Z1bmNfXywKIAkgICAgICBwcml2LT5jcm9wX3gsIHByaXYtPmNyb3BfeSwgcHJpdi0+Y3Jv
cF93LCBwcml2LT5jcm9wX2gsCiAJICAgICAgcHJpdi0+YmdfY29sX2FyZ2IsIHByaXYtPmFscGhh
KTsKIAogCS8qIENvbmZpZ3VyZSAmIHN0YXJ0IExUREMgKi8KLQlzdG0zMl9sdGRjX3NldF9tb2Rl
KHByaXYpOworCXN0bTMyX2x0ZGNfc2V0X21vZGUocHJpdiwgJnRpbWluZ3MpOwogCXN0bTMyX2x0
ZGNfc2V0X2xheWVyMShwcml2LCB1Y19wbGF0LT5iYXNlKTsKIAlzdG0zMl9sdGRjX2VuYWJsZShw
cml2KTsKIAotCXVjX3ByaXYtPnhzaXplID0gcHJpdi0+dGltaW5nLmhhY3RpdmUudHlwOwotCXVj
X3ByaXYtPnlzaXplID0gcHJpdi0+dGltaW5nLnZhY3RpdmUudHlwOworCXVjX3ByaXYtPnhzaXpl
ID0gdGltaW5ncy5oYWN0aXZlLnR5cDsKKwl1Y19wcml2LT55c2l6ZSA9IHRpbWluZ3MudmFjdGl2
ZS50eXA7CiAJdWNfcHJpdi0+YnBpeCA9IHByaXYtPmwyYnBwOwogCisJaWYgKCFicmlkZ2UpIHsK
KwkJcmV0ID0gcGFuZWxfZW5hYmxlX2JhY2tsaWdodChwYW5lbCk7CisJCWlmIChyZXQpIHsKKwkJ
CWRldl9lcnIoZGV2LCAicGFuZWwgJXMgZW5hYmxlIGJhY2tsaWdodCBlcnJvciAlZFxuIiwKKwkJ
CQlwYW5lbC0+bmFtZSwgcmV0KTsKKwkJCXJldHVybiByZXQ7CisJCX0KKwl9IGVsc2UgaWYgKElT
X0VOQUJMRUQoQ09ORklHX1ZJREVPX0JSSURHRSkpIHsKKwkJcmV0ID0gdmlkZW9fYnJpZGdlX3Nl
dF9iYWNrbGlnaHQoYnJpZGdlLCA4MCk7CisJCWlmIChyZXQpIHsKKwkJCWRldl9lcnIoZGV2LCAi
ZmFpbCB0byBzZXQgYmFja2xpZ2h0XG4iKTsKKwkJCXJldHVybiByZXQ7CisJCX0KKwl9CisKIAl2
aWRlb19zZXRfZmx1c2hfZGNhY2hlKGRldiwgdHJ1ZSk7CiAKIAlyZXR1cm4gMDsKLS0gCjIuNy40
CgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpVYm9vdC1z
dG0zMiBtYWlsaW5nIGxpc3QKVWJvb3Qtc3RtMzJAc3QtbWQtbWFpbG1hbi5zdG9ybXJlcGx5LmNv
bQpodHRwczovL3N0LW1kLW1haWxtYW4uc3Rvcm1yZXBseS5jb20vbWFpbG1hbi9saXN0aW5mby91
Ym9vdC1zdG0zMgo=
