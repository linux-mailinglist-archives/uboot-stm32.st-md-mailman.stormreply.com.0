Return-Path: <uboot-stm32-bounces@st-md-mailman.stormreply.com>
X-Original-To: lists+uboot-stm32@lfdr.de
Delivered-To: lists+uboot-stm32@lfdr.de
Received: from stm-ict-prod-mailman-01.stormreply.prv (st-md-mailman.stormreply.com [52.209.6.89])
	by mail.lfdr.de (Postfix) with ESMTPS id 31B904DD757
	for <lists+uboot-stm32@lfdr.de>; Fri, 18 Mar 2022 10:49:13 +0100 (CET)
Received: from ip-172-31-3-47.eu-west-1.compute.internal (localhost [127.0.0.1])
	by stm-ict-prod-mailman-01.stormreply.prv (Postfix) with ESMTP id EA167C628A2;
	Fri, 18 Mar 2022 09:49:12 +0000 (UTC)
Received: from dfw.source.kernel.org (dfw.source.kernel.org [139.178.84.217])
 (using TLSv1.2 with cipher AECDH-AES256-SHA (256/256 bits))
 (No client certificate requested)
 by stm-ict-prod-mailman-01.stormreply.prv (Postfix) with ESMTPS id 5C599C5F1F2
 for <uboot-stm32@st-md-mailman.stormreply.com>;
 Thu, 17 Mar 2022 12:50:26 +0000 (UTC)
Received: from smtp.kernel.org (relay.kernel.org [52.25.139.140])
 (using TLSv1.2 with cipher ECDHE-RSA-AES256-GCM-SHA384 (256/256 bits))
 (No client certificate requested)
 by dfw.source.kernel.org (Postfix) with ESMTPS id D66DD61536;
 Thu, 17 Mar 2022 12:50:24 +0000 (UTC)
Received: by smtp.kernel.org (Postfix) with ESMTPSA id 09613C36AE2;
 Thu, 17 Mar 2022 12:50:19 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple; d=kernel.org;
 s=k20201202; t=1647521424;
 bh=7DqzyrsmH+DzWfkQNRCwAs2hqEW8Keie7tGJeS4Z4bk=;
 h=From:To:Cc:Subject:Date:In-Reply-To:References:From;
 b=mFqYKEHYiSysDZGeJwmzTe3AzGE2TglMJPkxP9B2ovBcfd5c+Vz+getOz+v7s/ZQt
 354Ejc44U/qqyi76LJHiyvlwcCHHKwuitqnkof+pZF8oT8zRmtdFoMGV6VWGa7tgMA
 1+0K8+RsfocUpzRYyVi+64lDmpic5jO4UZmYT7GqPVeIz9VmHWoRScIvJSFrZXh0zE
 HLuPUlQPW4Ggp7NJNMtILdHjPvKm4tMBqlZwPDaxiDa3dSaX3DJcofvn/njPOG0bvX
 T+Orpbi/UntfnOmm0YtsQZjuAwx/X6G6dv+WpPgg7hGmmaQMLM7EC/ssY+LBvvOim2
 df6IBV95DSc1Q==
From: =?UTF-8?q?Marek=20Beh=C3=BAn?= <kabel@kernel.org>
To: Joe Hershberger <joe.hershberger@ni.com>,
 Ramon Fried <rfried.dev@gmail.com>
Date: Thu, 17 Mar 2022 13:49:51 +0100
Message-Id: <20220317124958.27921-8-kabel@kernel.org>
X-Mailer: git-send-email 2.34.1
In-Reply-To: <20220317124958.27921-1-kabel@kernel.org>
References: <20220317124958.27921-1-kabel@kernel.org>
MIME-Version: 1.0
X-Mailman-Approved-At: Fri, 18 Mar 2022 09:49:12 +0000
Cc: Ryder Lee <ryder.lee@mediatek.com>, Vignesh Raghavendra <vigneshr@ti.com>,
 Masami Hiramatsu <masami.hiramatsu@linaro.org>,
 Jassi Brar <jaswinder.singh@linaro.org>, Priyanka Jain <priyanka.jain@nxp.com>,
 Hou Zhiqiang <Zhiqiang.Hou@nxp.com>, Vikas Manocha <vikas.manocha@st.com>,
 Weijie Gao <weijie.gao@mediatek.com>, Michal Simek <michal.simek@xilinx.com>,
 =?UTF-8?q?Marek=20Beh=C3=BAn?= <marek.behun@nic.cz>,
 Vladimir Oltean <vladimir.oltean@nxp.com>, u-boot@lists.denx.de,
 uboot-stm32@st-md-mailman.stormreply.com,
 Patrick Delaunay <patrick.delaunay@foss.st.com>,
 "Radu Pirea \(NXP OSS\)" <radu-nicolae.pirea@oss.nxp.com>,
 Chunfeng Yun <chunfeng.yun@mediatek.com>, Simon Glass <sjg@chromium.org>,
 Bin Meng <bmeng.cn@gmail.com>,
 GSS_MTK_Uboot_upstream <GSS_MTK_Uboot_upstream@mediatek.com>,
 Wolfgang Denk <wd@denx.de>
Subject: [Uboot-stm32] [PATCH u-boot-net 07/14] net: introduce helpers to
	get PHY interface mode from a device/ofnode
X-BeenThere: uboot-stm32@st-md-mailman.stormreply.com
X-Mailman-Version: 2.1.15
Precedence: list
List-Id: <uboot-stm32.st-md-mailman.stormreply.com>
List-Unsubscribe: <https://st-md-mailman.stormreply.com/mailman/options/uboot-stm32>, 
 <mailto:uboot-stm32-request@st-md-mailman.stormreply.com?subject=unsubscribe>
List-Archive: <http://st-md-mailman.stormreply.com/pipermail/uboot-stm32/>
List-Post: <mailto:uboot-stm32@st-md-mailman.stormreply.com>
List-Help: <mailto:uboot-stm32-request@st-md-mailman.stormreply.com?subject=help>
List-Subscribe: <https://st-md-mailman.stormreply.com/mailman/listinfo/uboot-stm32>, 
 <mailto:uboot-stm32-request@st-md-mailman.stormreply.com?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: uboot-stm32-bounces@st-md-mailman.stormreply.com
Sender: "Uboot-stm32" <uboot-stm32-bounces@st-md-mailman.stormreply.com>

RnJvbTogTWFyZWsgQmVow7puIDxtYXJlay5iZWh1bkBuaWMuY3o+CgpBZGQgaGVscGVycyBvZm5v
ZGVfcmVhZF9waHlfbW9kZSgpIGFuZCBkZXZfcmVhZF9waHlfbW9kZSgpIHRvIHBhcnNlIHRoZQoi
cGh5LW1vZGUiIC8gInBoeS1jb25uZWN0aW9uLXR5cGUiIHByb3BlcnR5LgoKVXNlIHRoZW0gdHJl
ZXdpZGUuCgpUaGlzIGFsbG93cyB1cyB0byBpbmxpbmUgdGhlIHBoeV9nZXRfaW50ZXJmYWNlX2J5
X25hbWUoKSBpbnRvCm9mbm9kZV9yZWFkX3BoeV9tb2RlKCksIHNpbmNlIHRoZSBmb3JtZXIgaXMg
bm90IHVzZWQgYW55bW9yZS4KClNpZ25lZC1vZmYtYnk6IE1hcmVrIEJlaMO6biA8bWFyZWsuYmVo
dW5AbmljLmN6PgotLS0KIGJvYXJkL3N0L3N0bTMyZjc0Ni1kaXNjby9zdG0zMmY3NDYtZGlzY28u
YyB8IDEzICsrKy0tLS0tCiBkcml2ZXJzL2NvcmUvb2Zub2RlLmMgICAgICAgICAgICAgICAgICAg
ICAgfCAyMyArKysrKysrKysrKysrKwogZHJpdmVycy9jb3JlL3JlYWQuYyAgICAgICAgICAgICAg
ICAgICAgICAgIHwgIDUgKysrCiBkcml2ZXJzL25ldC9hZzd4eHguYyAgICAgICAgICAgICAgICAg
ICAgICAgfCAgOSArKy0tLS0KIGRyaXZlcnMvbmV0L2FsdGVyYV90c2UuYyAgICAgICAgICAgICAg
ICAgICB8IDEzICsrLS0tLS0tCiBkcml2ZXJzL25ldC9iY202MzQ4LWV0aC5jICAgICAgICAgICAg
ICAgICAgfCAgNiArLS0tCiBkcml2ZXJzL25ldC9iY21nZW5ldC5jICAgICAgICAgICAgICAgICAg
ICAgfCAxMCArKy0tLS0KIGRyaXZlcnMvbmV0L2Rlc2lnbndhcmUuYyAgICAgICAgICAgICAgICAg
ICB8IDEwICsrLS0tLQogZHJpdmVycy9uZXQvZHdjX2V0aF9xb3MuYyAgICAgICAgICAgICAgICAg
IHwgMzYgKysrLS0tLS0tLS0tLS0tLS0tLS0tLQogZHJpdmVycy9uZXQvZmVjX214Yy5jICAgICAg
ICAgICAgICAgICAgICAgIHwgMTEgKystLS0tLQogZHJpdmVycy9uZXQvZm0vZXRoLmMgICAgICAg
ICAgICAgICAgICAgICAgIHwgMTMgKy0tLS0tLS0KIGRyaXZlcnMvbmV0L2ZzbF9lbmV0Yy5jICAg
ICAgICAgICAgICAgICAgICB8IDEzICsrKy0tLS0tCiBkcml2ZXJzL25ldC9mdGdtYWMxMDAuYyAg
ICAgICAgICAgICAgICAgICAgfCAxMSArKy0tLS0tCiBkcml2ZXJzL25ldC9oaWdtYWN2MzAwLmMg
ICAgICAgICAgICAgICAgICAgfCAgOSArKy0tLS0KIGRyaXZlcnMvbmV0L2xkcGFhX2V0aC9sZHBh
YV9ldGguYyAgICAgICAgICB8IDI4ICsrKy0tLS0tLS0tLS0tLS0tCiBkcml2ZXJzL25ldC9tYWNi
LmMgICAgICAgICAgICAgICAgICAgICAgICAgfCAxMCArKy0tLS0KIGRyaXZlcnMvbmV0L210NzYy
MC1ldGguYyAgICAgICAgICAgICAgICAgICB8IDM1ICsrKysrKystLS0tLS0tLS0tLS0tLQogZHJp
dmVycy9uZXQvbXRrX2V0aC5jICAgICAgICAgICAgICAgICAgICAgIHwgIDggKystLS0KIGRyaXZl
cnMvbmV0L212Z2JlLmMgICAgICAgICAgICAgICAgICAgICAgICB8ICA3ICsrLS0tCiBkcml2ZXJz
L25ldC9tdm5ldGEuYyAgICAgICAgICAgICAgICAgICAgICAgfCAxMSArKy0tLS0tCiBkcml2ZXJz
L25ldC9tdnBwMi5jICAgICAgICAgICAgICAgICAgICAgICAgfCAgOSArKy0tLS0KIGRyaXZlcnMv
bmV0L3BoeS9waHkuYyAgICAgICAgICAgICAgICAgICAgICB8IDI1ICsrLS0tLS0tLS0tLS0tLQog
ZHJpdmVycy9uZXQvcGljMzJfZXRoLmMgICAgICAgICAgICAgICAgICAgIHwgMTEgKystLS0tLQog
ZHJpdmVycy9uZXQvcWUvZG1fcWVfdWVjLmMgICAgICAgICAgICAgICAgIHwgMTEgKystLS0tLQog
ZHJpdmVycy9uZXQvcmF2Yi5jICAgICAgICAgICAgICAgICAgICAgICAgIHwgMTUgKysrLS0tLS0t
CiBkcml2ZXJzL25ldC9zaF9ldGguYyAgICAgICAgICAgICAgICAgICAgICAgfCAxNSArKystLS0t
LS0KIGRyaXZlcnMvbmV0L3NuaV9hdmUuYyAgICAgICAgICAgICAgICAgICAgICB8IDEyICsrLS0t
LS0tCiBkcml2ZXJzL25ldC9zbmlfbmV0c2VjLmMgICAgICAgICAgICAgICAgICAgfCAxMCArKy0t
LS0KIGRyaXZlcnMvbmV0L3N1bjhpX2VtYWMuYyAgICAgICAgICAgICAgICAgICB8IDExICsrLS0t
LS0KIGRyaXZlcnMvbmV0L3RpL2FtNjUtY3Bzdy1udXNzLmMgICAgICAgICAgICB8IDE1ICsrKy0t
LS0tLQogZHJpdmVycy9uZXQvdGkvY3Bzdy5jICAgICAgICAgICAgICAgICAgICAgIHwgMTAgKyst
LS0tCiBkcml2ZXJzL25ldC90aS9rZXlzdG9uZV9uZXQuYyAgICAgICAgICAgICAgfCAyNCArKysr
KysrLS0tLS0tLS0KIGRyaXZlcnMvbmV0L3RzZWMuYyAgICAgICAgICAgICAgICAgICAgICAgICB8
ICA5ICsrLS0tLQogZHJpdmVycy9uZXQveGlsaW54X2F4aV9lbWFjLmMgICAgICAgICAgICAgIHwg
MTAgKystLS0tCiBkcml2ZXJzL25ldC96eW5xX2dlbS5jICAgICAgICAgICAgICAgICAgICAgfCAg
OSArKy0tLS0KIGluY2x1ZGUvZG0vb2Zub2RlLmggICAgICAgICAgICAgICAgICAgICAgICB8IDEz
ICsrKysrKysrCiBpbmNsdWRlL2RtL3JlYWQuaCAgICAgICAgICAgICAgICAgICAgICAgICAgfCAx
NyArKysrKysrKysrCiBpbmNsdWRlL3BoeS5oICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
fCAgOCAtLS0tLQogbmV0L21kaW8tdWNsYXNzLmMgICAgICAgICAgICAgICAgICAgICAgICAgIHwg
MTggKy0tLS0tLS0tLS0KIDM5IGZpbGVzIGNoYW5nZWQsIDE2MSBpbnNlcnRpb25zKCspLCAzNzIg
ZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvYm9hcmQvc3Qvc3RtMzJmNzQ2LWRpc2NvL3N0bTMy
Zjc0Ni1kaXNjby5jIGIvYm9hcmQvc3Qvc3RtMzJmNzQ2LWRpc2NvL3N0bTMyZjc0Ni1kaXNjby5j
CmluZGV4IDk1ZDgzZTczZWUuLjY5ZjY1N2M1NGIgMTAwNjQ0Ci0tLSBhL2JvYXJkL3N0L3N0bTMy
Zjc0Ni1kaXNjby9zdG0zMmY3NDYtZGlzY28uYworKysgYi9ib2FyZC9zdC9zdG0zMmY3NDYtZGlz
Y28vc3RtMzJmNzQ2LWRpc2NvLmMKQEAgLTExNywxNiArMTE3LDEzIEBAIGludCBib2FyZF9sYXRl
X2luaXQodm9pZCkKIGludCBib2FyZF9pbml0KHZvaWQpCiB7CiAjaWZkZWYgQ09ORklHX0VUSF9E
RVNJR05XQVJFCi0JY29uc3QgY2hhciAqcGh5X21vZGU7Ci0JaW50IG5vZGU7CisJb2Zub2RlIG5v
ZGU7CiAKLQlub2RlID0gZmR0X25vZGVfb2Zmc2V0X2J5X2NvbXBhdGlibGUoZ2QtPmZkdF9ibG9i
LCAwLCAic3Qsc3RtMzItZHdtYWMiKTsKLQlpZiAobm9kZSA8IDApCisJbm9kZSA9IG9mbm9kZV9i
eV9jb21wYXRpYmxlKG9mbm9kZV9udWxsKCksICJzdCxzdG0zMi1kd21hYyIpOworCWlmICghb2Zu
b2RlX3ZhbGlkKG5vZGUpKQogCQlyZXR1cm4gLTE7CiAKLQlwaHlfbW9kZSA9IGZkdF9nZXRwcm9w
KGdkLT5mZHRfYmxvYiwgbm9kZSwgInBoeS1tb2RlIiwgTlVMTCk7Ci0KLQlzd2l0Y2ggKHBoeV9n
ZXRfaW50ZXJmYWNlX2J5X25hbWUocGh5X21vZGUpKSB7CisJc3dpdGNoIChvZm5vZGVfcmVhZF9w
aHlfbW9kZShub2RlKSkgewogCWNhc2UgUEhZX0lOVEVSRkFDRV9NT0RFX1JNSUk6CiAJCVNUTTMy
X1NZU0NGRy0+cG1jIHw9IFNZU0NGR19QTUNfTUlJX1JNSUlfU0VMOwogCQlicmVhazsKQEAgLTEz
NCw3ICsxMzEsNyBAQCBpbnQgYm9hcmRfaW5pdCh2b2lkKQogCQlTVE0zMl9TWVNDRkctPnBtYyAm
PSB+U1lTQ0ZHX1BNQ19NSUlfUk1JSV9TRUw7CiAJCWJyZWFrOwogCWRlZmF1bHQ6Ci0JCXByaW50
ZigiUEhZIGludGVyZmFjZSAlcyBub3Qgc3VwcG9ydGVkICFcbiIsIHBoeV9tb2RlKTsKKwkJcHJp
bnRmKCJVbnN1cHBvcnRlZCBQSFkgaW50ZXJmYWNlIVxuIik7CiAJfQogI2VuZGlmCiAKZGlmZiAt
LWdpdCBhL2RyaXZlcnMvY29yZS9vZm5vZGUuYyBiL2RyaXZlcnMvY29yZS9vZm5vZGUuYwppbmRl
eCBlYWFkMmM5ODliLi4xOTFhYjYzYTVkIDEwMDY0NAotLS0gYS9kcml2ZXJzL2NvcmUvb2Zub2Rl
LmMKKysrIGIvZHJpdmVycy9jb3JlL29mbm9kZS5jCkBAIC0xMTgzLDMgKzExODMsMjYgQEAgb2Zu
b2RlIG9mbm9kZV9nZXRfcGh5X25vZGUob2Zub2RlIG5vZGUpCiAKIAlyZXR1cm4gYXJncy5ub2Rl
OwogfQorCitwaHlfaW50ZXJmYWNlX3Qgb2Zub2RlX3JlYWRfcGh5X21vZGUob2Zub2RlIG5vZGUp
Cit7CisJY29uc3QgY2hhciAqbW9kZTsKKwlpbnQgaTsKKworCWFzc2VydChvZm5vZGVfdmFsaWQo
bm9kZSkpOworCisJbW9kZSA9IG9mbm9kZV9yZWFkX3N0cmluZyhub2RlLCAicGh5LW1vZGUiKTsK
KwlpZiAoIW1vZGUpCisJCW1vZGUgPSBvZm5vZGVfcmVhZF9zdHJpbmcobm9kZSwgInBoeS1jb25u
ZWN0aW9uLXR5cGUiKTsKKworCWlmICghbW9kZSkKKwkJcmV0dXJuIFBIWV9JTlRFUkZBQ0VfTU9E
RV9OT05FOworCisJZm9yIChpID0gMDsgaSA8IFBIWV9JTlRFUkZBQ0VfTU9ERV9DT1VOVDsgaSsr
KQorCQlpZiAoIXN0cmNtcChtb2RlLCBwaHlfaW50ZXJmYWNlX3N0cmluZ3NbaV0pKQorCQkJcmV0
dXJuIGk7CisKKwlkZWJ1ZygiJXM6IEludmFsaWQgUEhZIGludGVyZmFjZSAnJXMnXG4iLCBfX2Z1
bmNfXywgbW9kZSk7CisKKwlyZXR1cm4gUEhZX0lOVEVSRkFDRV9NT0RFX05PTkU7Cit9CmRpZmYg
LS1naXQgYS9kcml2ZXJzL2NvcmUvcmVhZC5jIGIvZHJpdmVycy9jb3JlL3JlYWQuYwppbmRleCA3
ZmYxMDAyMThkLi5jNzM1MDhkMjc2IDEwMDY0NAotLS0gYS9kcml2ZXJzL2NvcmUvcmVhZC5jCisr
KyBiL2RyaXZlcnMvY29yZS9yZWFkLmMKQEAgLTQwMywzICs0MDMsOCBAQCBvZm5vZGUgZGV2X2dl
dF9waHlfbm9kZShjb25zdCBzdHJ1Y3QgdWRldmljZSAqZGV2KQogewogCXJldHVybiBvZm5vZGVf
Z2V0X3BoeV9ub2RlKGRldl9vZm5vZGUoZGV2KSk7CiB9CisKK3BoeV9pbnRlcmZhY2VfdCBkZXZf
cmVhZF9waHlfbW9kZShjb25zdCBzdHJ1Y3QgdWRldmljZSAqZGV2KQoreworCXJldHVybiBvZm5v
ZGVfcmVhZF9waHlfbW9kZShkZXZfb2Zub2RlKGRldikpOworfQpkaWZmIC0tZ2l0IGEvZHJpdmVy
cy9uZXQvYWc3eHh4LmMgYi9kcml2ZXJzL25ldC9hZzd4eHguYwppbmRleCA2MzJhYjNjMWU1Li5m
MjRhOTE3YmQ0IDEwMDY0NAotLS0gYS9kcml2ZXJzL25ldC9hZzd4eHguYworKysgYi9kcml2ZXJz
L25ldC9hZzd4eHguYwpAQCAtMTI1NCw3ICsxMjU0LDYgQEAgc3RhdGljIGNvbnN0IHN0cnVjdCBl
dGhfb3BzIGFnN3h4eF9ldGhfb3BzID0gewogc3RhdGljIGludCBhZzd4eHhfZXRoX29mX3RvX3Bs
YXQoc3RydWN0IHVkZXZpY2UgKmRldikKIHsKIAlzdHJ1Y3QgZXRoX3BkYXRhICpwZGF0YSA9IGRl
dl9nZXRfcGxhdChkZXYpOwotCWNvbnN0IGNoYXIgKnBoeV9tb2RlOwogCWludCByZXQ7CiAKIAlw
ZGF0YS0+aW9iYXNlID0gZGV2X3JlYWRfYWRkcihkZXYpOwpAQCAtMTI2NSwxMyArMTI2NCw5IEBA
IHN0YXRpYyBpbnQgYWc3eHh4X2V0aF9vZl90b19wbGF0KHN0cnVjdCB1ZGV2aWNlICpkZXYpCiAJ
aWYgKHJldCA8PSAwKQogCQlyZXR1cm4gcmV0OwogCi0JcGh5X21vZGUgPSBmZHRfZ2V0cHJvcChn
ZC0+ZmR0X2Jsb2IsIHJldCwgInBoeS1tb2RlIiwgTlVMTCk7Ci0JaWYgKHBoeV9tb2RlKQotCQlw
ZGF0YS0+cGh5X2ludGVyZmFjZSA9IHBoeV9nZXRfaW50ZXJmYWNlX2J5X25hbWUocGh5X21vZGUp
OwotCWlmIChwZGF0YS0+cGh5X2ludGVyZmFjZSA9PSAtMSkgewotCQlkZWJ1ZygiJXM6IEludmFs
aWQgUEhZIGludGVyZmFjZSAnJXMnXG4iLCBfX2Z1bmNfXywgcGh5X21vZGUpOworCXBkYXRhLT5w
aHlfaW50ZXJmYWNlID0gZGV2X3JlYWRfcGh5X21vZGUoZGV2KTsKKwlpZiAocGRhdGEtPnBoeV9p
bnRlcmZhY2UgPT0gUEhZX0lOVEVSRkFDRV9NT0RFX05PTkUpCiAJCXJldHVybiAtRUlOVkFMOwot
CX0KIAogCXJldHVybiAwOwogfQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9uZXQvYWx0ZXJhX3RzZS5j
IGIvZHJpdmVycy9uZXQvYWx0ZXJhX3RzZS5jCmluZGV4IGViNGNkOTY3NjMuLjI1MjQ3NDcyYjAg
MTAwNjQ0Ci0tLSBhL2RyaXZlcnMvbmV0L2FsdGVyYV90c2UuYworKysgYi9kcml2ZXJzL25ldC9h
bHRlcmFfdHNlLmMKQEAgLTY3NiwxNyArNjc2LDEwIEBAIHN0YXRpYyBpbnQgYWx0ZXJhX3RzZV9w
cm9iZShzdHJ1Y3QgdWRldmljZSAqZGV2KQogc3RhdGljIGludCBhbHRlcmFfdHNlX29mX3RvX3Bs
YXQoc3RydWN0IHVkZXZpY2UgKmRldikKIHsKIAlzdHJ1Y3QgZXRoX3BkYXRhICpwZGF0YSA9IGRl
dl9nZXRfcGxhdChkZXYpOwotCWNvbnN0IGNoYXIgKnBoeV9tb2RlOwotCi0JcGRhdGEtPnBoeV9p
bnRlcmZhY2UgPSAtMTsKLQlwaHlfbW9kZSA9IGZkdF9nZXRwcm9wKGdkLT5mZHRfYmxvYiwgZGV2
X29mX29mZnNldChkZXYpLCAicGh5LW1vZGUiLAotCQkJICAgICAgIE5VTEwpOwotCWlmIChwaHlf
bW9kZSkKLQkJcGRhdGEtPnBoeV9pbnRlcmZhY2UgPSBwaHlfZ2V0X2ludGVyZmFjZV9ieV9uYW1l
KHBoeV9tb2RlKTsKLQlpZiAocGRhdGEtPnBoeV9pbnRlcmZhY2UgPT0gLTEpIHsKLQkJZGVidWco
IiVzOiBJbnZhbGlkIFBIWSBpbnRlcmZhY2UgJyVzJ1xuIiwgX19mdW5jX18sIHBoeV9tb2RlKTsK
KworCXBkYXRhLT5waHlfaW50ZXJmYWNlID0gZGV2X3JlYWRfcGh5X21vZGUoZGV2KTsKKwlpZiAo
cGRhdGEtPnBoeV9pbnRlcmZhY2UgPT0gUEhZX0lOVEVSRkFDRV9NT0RFX05PTkUpCiAJCXJldHVy
biAtRUlOVkFMOwotCX0KIAogCXJldHVybiAwOwogfQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9uZXQv
YmNtNjM0OC1ldGguYyBiL2RyaXZlcnMvbmV0L2JjbTYzNDgtZXRoLmMKaW5kZXggYWFkN2I2MTIx
My4uNzViMjQxMzZmZCAxMDA2NDQKLS0tIGEvZHJpdmVycy9uZXQvYmNtNjM0OC1ldGguYworKysg
Yi9kcml2ZXJzL25ldC9iY202MzQ4LWV0aC5jCkBAIC00MTUsNyArNDE1LDYgQEAgc3RhdGljIGlu
dCBiY202MzQ4X2V0aF9wcm9iZShzdHJ1Y3QgdWRldmljZSAqZGV2KQogCXN0cnVjdCBldGhfcGRh
dGEgKnBkYXRhID0gZGV2X2dldF9wbGF0KGRldik7CiAJc3RydWN0IGJjbTYzNDhfZXRoX3ByaXYg
KnByaXYgPSBkZXZfZ2V0X3ByaXYoZGV2KTsKIAlzdHJ1Y3Qgb2Zub2RlX3BoYW5kbGVfYXJncyBw
aHk7Ci0JY29uc3QgY2hhciAqcGh5X21vZGU7CiAJaW50IHJldCwgaTsKIAogCS8qIGdldCBiYXNl
IGFkZHJlc3MgKi8KQEAgLTQyNSwxMCArNDI0LDcgQEAgc3RhdGljIGludCBiY202MzQ4X2V0aF9w
cm9iZShzdHJ1Y3QgdWRldmljZSAqZGV2KQogCXBkYXRhLT5pb2Jhc2UgPSAocGh5c19hZGRyX3Qp
IHByaXYtPmJhc2U7CiAKIAkvKiBnZXQgcGh5IG1vZGUgKi8KLQlwZGF0YS0+cGh5X2ludGVyZmFj
ZSA9IFBIWV9JTlRFUkZBQ0VfTU9ERV9OT05FOwotCXBoeV9tb2RlID0gZGV2X3JlYWRfc3RyaW5n
KGRldiwgInBoeS1tb2RlIik7Ci0JaWYgKHBoeV9tb2RlKQotCQlwZGF0YS0+cGh5X2ludGVyZmFj
ZSA9IHBoeV9nZXRfaW50ZXJmYWNlX2J5X25hbWUocGh5X21vZGUpOworCXBkYXRhLT5waHlfaW50
ZXJmYWNlID0gZGV2X3JlYWRfcGh5X21vZGUoZGV2KTsKIAlpZiAocGRhdGEtPnBoeV9pbnRlcmZh
Y2UgPT0gUEhZX0lOVEVSRkFDRV9NT0RFX05PTkUpCiAJCXJldHVybiAtRU5PREVWOwogCmRpZmYg
LS1naXQgYS9kcml2ZXJzL25ldC9iY21nZW5ldC5jIGIvZHJpdmVycy9uZXQvYmNtZ2VuZXQuYwpp
bmRleCA2NzgzOTU2M2RiLi5jNmFjYjQ5MzJiIDEwMDY0NAotLS0gYS9kcml2ZXJzL25ldC9iY21n
ZW5ldC5jCisrKyBiL2RyaXZlcnMvbmV0L2JjbWdlbmV0LmMKQEAgLTY5MCwyMCArNjkwLDE0IEBA
IHN0YXRpYyBpbnQgYmNtZ2VuZXRfZXRoX29mX3RvX3BsYXQoc3RydWN0IHVkZXZpY2UgKmRldikK
IAlzdHJ1Y3QgZXRoX3BkYXRhICpwZGF0YSA9IGRldl9nZXRfcGxhdChkZXYpOwogCXN0cnVjdCBi
Y21nZW5ldF9ldGhfcHJpdiAqcHJpdiA9IGRldl9nZXRfcHJpdihkZXYpOwogCXN0cnVjdCBvZm5v
ZGVfcGhhbmRsZV9hcmdzIHBoeV9ub2RlOwotCWNvbnN0IGNoYXIgKnBoeV9tb2RlOwogCWludCBy
ZXQ7CiAKIAlwZGF0YS0+aW9iYXNlID0gZGV2X3JlYWRfYWRkcihkZXYpOwogCiAJLyogR2V0IHBo
eSBtb2RlIGZyb20gRFQgKi8KLQlwZGF0YS0+cGh5X2ludGVyZmFjZSA9IC0xOwotCXBoeV9tb2Rl
ID0gZGV2X3JlYWRfc3RyaW5nKGRldiwgInBoeS1tb2RlIik7Ci0JaWYgKHBoeV9tb2RlKQotCQlw
ZGF0YS0+cGh5X2ludGVyZmFjZSA9IHBoeV9nZXRfaW50ZXJmYWNlX2J5X25hbWUocGh5X21vZGUp
OwotCWlmIChwZGF0YS0+cGh5X2ludGVyZmFjZSA9PSAtMSkgewotCQlkZWJ1ZygiJXM6IEludmFs
aWQgUEhZIGludGVyZmFjZSAnJXMnXG4iLCBfX2Z1bmNfXywgcGh5X21vZGUpOworCXBkYXRhLT5w
aHlfaW50ZXJmYWNlID0gZGV2X3JlYWRfcGh5X21vZGUoZGV2KTsKKwlpZiAocGRhdGEtPnBoeV9p
bnRlcmZhY2UgPT0gUEhZX0lOVEVSRkFDRV9NT0RFX05PTkUpCiAJCXJldHVybiAtRUlOVkFMOwot
CX0KIAogCXJldCA9IGRldl9yZWFkX3BoYW5kbGVfd2l0aF9hcmdzKGRldiwgInBoeS1oYW5kbGUi
LCBOVUxMLCAwLCAwLAogCQkJCQkgJnBoeV9ub2RlKTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvbmV0
L2Rlc2lnbndhcmUuYyBiL2RyaXZlcnMvbmV0L2Rlc2lnbndhcmUuYwppbmRleCA1YWFhYzYwM2Ew
Li43YjdiMGY2NTc4IDEwMDY0NAotLS0gYS9kcml2ZXJzL25ldC9kZXNpZ253YXJlLmMKKysrIGIv
ZHJpdmVycy9uZXQvZGVzaWdud2FyZS5jCkBAIC05MTQsMjEgKzkxNCwxNSBAQCBpbnQgZGVzaWdu
d2FyZV9ldGhfb2ZfdG9fcGxhdChzdHJ1Y3QgdWRldmljZSAqZGV2KQogCXN0cnVjdCBkd19ldGhf
ZGV2ICpwcml2ID0gZGV2X2dldF9wcml2KGRldik7CiAjZW5kaWYKIAlzdHJ1Y3QgZXRoX3BkYXRh
ICpwZGF0YSA9ICZkd19wZGF0YS0+ZXRoX3BkYXRhOwotCWNvbnN0IGNoYXIgKnBoeV9tb2RlOwog
I2lmIENPTkZJR19JU19FTkFCTEVEKERNX0dQSU8pCiAJaW50IHJlc2V0X2ZsYWdzID0gR1BJT0Rf
SVNfT1VUOwogI2VuZGlmCiAJaW50IHJldCA9IDA7CiAKIAlwZGF0YS0+aW9iYXNlID0gZGV2X3Jl
YWRfYWRkcihkZXYpOwotCXBkYXRhLT5waHlfaW50ZXJmYWNlID0gLTE7Ci0JcGh5X21vZGUgPSBk
ZXZfcmVhZF9zdHJpbmcoZGV2LCAicGh5LW1vZGUiKTsKLQlpZiAocGh5X21vZGUpCi0JCXBkYXRh
LT5waHlfaW50ZXJmYWNlID0gcGh5X2dldF9pbnRlcmZhY2VfYnlfbmFtZShwaHlfbW9kZSk7Ci0J
aWYgKHBkYXRhLT5waHlfaW50ZXJmYWNlID09IC0xKSB7Ci0JCWRlYnVnKCIlczogSW52YWxpZCBQ
SFkgaW50ZXJmYWNlICclcydcbiIsIF9fZnVuY19fLCBwaHlfbW9kZSk7CisJcGRhdGEtPnBoeV9p
bnRlcmZhY2UgPSBkZXZfcmVhZF9waHlfbW9kZShkZXYpOworCWlmIChwZGF0YS0+cGh5X2ludGVy
ZmFjZSA9PSBQSFlfSU5URVJGQUNFX01PREVfTk9ORSkKIAkJcmV0dXJuIC1FSU5WQUw7Ci0JfQog
CiAJcGRhdGEtPm1heF9zcGVlZCA9IGRldl9yZWFkX3UzMl9kZWZhdWx0KGRldiwgIm1heC1zcGVl
ZCIsIDApOwogCmRpZmYgLS1naXQgYS9kcml2ZXJzL25ldC9kd2NfZXRoX3Fvcy5jIGIvZHJpdmVy
cy9uZXQvZHdjX2V0aF9xb3MuYwppbmRleCAyMmRhZDViMjAzLi45Nzc3ZjZjYjljIDEwMDY0NAot
LS0gYS9kcml2ZXJzL25ldC9kd2NfZXRoX3Fvcy5jCisrKyBiL2RyaXZlcnMvbmV0L2R3Y19ldGhf
cW9zLmMKQEAgLTI3MCw3ICsyNzAsNyBAQCBzdHJ1Y3QgZXFvc19jb25maWcgewogCWludCBjb25m
aWdfbWFjOwogCWludCBjb25maWdfbWFjX21kaW87CiAJdW5zaWduZWQgaW50IGF4aV9idXNfd2lk
dGg7Ci0JcGh5X2ludGVyZmFjZV90ICgqaW50ZXJmYWNlKShzdHJ1Y3QgdWRldmljZSAqZGV2KTsK
KwlwaHlfaW50ZXJmYWNlX3QgKCppbnRlcmZhY2UpKGNvbnN0IHN0cnVjdCB1ZGV2aWNlICpkZXYp
OwogCXN0cnVjdCBlcW9zX29wcyAqb3BzOwogfTsKIApAQCAtMTcyOSwyMSArMTcyOSw3IEBAIGVy
cl9wcm9iZToKIAlyZXR1cm4gcmV0OwogfQogCi1zdGF0aWMgcGh5X2ludGVyZmFjZV90IGVxb3Nf
Z2V0X2ludGVyZmFjZV9zdG0zMihzdHJ1Y3QgdWRldmljZSAqZGV2KQotewotCWNvbnN0IGNoYXIg
KnBoeV9tb2RlOwotCXBoeV9pbnRlcmZhY2VfdCBpbnRlcmZhY2UgPSBQSFlfSU5URVJGQUNFX01P
REVfTk9ORTsKLQotCWRlYnVnKCIlcyhkZXY9JXApOlxuIiwgX19mdW5jX18sIGRldik7Ci0KLQlw
aHlfbW9kZSA9IGRldl9yZWFkX3Byb3AoZGV2LCAicGh5LW1vZGUiLCBOVUxMKTsKLQlpZiAocGh5
X21vZGUpCi0JCWludGVyZmFjZSA9IHBoeV9nZXRfaW50ZXJmYWNlX2J5X25hbWUocGh5X21vZGUp
OwotCi0JcmV0dXJuIGludGVyZmFjZTsKLX0KLQotc3RhdGljIHBoeV9pbnRlcmZhY2VfdCBlcW9z
X2dldF9pbnRlcmZhY2VfdGVncmExODYoc3RydWN0IHVkZXZpY2UgKmRldikKK3N0YXRpYyBwaHlf
aW50ZXJmYWNlX3QgZXFvc19nZXRfaW50ZXJmYWNlX3RlZ3JhMTg2KGNvbnN0IHN0cnVjdCB1ZGV2
aWNlICpkZXYpCiB7CiAJcmV0dXJuIFBIWV9JTlRFUkZBQ0VfTU9ERV9NSUk7CiB9CkBAIC0xNzY2
LDIwICsxNzUyLDYgQEAgc3RhdGljIGludCBlcW9zX3Byb2JlX3Jlc291cmNlc19pbXgoc3RydWN0
IHVkZXZpY2UgKmRldikKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIHBoeV9pbnRlcmZhY2VfdCBl
cW9zX2dldF9pbnRlcmZhY2VfaW14KHN0cnVjdCB1ZGV2aWNlICpkZXYpCi17Ci0JY29uc3QgY2hh
ciAqcGh5X21vZGU7Ci0JcGh5X2ludGVyZmFjZV90IGludGVyZmFjZSA9IFBIWV9JTlRFUkZBQ0Vf
TU9ERV9OT05FOwotCi0JZGVidWcoIiVzKGRldj0lcCk6XG4iLCBfX2Z1bmNfXywgZGV2KTsKLQot
CXBoeV9tb2RlID0gZGV2X3JlYWRfcHJvcChkZXYsICJwaHktbW9kZSIsIE5VTEwpOwotCWlmIChw
aHlfbW9kZSkKLQkJaW50ZXJmYWNlID0gcGh5X2dldF9pbnRlcmZhY2VfYnlfbmFtZShwaHlfbW9k
ZSk7Ci0KLQlyZXR1cm4gaW50ZXJmYWNlOwotfQotCiBzdGF0aWMgaW50IGVxb3NfcmVtb3ZlX3Jl
c291cmNlc190ZWdyYTE4NihzdHJ1Y3QgdWRldmljZSAqZGV2KQogewogCXN0cnVjdCBlcW9zX3By
aXYgKmVxb3MgPSBkZXZfZ2V0X3ByaXYoZGV2KTsKQEAgLTE5ODUsNyArMTk1Nyw3IEBAIHN0YXRp
YyBjb25zdCBzdHJ1Y3QgZXFvc19jb25maWcgX19tYXliZV91bnVzZWQgZXFvc19zdG0zMl9jb25m
aWcgPSB7CiAJLmNvbmZpZ19tYWMgPSBFUU9TX01BQ19SWFFfQ1RSTDBfUlhRMEVOX0VOQUJMRURf
QVYsCiAJLmNvbmZpZ19tYWNfbWRpbyA9IEVRT1NfTUFDX01ESU9fQUREUkVTU19DUl8yNTBfMzAw
LAogCS5heGlfYnVzX3dpZHRoID0gRVFPU19BWElfV0lEVEhfNjQsCi0JLmludGVyZmFjZSA9IGVx
b3NfZ2V0X2ludGVyZmFjZV9zdG0zMiwKKwkuaW50ZXJmYWNlID0gZGV2X3JlYWRfcGh5X21vZGUs
CiAJLm9wcyA9ICZlcW9zX3N0bTMyX29wcwogfTsKIApAQCAtMjAxMyw3ICsxOTg1LDcgQEAgc3Ry
dWN0IGVxb3NfY29uZmlnIF9fbWF5YmVfdW51c2VkIGVxb3NfaW14X2NvbmZpZyA9IHsKIAkuY29u
ZmlnX21hYyA9IEVRT1NfTUFDX1JYUV9DVFJMMF9SWFEwRU5fRU5BQkxFRF9EQ0IsCiAJLmNvbmZp
Z19tYWNfbWRpbyA9IEVRT1NfTUFDX01ESU9fQUREUkVTU19DUl8yNTBfMzAwLAogCS5heGlfYnVz
X3dpZHRoID0gRVFPU19BWElfV0lEVEhfNjQsCi0JLmludGVyZmFjZSA9IGVxb3NfZ2V0X2ludGVy
ZmFjZV9pbXgsCisJLmludGVyZmFjZSA9IGRldl9yZWFkX3BoeV9tb2RlLAogCS5vcHMgPSAmZXFv
c19pbXhfb3BzCiB9OwogCmRpZmYgLS1naXQgYS9kcml2ZXJzL25ldC9mZWNfbXhjLmMgYi9kcml2
ZXJzL25ldC9mZWNfbXhjLmMKaW5kZXggOTg1YjAzODQ0Ny4uZGUxZDA2ZjBmMSAxMDA2NDQKLS0t
IGEvZHJpdmVycy9uZXQvZmVjX214Yy5jCisrKyBiL2RyaXZlcnMvbmV0L2ZlY19teGMuYwpAQCAt
MTU1OCwyMCArMTU1OCwxMyBAQCBzdGF0aWMgaW50IGZlY214Y19vZl90b19wbGF0KHN0cnVjdCB1
ZGV2aWNlICpkZXYpCiAJaW50IHJldCA9IDA7CiAJc3RydWN0IGV0aF9wZGF0YSAqcGRhdGEgPSBk
ZXZfZ2V0X3BsYXQoZGV2KTsKIAlzdHJ1Y3QgZmVjX3ByaXYgKnByaXYgPSBkZXZfZ2V0X3ByaXYo
ZGV2KTsKLQljb25zdCBjaGFyICpwaHlfbW9kZTsKIAogCXBkYXRhLT5pb2Jhc2UgPSBkZXZfcmVh
ZF9hZGRyKGRldik7CiAJcHJpdi0+ZXRoID0gKHN0cnVjdCBldGhlcm5ldF9yZWdzICopcGRhdGEt
PmlvYmFzZTsKIAotCXBkYXRhLT5waHlfaW50ZXJmYWNlID0gLTE7Ci0JcGh5X21vZGUgPSBmZHRf
Z2V0cHJvcChnZC0+ZmR0X2Jsb2IsIGRldl9vZl9vZmZzZXQoZGV2KSwgInBoeS1tb2RlIiwKLQkJ
CSAgICAgICBOVUxMKTsKLQlpZiAocGh5X21vZGUpCi0JCXBkYXRhLT5waHlfaW50ZXJmYWNlID0g
cGh5X2dldF9pbnRlcmZhY2VfYnlfbmFtZShwaHlfbW9kZSk7Ci0JaWYgKHBkYXRhLT5waHlfaW50
ZXJmYWNlID09IC0xKSB7Ci0JCWRlYnVnKCIlczogSW52YWxpZCBQSFkgaW50ZXJmYWNlICclcydc
biIsIF9fZnVuY19fLCBwaHlfbW9kZSk7CisJcGRhdGEtPnBoeV9pbnRlcmZhY2UgPSBkZXZfcmVh
ZF9waHlfbW9kZShkZXYpOworCWlmIChwZGF0YS0+cGh5X2ludGVyZmFjZSA9PSBQSFlfSU5URVJG
QUNFX01PREVfTk9ORSkKIAkJcmV0dXJuIC1FSU5WQUw7Ci0JfQogCiAjaWZkZWYgQ09ORklHX0RN
X1JFR1VMQVRPUgogCWRldmljZV9nZXRfc3VwcGx5X3JlZ3VsYXRvcihkZXYsICJwaHktc3VwcGx5
IiwgJnByaXYtPnBoeV9zdXBwbHkpOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9uZXQvZm0vZXRoLmMg
Yi9kcml2ZXJzL25ldC9mbS9ldGguYwppbmRleCA1ZTBkMGJjYTliLi4xZmZlOWUyYjdhIDEwMDY0
NAotLS0gYS9kcml2ZXJzL25ldC9mbS9ldGguYworKysgYi9kcml2ZXJzL25ldC9mbS9ldGguYwpA
QCAtOTU0LDE3ICs5NTQsNiBAQCBpbnQgZm1fZXRoX2luaXRpYWxpemUoc3RydWN0IGNjc3JfZm1h
biAqcmVnLCBzdHJ1Y3QgZm1fZXRoX2luZm8gKmluZm8pCiAJcmV0dXJuIDA7CiB9CiAjZWxzZSAv
KiBDT05GSUdfRE1fRVRIICovCi0jaWZkZWYgQ09ORklHX1BIWUxJQgotcGh5X2ludGVyZmFjZV90
IGZtYW5fcmVhZF9zeXNfaWYoc3RydWN0IHVkZXZpY2UgKmRldikKLXsKLQljb25zdCBjaGFyICpp
Zl9zdHI7Ci0KLQlpZl9zdHIgPSBvZm5vZGVfcmVhZF9zdHJpbmcoZGV2X29mbm9kZShkZXYpLCAi
cGh5LWNvbm5lY3Rpb24tdHlwZSIpOwotCWRlYnVnKCJNQUMgc3lzdGVtIGludGVyZmFjZSBtb2Rl
ICVzXG4iLCBpZl9zdHIpOwotCi0JcmV0dXJuIHBoeV9nZXRfaW50ZXJmYWNlX2J5X25hbWUoaWZf
c3RyKTsKLX0KLSNlbmRpZgogCiBzdGF0aWMgaW50IGZtX2V0aF9iaW5kKHN0cnVjdCB1ZGV2aWNl
ICpkZXYpCiB7CkBAIC0xMDM4LDcgKzEwMjcsNyBAQCBzdGF0aWMgaW50IGZtX2V0aF9wcm9iZShz
dHJ1Y3QgdWRldmljZSAqZGV2KQogCXJlZyA9ICh2b2lkICopKHVpbnRwdHJfdClkZXZfcmVhZF9h
ZGRyKGRldik7CiAJZm1fZXRoLT5tYWNfdHlwZSA9IGRldl9nZXRfZHJpdmVyX2RhdGEoZGV2KTsK
ICNpZmRlZiBDT05GSUdfUEhZTElCCi0JZm1fZXRoLT5lbmV0X2lmID0gZm1hbl9yZWFkX3N5c19p
ZihkZXYpOworCWZtX2V0aC0+ZW5ldF9pZiA9IGRldl9yZWFkX3BoeV9tb2RlKGRldik7CiAjZWxz
ZQogCWZtX2V0aC0+ZW5ldF9pZiA9IFBIWV9JTlRFUkZBQ0VfTU9ERV9TR01JSTsKIAlwcmludGYo
IiVzOiB3YXJuaW5nIC0gdW5hYmxlIHRvIGRldGVybWluZSBpbnRlcmZhY2UgdHlwZVxuIiwgX19m
dW5jX18pOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9uZXQvZnNsX2VuZXRjLmMgYi9kcml2ZXJzL25l
dC9mc2xfZW5ldGMuYwppbmRleCA5MTVjN2M4MDI1Li44ZjVhZjFkYmMwIDEwMDY0NAotLS0gYS9k
cml2ZXJzL25ldC9mc2xfZW5ldGMuYworKysgYi9kcml2ZXJzL25ldC9mc2xfZW5ldGMuYwpAQCAt
MjYwLDkgKzI2MCw2IEBAIHN0YXRpYyBpbnQgZW5ldGNfaW5pdF9zeGdtaWkoc3RydWN0IHVkZXZp
Y2UgKmRldikKIHN0YXRpYyB2b2lkIGVuZXRjX3N0YXJ0X3BjcyhzdHJ1Y3QgdWRldmljZSAqZGV2
KQogewogCXN0cnVjdCBlbmV0Y19wcml2ICpwcml2ID0gZGV2X2dldF9wcml2KGRldik7Ci0JY29u
c3QgY2hhciAqaWZfc3RyOwotCi0JcHJpdi0+aWZfdHlwZSA9IFBIWV9JTlRFUkZBQ0VfTU9ERV9O
T05FOwogCiAJLyogcmVnaXN0ZXIgaW50ZXJuYWwgTURJTyBmb3IgZGVidWcgcHVycG9zZXMgKi8K
IAlpZiAoZW5ldGNfcmVhZF9wb3J0KHByaXYsIEVORVRDX1BDQVBSMCkgJiBFTkVUQ19QQ0FQUk9f
TURJTykgewpAQCAtMjc5LDE0ICsyNzYsMTIgQEAgc3RhdGljIHZvaWQgZW5ldGNfc3RhcnRfcGNz
KHN0cnVjdCB1ZGV2aWNlICpkZXYpCiAJCXJldHVybjsKIAl9CiAKLQlpZl9zdHIgPSBvZm5vZGVf
cmVhZF9zdHJpbmcoZGV2X29mbm9kZShkZXYpLCAicGh5LW1vZGUiKTsKLQlpZiAoaWZfc3RyKQot
CQlwcml2LT5pZl90eXBlID0gcGh5X2dldF9pbnRlcmZhY2VfYnlfbmFtZShpZl9zdHIpOwotCWVs
c2UKKwlwcml2LT5pZl90eXBlID0gZGV2X3JlYWRfcGh5X21vZGUoZGV2KTsKKwlpZiAocHJpdi0+
aWZfdHlwZSA9PSBQSFlfSU5URVJGQUNFX01PREVfTk9ORSkgewogCQllbmV0Y19kYmcoZGV2LAog
CQkJICAicGh5LW1vZGUgcHJvcGVydHkgbm90IGZvdW5kLCBkZWZhdWx0aW5nIHRvIFNHTUlJXG4i
KTsKLQlpZiAocHJpdi0+aWZfdHlwZSA8IDApCi0JCXByaXYtPmlmX3R5cGUgPSBQSFlfSU5URVJG
QUNFX01PREVfTk9ORTsKKwkJcHJpdi0+aWZfdHlwZSA9IFBIWV9JTlRFUkZBQ0VfTU9ERV9TR01J
STsKKwl9CiAKIAlzd2l0Y2ggKHByaXYtPmlmX3R5cGUpIHsKIAljYXNlIFBIWV9JTlRFUkZBQ0Vf
TU9ERV9TR01JSToKZGlmZiAtLWdpdCBhL2RyaXZlcnMvbmV0L2Z0Z21hYzEwMC5jIGIvZHJpdmVy
cy9uZXQvZnRnbWFjMTAwLmMKaW5kZXggYWE3MTlkMjk1Zi4uNjI2YzI3ZDdiZiAxMDA2NDQKLS0t
IGEvZHJpdmVycy9uZXQvZnRnbWFjMTAwLmMKKysrIGIvZHJpdmVycy9uZXQvZnRnbWFjMTAwLmMK
QEAgLTU0OSwxNyArNTQ5LDEyIEBAIHN0YXRpYyBpbnQgZnRnbWFjMTAwX29mX3RvX3BsYXQoc3Ry
dWN0IHVkZXZpY2UgKmRldikKIHsKIAlzdHJ1Y3QgZXRoX3BkYXRhICpwZGF0YSA9IGRldl9nZXRf
cGxhdChkZXYpOwogCXN0cnVjdCBmdGdtYWMxMDBfZGF0YSAqcHJpdiA9IGRldl9nZXRfcHJpdihk
ZXYpOwotCWNvbnN0IGNoYXIgKnBoeV9tb2RlOwogCiAJcGRhdGEtPmlvYmFzZSA9IGRldl9yZWFk
X2FkZHIoZGV2KTsKLQlwZGF0YS0+cGh5X2ludGVyZmFjZSA9IC0xOwotCXBoeV9tb2RlID0gZGV2
X3JlYWRfc3RyaW5nKGRldiwgInBoeS1tb2RlIik7Ci0JaWYgKHBoeV9tb2RlKQotCQlwZGF0YS0+
cGh5X2ludGVyZmFjZSA9IHBoeV9nZXRfaW50ZXJmYWNlX2J5X25hbWUocGh5X21vZGUpOwotCWlm
IChwZGF0YS0+cGh5X2ludGVyZmFjZSA9PSAtMSkgewotCQlkZXZfZXJyKGRldiwgIkludmFsaWQg
UEhZIGludGVyZmFjZSAnJXMnXG4iLCBwaHlfbW9kZSk7CisKKwlwZGF0YS0+cGh5X2ludGVyZmFj
ZSA9IGRldl9yZWFkX3BoeV9tb2RlKGRldik7CisJaWYgKHBkYXRhLT5waHlfaW50ZXJmYWNlID09
IFBIWV9JTlRFUkZBQ0VfTU9ERV9OT05FKQogCQlyZXR1cm4gLUVJTlZBTDsKLQl9CiAKIAlwZGF0
YS0+bWF4X3NwZWVkID0gZGV2X3JlYWRfdTMyX2RlZmF1bHQoZGV2LCAibWF4LXNwZWVkIiwgMCk7
CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvbmV0L2hpZ21hY3YzMDAuYyBiL2RyaXZlcnMvbmV0L2hp
Z21hY3YzMDAuYwppbmRleCBhYTc5ZDZlZGE4Li5jZThmMmRmZDA5IDEwMDY0NAotLS0gYS9kcml2
ZXJzL25ldC9oaWdtYWN2MzAwLmMKKysrIGIvZHJpdmVycy9uZXQvaGlnbWFjdjMwMC5jCkBAIC01
NjEsMTkgKzU2MSwxNCBAQCBzdGF0aWMgaW50IGhpZ21hY19yZW1vdmUoc3RydWN0IHVkZXZpY2Ug
KmRldikKIHN0YXRpYyBpbnQgaGlnbWFjX29mX3RvX3BsYXQoc3RydWN0IHVkZXZpY2UgKmRldikK
IHsKIAlzdHJ1Y3QgaGlnbWFjX3ByaXYgKnByaXYgPSBkZXZfZ2V0X3ByaXYoZGV2KTsKLQlpbnQg
cGh5aW50ZiA9IFBIWV9JTlRFUkZBQ0VfTU9ERV9OT05FOwotCWNvbnN0IGNoYXIgKnBoeV9tb2Rl
OwogCW9mbm9kZSBwaHlfbm9kZTsKIAogCXByaXYtPmJhc2UgPSBkZXZfcmVtYXBfYWRkcl9pbmRl
eChkZXYsIDApOwogCXByaXYtPm1hY2lmX2N0cmwgPSBkZXZfcmVtYXBfYWRkcl9pbmRleChkZXYs
IDEpOwogCi0JcGh5X21vZGUgPSBkZXZfcmVhZF9zdHJpbmcoZGV2LCAicGh5LW1vZGUiKTsKLQlp
ZiAocGh5X21vZGUpCi0JCXBoeWludGYgPSBwaHlfZ2V0X2ludGVyZmFjZV9ieV9uYW1lKHBoeV9t
b2RlKTsKLQlpZiAocGh5aW50ZiA9PSBQSFlfSU5URVJGQUNFX01PREVfTk9ORSkKKwlwcml2LT5w
aHlpbnRmID0gZGV2X3JlYWRfcGh5X21vZGUoZGV2KTsKKwlpZiAocHJpdi0+cGh5aW50ZiA9PSBQ
SFlfSU5URVJGQUNFX01PREVfTk9ORSkKIAkJcmV0dXJuIC1FTk9ERVY7Ci0JcHJpdi0+cGh5aW50
ZiA9IHBoeWludGY7CiAKIAlwaHlfbm9kZSA9IGRldl9yZWFkX3N1Ym5vZGUoZGV2LCAicGh5Iik7
CiAJaWYgKCFvZm5vZGVfdmFsaWQocGh5X25vZGUpKSB7CmRpZmYgLS1naXQgYS9kcml2ZXJzL25l
dC9sZHBhYV9ldGgvbGRwYWFfZXRoLmMgYi9kcml2ZXJzL25ldC9sZHBhYV9ldGgvbGRwYWFfZXRo
LmMKaW5kZXggNzI1MTczZjYyNy4uYzc3NTU5OGI5MSAxMDA2NDQKLS0tIGEvZHJpdmVycy9uZXQv
bGRwYWFfZXRoL2xkcGFhX2V0aC5jCisrKyBiL2RyaXZlcnMvbmV0L2xkcGFhX2V0aC9sZHBhYV9l
dGguYwpAQCAtMTEyMCwzMSArMTEyMCwxNCBAQCBzdGF0aWMgdWludDMyX3QgbGRwYWFfZXRoX2dl
dF9kcG1hY19pZChzdHJ1Y3QgdWRldmljZSAqZGV2KQogCXJldHVybiBmZHRkZWNfZ2V0X3VpbnQo
Z2QtPmZkdF9ibG9iLCBwb3J0X25vZGUsICJyZWciLCAtMSk7CiB9CiAKLXN0YXRpYyBjb25zdCBj
aGFyICpsZHBhYV9ldGhfZ2V0X3BoeV9tb2RlX3N0cihzdHJ1Y3QgdWRldmljZSAqZGV2KQotewot
CWludCBwb3J0X25vZGUgPSBkZXZfb2Zfb2Zmc2V0KGRldik7Ci0JY29uc3QgY2hhciAqcGh5X21v
ZGVfc3RyOwotCi0JcGh5X21vZGVfc3RyID0gZmR0X2dldHByb3AoZ2QtPmZkdF9ibG9iLCBwb3J0
X25vZGUsCi0JCQkJICAgInBoeS1jb25uZWN0aW9uLXR5cGUiLCBOVUxMKTsKLQlpZiAocGh5X21v
ZGVfc3RyKQotCQlyZXR1cm4gcGh5X21vZGVfc3RyOwotCi0JcGh5X21vZGVfc3RyID0gZmR0X2dl
dHByb3AoZ2QtPmZkdF9ibG9iLCBwb3J0X25vZGUsICJwaHktbW9kZSIsIE5VTEwpOwotCXJldHVy
biBwaHlfbW9kZV9zdHI7Ci19Ci0KIHN0YXRpYyBpbnQgbGRwYWFfZXRoX2JpbmQoc3RydWN0IHVk
ZXZpY2UgKmRldikKIHsKLQljb25zdCBjaGFyICpwaHlfbW9kZV9zdHIgPSBOVUxMOwogCXVpbnQz
Ml90IGRwbWFjX2lkOwogCWNoYXIgZXRoX25hbWVbMTZdOwogCWludCBwaHlfbW9kZSA9IC0xOwog
Ci0JcGh5X21vZGVfc3RyID0gbGRwYWFfZXRoX2dldF9waHlfbW9kZV9zdHIoZGV2KTsKLQlpZiAo
cGh5X21vZGVfc3RyKQotCQlwaHlfbW9kZSA9IHBoeV9nZXRfaW50ZXJmYWNlX2J5X25hbWUocGh5
X21vZGVfc3RyKTsKLQlpZiAocGh5X21vZGUgPT0gLTEpIHsKKwlwaHlfbW9kZSA9IGRldl9yZWFk
X3BoeV9tb2RlKGRldik7CisJaWYgKHBoeV9tb2RlID09IFBIWV9JTlRFUkZBQ0VfTU9ERV9OT05F
KSB7CiAJCWRldl9lcnIoZGV2LCAiaW5jb3JyZWN0IHBoeSBtb2RlXG4iKTsKIAkJcmV0dXJuIC1F
SU5WQUw7CiAJfQpAQCAtMTE1NSw3ICsxMTM4LDggQEAgc3RhdGljIGludCBsZHBhYV9ldGhfYmlu
ZChzdHJ1Y3QgdWRldmljZSAqZGV2KQogCQlyZXR1cm4gLUVJTlZBTDsKIAl9CiAKLQlzcHJpbnRm
KGV0aF9uYW1lLCAiRFBNQUMlZEAlcyIsIGRwbWFjX2lkLCBwaHlfbW9kZV9zdHIpOworCXNwcmlu
dGYoZXRoX25hbWUsICJEUE1BQyVkQCVzIiwgZHBtYWNfaWQsCisJCXBoeV9zdHJpbmdfZm9yX2lu
dGVyZmFjZShwaHlfbW9kZSkpOwogCWRldmljZV9zZXRfbmFtZShkZXYsIGV0aF9uYW1lKTsKIAog
CXJldHVybiAwOwpAQCAtMTE2NCwxMSArMTE0OCw5IEBAIHN0YXRpYyBpbnQgbGRwYWFfZXRoX2Jp
bmQoc3RydWN0IHVkZXZpY2UgKmRldikKIHN0YXRpYyBpbnQgbGRwYWFfZXRoX29mX3RvX3BsYXQo
c3RydWN0IHVkZXZpY2UgKmRldikKIHsKIAlzdHJ1Y3QgbGRwYWFfZXRoX3ByaXYgKnByaXYgPSBk
ZXZfZ2V0X3ByaXYoZGV2KTsKLQljb25zdCBjaGFyICpwaHlfbW9kZV9zdHI7CiAKIAlwcml2LT5k
cG1hY19pZCA9IGxkcGFhX2V0aF9nZXRfZHBtYWNfaWQoZGV2KTsKLQlwaHlfbW9kZV9zdHIgPSBs
ZHBhYV9ldGhfZ2V0X3BoeV9tb2RlX3N0cihkZXYpOwotCXByaXYtPnBoeV9tb2RlID0gcGh5X2dl
dF9pbnRlcmZhY2VfYnlfbmFtZShwaHlfbW9kZV9zdHIpOworCXByaXYtPnBoeV9tb2RlID0gZGV2
X3JlYWRfcGh5X21vZGUoZGV2KTsKIAogCXJldHVybiAwOwogfQpkaWZmIC0tZ2l0IGEvZHJpdmVy
cy9uZXQvbWFjYi5jIGIvZHJpdmVycy9uZXQvbWFjYi5jCmluZGV4IDM3ZWVkNTlhNjkuLjMxN2Iz
ODBlOGYgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvbmV0L21hY2IuYworKysgYi9kcml2ZXJzL25ldC9t
YWNiLmMKQEAgLTEzNjAsMTcgKzEzNjAsMTEgQEAgc3RhdGljIGludCBtYWNiX2V0aF9wcm9iZShz
dHJ1Y3QgdWRldmljZSAqZGV2KQogCXN0cnVjdCBldGhfcGRhdGEgKnBkYXRhID0gZGV2X2dldF9w
bGF0KGRldik7CiAJc3RydWN0IG1hY2JfZGV2aWNlICptYWNiID0gZGV2X2dldF9wcml2KGRldik7
CiAJc3RydWN0IG9mbm9kZV9waGFuZGxlX2FyZ3MgcGhhbmRsZV9hcmdzOwotCWNvbnN0IGNoYXIg
KnBoeV9tb2RlOwogCWludCByZXQ7CiAKLQlwaHlfbW9kZSA9IGRldl9yZWFkX3Byb3AoZGV2LCAi
cGh5LW1vZGUiLCBOVUxMKTsKLQotCWlmIChwaHlfbW9kZSkKLQkJbWFjYi0+cGh5X2ludGVyZmFj
ZSA9IHBoeV9nZXRfaW50ZXJmYWNlX2J5X25hbWUocGh5X21vZGUpOwotCWlmIChtYWNiLT5waHlf
aW50ZXJmYWNlID09IC0xKSB7Ci0JCWRlYnVnKCIlczogSW52YWxpZCBQSFkgaW50ZXJmYWNlICcl
cydcbiIsIF9fZnVuY19fLCBwaHlfbW9kZSk7CisJbWFjYi0+cGh5X2ludGVyZmFjZSA9IGRldl9y
ZWFkX3BoeV9tb2RlKGRldik7CisJaWYgKG1hY2ItPnBoeV9pbnRlcmZhY2UgPT0gUEhZX0lOVEVS
RkFDRV9NT0RFX05PTkUpCiAJCXJldHVybiAtRUlOVkFMOwotCX0KIAogCS8qIFJlYWQgcGh5YWRk
ciBmcm9tIERUICovCiAJaWYgKCFkZXZfcmVhZF9waGFuZGxlX3dpdGhfYXJncyhkZXYsICJwaHkt
aGFuZGxlIiwgTlVMTCwgMCwgMCwKZGlmZiAtLWdpdCBhL2RyaXZlcnMvbmV0L210NzYyMC1ldGgu
YyBiL2RyaXZlcnMvbmV0L210NzYyMC1ldGguYwppbmRleCAyMjIyNTBkNTJhLi4yNGZjYjkzNzNm
IDEwMDY0NAotLS0gYS9kcml2ZXJzL25ldC9tdDc2MjAtZXRoLmMKKysrIGIvZHJpdmVycy9uZXQv
bXQ3NjIwLWV0aC5jCkBAIC0xMDQ4LDMzICsxMDQ4LDIwIEBAIHN0YXRpYyBpbnQgbXQ3NjIwX2V0
aF9wYXJzZV9nc3dfcG9ydChzdHJ1Y3QgbXQ3NjIwX2V0aF9wcml2ICpwcml2LCB1MzIgaWR4LAog
CQkJCSAgICAgb2Zub2RlIG5vZGUpCiB7CiAJb2Zub2RlIHN1Ym5vZGU7Ci0JY29uc3QgY2hhciAq
c3RyOwotCWludCBtb2RlLCBzcGVlZCwgcmV0OworCWludCBzcGVlZCwgcmV0OwogCXUzMiBwaHlf
YWRkcjsKIAotCXN0ciA9IG9mbm9kZV9yZWFkX3N0cmluZyhub2RlLCAicGh5LW1vZGUiKTsKLQlp
ZiAoc3RyKSB7Ci0JCW1vZGUgPSBwaHlfZ2V0X2ludGVyZmFjZV9ieV9uYW1lKHN0cik7Ci0JCWlm
IChtb2RlIDwgMCkgewotCQkJZGV2X2Vycihwcml2LT5kZXYsICJtdDc2MjBfZXRoOiBpbnZhbGlk
IHBoeS1tb2RlXG4iKTsKLQkJCXJldHVybiAtRUlOVkFMOwotCQl9Ci0KLQkJc3dpdGNoIChtb2Rl
KSB7Ci0JCWNhc2UgUEhZX0lOVEVSRkFDRV9NT0RFX01JSToKLQkJY2FzZSBQSFlfSU5URVJGQUNF
X01PREVfUk1JSToKLQkJY2FzZSBQSFlfSU5URVJGQUNFX01PREVfUkdNSUk6Ci0JCWNhc2UgUEhZ
X0lOVEVSRkFDRV9NT0RFX05PTkU6Ci0JCQlicmVhazsKLQkJZGVmYXVsdDoKLQkJCWRldl9lcnIo
cHJpdi0+ZGV2LAotCQkJCSJtdDc2MjBfZXRoOiB1bnN1cHBvcnRlZCBwaHktbW9kZVxuIik7Ci0J
CQlyZXR1cm4gLUVOT1RTVVBQOwotCQl9CisJcHJpdi0+cG9ydF9jZmdbaWR4XS5tb2RlID0gb2Zu
b2RlX3JlYWRfcGh5X21vZGUobm9kZSk7CiAKLQkJcHJpdi0+cG9ydF9jZmdbaWR4XS5tb2RlID0g
bW9kZTsKLQl9IGVsc2UgewotCQlwcml2LT5wb3J0X2NmZ1tpZHhdLm1vZGUgPSBQSFlfSU5URVJG
QUNFX01PREVfTk9ORTsKKwlzd2l0Y2ggKHByaXYtPnBvcnRfY2ZnW2lkeF0ubW9kZSkgeworCWNh
c2UgUEhZX0lOVEVSRkFDRV9NT0RFX01JSToKKwljYXNlIFBIWV9JTlRFUkZBQ0VfTU9ERV9STUlJ
OgorCWNhc2UgUEhZX0lOVEVSRkFDRV9NT0RFX1JHTUlJOgorCWNhc2UgUEhZX0lOVEVSRkFDRV9N
T0RFX05PTkU6CisJCWJyZWFrOworCWRlZmF1bHQ6CisJCWRldl9lcnIocHJpdi0+ZGV2LCAibXQ3
NjIwX2V0aDogdW5zdXBwb3J0ZWQgcGh5LW1vZGVcbiIpOworCQlyZXR1cm4gLUVOT1RTVVBQOwog
CX0KIAogCXN1Ym5vZGUgPSBvZm5vZGVfZmluZF9zdWJub2RlKG5vZGUsICJmaXhlZC1saW5rIik7
CmRpZmYgLS1naXQgYS9kcml2ZXJzL25ldC9tdGtfZXRoLmMgYi9kcml2ZXJzL25ldC9tdGtfZXRo
LmMKaW5kZXggMjZmMDI4NDdhMi4uZDYwNjVkYjVmYiAxMDA2NDQKLS0tIGEvZHJpdmVycy9uZXQv
bXRrX2V0aC5jCisrKyBiL2RyaXZlcnMvbmV0L210a19ldGguYwpAQCAtMTQ0NywxMSArMTQ0Nyw5
IEBAIHN0YXRpYyBpbnQgbXRrX2V0aF9vZl90b19wbGF0KHN0cnVjdCB1ZGV2aWNlICpkZXYpCiAJ
cHJpdi0+Z21hY19pZCA9IGRldl9yZWFkX3UzMl9kZWZhdWx0KGRldiwgIm1lZGlhdGVrLGdtYWMt
aWQiLCAwKTsKIAogCS8qIEludGVyZmFjZSBtb2RlIGlzIHJlcXVpcmVkICovCi0Jc3RyID0gZGV2
X3JlYWRfc3RyaW5nKGRldiwgInBoeS1tb2RlIik7Ci0JaWYgKHN0cikgewotCQlwZGF0YS0+cGh5
X2ludGVyZmFjZSA9IHBoeV9nZXRfaW50ZXJmYWNlX2J5X25hbWUoc3RyKTsKLQkJcHJpdi0+cGh5
X2ludGVyZmFjZSA9IHBkYXRhLT5waHlfaW50ZXJmYWNlOwotCX0gZWxzZSB7CisJcGRhdGEtPnBo
eV9pbnRlcmZhY2UgPSBkZXZfcmVhZF9waHlfbW9kZShkZXYpOworCXByaXYtPnBoeV9pbnRlcmZh
Y2UgPSBwZGF0YS0+cGh5X2ludGVyZmFjZTsKKwlpZiAocGRhdGEtPnBoeV9pbnRlcmZhY2UgPT0g
UEhZX0lOVEVSRkFDRV9NT0RFX05PTkUpIHsKIAkJcHJpbnRmKCJlcnJvcjogcGh5LW1vZGUgaXMg
bm90IHNldFxuIik7CiAJCXJldHVybiAtRUlOVkFMOwogCX0KZGlmZiAtLWdpdCBhL2RyaXZlcnMv
bmV0L212Z2JlLmMgYi9kcml2ZXJzL25ldC9tdmdiZS5jCmluZGV4IDk1NGJmODYxMjEuLjMyZWMw
YjQzN2QgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvbmV0L212Z2JlLmMKKysrIGIvZHJpdmVycy9uZXQv
bXZnYmUuYwpAQCAtOTkzLDcgKzk5Myw2IEBAIHN0YXRpYyBpbnQgbXZnYmVfb2ZfdG9fcGxhdChz
dHJ1Y3QgdWRldmljZSAqZGV2KQogCXN0cnVjdCBtdmdiZV9kZXZpY2UgKmRtdmdiZSA9IGRldl9n
ZXRfcHJpdihkZXYpOwogCXZvaWQgKmJsb2IgPSAodm9pZCAqKWdkLT5mZHRfYmxvYjsKIAlpbnQg
bm9kZSA9IGRldl9vZl9vZmZzZXQoZGV2KTsKLQljb25zdCBjaGFyICpwaHlfbW9kZTsKIAlpbnQg
Zmxfbm9kZTsKIAlpbnQgcG5vZGU7CiAJdW5zaWduZWQgbG9uZyBhZGRyOwpAQCAtMTAwNSwxMCAr
MTAwNCw4IEBAIHN0YXRpYyBpbnQgbXZnYmVfb2ZfdG9fcGxhdChzdHJ1Y3QgdWRldmljZSAqZGV2
KQogCQkJCQkgICAgICAibWFydmVsbCxraXJrd29vZC1ldGgtcG9ydCIpOwogCiAJLyogR2V0IHBo
eS1tb2RlIC8gcGh5X2ludGVyZmFjZSBmcm9tIERUICovCi0JcGh5X21vZGUgPSBmZHRfZ2V0cHJv
cChnZC0+ZmR0X2Jsb2IsIHBub2RlLCAicGh5LW1vZGUiLCBOVUxMKTsKLQlpZiAocGh5X21vZGUp
Ci0JCXBkYXRhLT5waHlfaW50ZXJmYWNlID0gcGh5X2dldF9pbnRlcmZhY2VfYnlfbmFtZShwaHlf
bW9kZSk7Ci0JZWxzZQorCXBkYXRhLT5waHlfaW50ZXJmYWNlID0gZGV2X3JlYWRfcGh5X21vZGUo
ZGV2KTsKKwlpZiAocGRhdGEtPnBoeV9pbnRlcmZhY2UgPT0gUEhZX0lOVEVSRkFDRV9NT0RFX05P
TkUpCiAJCXBkYXRhLT5waHlfaW50ZXJmYWNlID0gUEhZX0lOVEVSRkFDRV9NT0RFX0dNSUk7CiAK
IAlkbXZnYmUtPnBoeV9pbnRlcmZhY2UgPSBwZGF0YS0+cGh5X2ludGVyZmFjZTsKZGlmZiAtLWdp
dCBhL2RyaXZlcnMvbmV0L212bmV0YS5jIGIvZHJpdmVycy9uZXQvbXZuZXRhLmMKaW5kZXggNGE0
MjY4YzJiMi4uZDMxYjk2YTlkOCAxMDA2NDQKLS0tIGEvZHJpdmVycy9uZXQvbXZuZXRhLmMKKysr
IGIvZHJpdmVycy9uZXQvbXZuZXRhLmMKQEAgLTE3OTksMjAgKzE3OTksMTMgQEAgc3RhdGljIGNv
bnN0IHN0cnVjdCBldGhfb3BzIG12bmV0YV9vcHMgPSB7CiBzdGF0aWMgaW50IG12bmV0YV9vZl90
b19wbGF0KHN0cnVjdCB1ZGV2aWNlICpkZXYpCiB7CiAJc3RydWN0IGV0aF9wZGF0YSAqcGRhdGEg
PSBkZXZfZ2V0X3BsYXQoZGV2KTsKLQljb25zdCBjaGFyICpwaHlfbW9kZTsKIAogCXBkYXRhLT5p
b2Jhc2UgPSBkZXZfcmVhZF9hZGRyKGRldik7CiAKIAkvKiBHZXQgcGh5LW1vZGUgLyBwaHlfaW50
ZXJmYWNlIGZyb20gRFQgKi8KLQlwZGF0YS0+cGh5X2ludGVyZmFjZSA9IC0xOwotCXBoeV9tb2Rl
ID0gZmR0X2dldHByb3AoZ2QtPmZkdF9ibG9iLCBkZXZfb2Zfb2Zmc2V0KGRldiksICJwaHktbW9k
ZSIsCi0JCQkgICAgICAgTlVMTCk7Ci0JaWYgKHBoeV9tb2RlKQotCQlwZGF0YS0+cGh5X2ludGVy
ZmFjZSA9IHBoeV9nZXRfaW50ZXJmYWNlX2J5X25hbWUocGh5X21vZGUpOwotCWlmIChwZGF0YS0+
cGh5X2ludGVyZmFjZSA9PSAtMSkgewotCQlkZWJ1ZygiJXM6IEludmFsaWQgUEhZIGludGVyZmFj
ZSAnJXMnXG4iLCBfX2Z1bmNfXywgcGh5X21vZGUpOworCXBkYXRhLT5waHlfaW50ZXJmYWNlID0g
ZGV2X3JlYWRfcGh5X21vZGUoZGV2KTsKKwlpZiAocGRhdGEtPnBoeV9pbnRlcmZhY2UgPT0gUEhZ
X0lOVEVSRkFDRV9NT0RFX05PTkUpCiAJCXJldHVybiAtRUlOVkFMOwotCX0KIAogCXJldHVybiAw
OwogfQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9uZXQvbXZwcDIuYyBiL2RyaXZlcnMvbmV0L212cHAy
LmMKaW5kZXggNGMwYTdiMGE5Zi4uZGZkZGFjMTgwZiAxMDA2NDQKLS0tIGEvZHJpdmVycy9uZXQv
bXZwcDIuYworKysgYi9kcml2ZXJzL25ldC9tdnBwMi5jCkBAIC00Nzg2LDExICs0Nzg2LDkgQEAg
c3RhdGljIGludCBtdnBwMl9wb3J0X2luaXQoc3RydWN0IHVkZXZpY2UgKmRldiwgc3RydWN0IG12
cHAyX3BvcnQgKnBvcnQpCiBzdGF0aWMgaW50IHBoeV9pbmZvX3BhcnNlKHN0cnVjdCB1ZGV2aWNl
ICpkZXYsIHN0cnVjdCBtdnBwMl9wb3J0ICpwb3J0KQogewogCWludCBwb3J0X25vZGUgPSBkZXZf
b2Zfb2Zmc2V0KGRldik7Ci0JY29uc3QgY2hhciAqcGh5X21vZGVfc3RyOwogCWludCBwaHlfbm9k
ZTsKIAl1MzIgaWQ7CiAJdTMyIHBoeWFkZHIgPSAwOwotCWludCBwaHlfbW9kZSA9IC0xOwogCWlu
dCBmaXhlZF9saW5rID0gMDsKIAlpbnQgcmV0OwogCkBAIC00ODIxLDEwICs0ODE5LDggQEAgc3Rh
dGljIGludCBwaHlfaW5mb19wYXJzZShzdHJ1Y3QgdWRldmljZSAqZGV2LCBzdHJ1Y3QgbXZwcDJf
cG9ydCAqcG9ydCkKIAkJcGh5YWRkciA9IFBIWV9NQVhfQUREUjsKIAl9CiAKLQlwaHlfbW9kZV9z
dHIgPSBmZHRfZ2V0cHJvcChnZC0+ZmR0X2Jsb2IsIHBvcnRfbm9kZSwgInBoeS1tb2RlIiwgTlVM
TCk7Ci0JaWYgKHBoeV9tb2RlX3N0cikKLQkJcGh5X21vZGUgPSBwaHlfZ2V0X2ludGVyZmFjZV9i
eV9uYW1lKHBoeV9tb2RlX3N0cik7Ci0JaWYgKHBoeV9tb2RlID09IC0xKSB7CisJcG9ydC0+cGh5
X2ludGVyZmFjZSA9IGRldl9yZWFkX3BoeV9tb2RlKGRldik7CisJaWYgKHBvcnQtPnBoeV9pbnRl
cmZhY2UgPT0gUEhZX0lOVEVSRkFDRV9NT0RFX05PTkUpIHsKIAkJZGV2X2VycihkZXYsICJpbmNv
cnJlY3QgcGh5IG1vZGVcbiIpOwogCQlyZXR1cm4gLUVJTlZBTDsKIAl9CkBAIC00ODQ3LDcgKzQ4
NDMsNiBAQCBzdGF0aWMgaW50IHBoeV9pbmZvX3BhcnNlKHN0cnVjdCB1ZGV2aWNlICpkZXYsIHN0
cnVjdCBtdnBwMl9wb3J0ICpwb3J0KQogCQlwb3J0LT5maXJzdF9yeHEgPSBwb3J0LT5pZCAqIHJ4
cV9udW1iZXI7CiAJZWxzZQogCQlwb3J0LT5maXJzdF9yeHEgPSBwb3J0LT5pZCAqIHBvcnQtPnBy
aXYtPm1heF9wb3J0X3J4cXM7Ci0JcG9ydC0+cGh5X2ludGVyZmFjZSA9IHBoeV9tb2RlOwogCXBv
cnQtPnBoeWFkZHIgPSBwaHlhZGRyOwogCiAJcmV0dXJuIDA7CmRpZmYgLS1naXQgYS9kcml2ZXJz
L25ldC9waHkvcGh5LmMgYi9kcml2ZXJzL25ldC9waHkvcGh5LmMKaW5kZXggZmU2ZGJkYWVlNC4u
NDEwOTY3NmE1MSAxMDA2NDQKLS0tIGEvZHJpdmVycy9uZXQvcGh5L3BoeS5jCisrKyBiL2RyaXZl
cnMvbmV0L3BoeS9waHkuYwpAQCAtOTgyLDI1ICs5ODIsMTYgQEAgc3RhdGljIHN0cnVjdCBwaHlf
ZGV2aWNlICpwaHlfY29ubmVjdF9nbWlpMnJnbWlpKHN0cnVjdCBtaWlfZGV2ICpidXMsCiAgKi8K
IHN0cnVjdCBwaHlfZGV2aWNlICpmaXhlZF9waHlfY3JlYXRlKG9mbm9kZSBub2RlKQogewotCXBo
eV9pbnRlcmZhY2VfdCBpbnRlcmZhY2UgPSBQSFlfSU5URVJGQUNFX01PREVfTk9ORTsKIAlzdHJ1
Y3QgcGh5X2RldmljZSAqcGh5ZGV2OwotCWNvbnN0IGNoYXIgKmlmX3N0cjsKIAlvZm5vZGUgc3Vi
bm9kZTsKIAotCWlmX3N0ciA9IG9mbm9kZV9yZWFkX3N0cmluZyhub2RlLCAicGh5LW1vZGUiKTsK
LQlpZiAoIWlmX3N0cikgewotCQlpZl9zdHIgPSBvZm5vZGVfcmVhZF9zdHJpbmcobm9kZSwgInBo
eS1jb25uZWN0aW9uLXR5cGUiKTsKLQl9Ci0JaWYgKGlmX3N0cikgewotCQlpbnRlcmZhY2UgPSBw
aHlfZ2V0X2ludGVyZmFjZV9ieV9uYW1lKGlmX3N0cik7Ci0JfQotCiAJc3Vibm9kZSA9IG9mbm9k
ZV9maW5kX3N1Ym5vZGUobm9kZSwgImZpeGVkLWxpbmsiKTsKIAlpZiAoIW9mbm9kZV92YWxpZChz
dWJub2RlKSkgewogCQlyZXR1cm4gTlVMTDsKIAl9CiAKLQlwaHlkZXYgPSBwaHlfZGV2aWNlX2Ny
ZWF0ZShOVUxMLCAwLCBQSFlfRklYRURfSUQsIGZhbHNlLCBpbnRlcmZhY2UpOworCXBoeWRldiA9
IHBoeV9kZXZpY2VfY3JlYXRlKE5VTEwsIDAsIFBIWV9GSVhFRF9JRCwgZmFsc2UsCisJCQkJICAg
b2Zub2RlX3JlYWRfcGh5X21vZGUobm9kZSkpOwogCWlmIChwaHlkZXYpCiAJCXBoeWRldi0+bm9k
ZSA9IHN1Ym5vZGU7CiAKQEAgLTEwOTMsMTUgKzEwODQsMyBAQCBpbnQgcGh5X3NodXRkb3duKHN0
cnVjdCBwaHlfZGV2aWNlICpwaHlkZXYpCiAKIAlyZXR1cm4gMDsKIH0KLQotaW50IHBoeV9nZXRf
aW50ZXJmYWNlX2J5X25hbWUoY29uc3QgY2hhciAqc3RyKQotewotCWludCBpOwotCi0JZm9yIChp
ID0gMDsgaSA8IFBIWV9JTlRFUkZBQ0VfTU9ERV9DT1VOVDsgaSsrKSB7Ci0JCWlmICghc3RyY21w
KHN0ciwgcGh5X2ludGVyZmFjZV9zdHJpbmdzW2ldKSkKLQkJCXJldHVybiBpOwotCX0KLQotCXJl
dHVybiAtMTsKLX0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvbmV0L3BpYzMyX2V0aC5jIGIvZHJpdmVy
cy9uZXQvcGljMzJfZXRoLmMKaW5kZXggNWE2NzhkMWNmOS4uMDNlYjUxZTUxZCAxMDA2NDQKLS0t
IGEvZHJpdmVycy9uZXQvcGljMzJfZXRoLmMKKysrIGIvZHJpdmVycy9uZXQvcGljMzJfZXRoLmMK
QEAgLTUzNCw3ICs1MzQsNiBAQCBzdGF0aWMgaW50IHBpYzMyX2V0aF9wcm9iZShzdHJ1Y3QgdWRl
dmljZSAqZGV2KQogewogCXN0cnVjdCBldGhfcGRhdGEgKnBkYXRhID0gZGV2X2dldF9wbGF0KGRl
dik7CiAJc3RydWN0IHBpYzMyZXRoX2RldiAqcHJpdiA9IGRldl9nZXRfcHJpdihkZXYpOwotCWNv
bnN0IGNoYXIgKnBoeV9tb2RlOwogCXZvaWQgX19pb21lbSAqaW9iYXNlOwogCWZkdF9hZGRyX3Qg
YWRkcjsKIAlmZHRfc2l6ZV90IHNpemU7CkBAIC01NTAsMTUgKzU0OSw5IEBAIHN0YXRpYyBpbnQg
cGljMzJfZXRoX3Byb2JlKHN0cnVjdCB1ZGV2aWNlICpkZXYpCiAJcGRhdGEtPmlvYmFzZSA9IChw
aHlzX2FkZHJfdClhZGRyOwogCiAJLyogZ2V0IHBoeSBtb2RlICovCi0JcGRhdGEtPnBoeV9pbnRl
cmZhY2UgPSAtMTsKLQlwaHlfbW9kZSA9IGZkdF9nZXRwcm9wKGdkLT5mZHRfYmxvYiwgZGV2X29m
X29mZnNldChkZXYpLCAicGh5LW1vZGUiLAotCQkJICAgICAgIE5VTEwpOwotCWlmIChwaHlfbW9k
ZSkKLQkJcGRhdGEtPnBoeV9pbnRlcmZhY2UgPSBwaHlfZ2V0X2ludGVyZmFjZV9ieV9uYW1lKHBo
eV9tb2RlKTsKLQlpZiAocGRhdGEtPnBoeV9pbnRlcmZhY2UgPT0gLTEpIHsKLQkJZGVidWcoIiVz
OiBJbnZhbGlkIFBIWSBpbnRlcmZhY2UgJyVzJ1xuIiwgX19mdW5jX18sIHBoeV9tb2RlKTsKKwlw
ZGF0YS0+cGh5X2ludGVyZmFjZSA9IGRldl9yZWFkX3BoeV9tb2RlKGRldik7CisJaWYgKHBkYXRh
LT5waHlfaW50ZXJmYWNlID09IFBIWV9JTlRFUkZBQ0VfTU9ERV9OT05FKQogCQlyZXR1cm4gLUVJ
TlZBTDsKLQl9CiAKIAkvKiBnZXQgcGh5IGFkZHIgKi8KIAlvZmZzZXQgPSBmZHRkZWNfbG9va3Vw
X3BoYW5kbGUoZ2QtPmZkdF9ibG9iLCBkZXZfb2Zfb2Zmc2V0KGRldiksCmRpZmYgLS1naXQgYS9k
cml2ZXJzL25ldC9xZS9kbV9xZV91ZWMuYyBiL2RyaXZlcnMvbmV0L3FlL2RtX3FlX3VlYy5jCmlu
ZGV4IGExMmM4Y2QyYWMuLjVhNjZkNzI2Y2QgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvbmV0L3FlL2Rt
X3FlX3VlYy5jCisrKyBiL2RyaXZlcnMvbmV0L3FlL2RtX3FlX3VlYy5jCkBAIC0xMTMzLDE5ICsx
MTMzLDEyIEBAIHN0YXRpYyBpbnQgcWVfdWVjX3JlbW92ZShzdHJ1Y3QgdWRldmljZSAqZGV2KQog
c3RhdGljIGludCBxZV91ZWNfb2ZfdG9fcGxhdChzdHJ1Y3QgdWRldmljZSAqZGV2KQogewogCXN0
cnVjdCBldGhfcGRhdGEgKnBkYXRhID0gZGV2X2dldF9wbGF0KGRldik7Ci0JY29uc3QgY2hhciAq
cGh5X21vZGU7CiAKIAlwZGF0YS0+aW9iYXNlID0gKHBoeXNfYWRkcl90KWRldmZkdF9nZXRfYWRk
cihkZXYpOwogCi0JcGRhdGEtPnBoeV9pbnRlcmZhY2UgPSAtMTsKLQlwaHlfbW9kZSA9IGZkdF9n
ZXRwcm9wKGdkLT5mZHRfYmxvYiwgZGV2X29mX29mZnNldChkZXYpLAotCQkJICAgICAgICJwaHkt
Y29ubmVjdGlvbi10eXBlIiwgTlVMTCk7Ci0JaWYgKHBoeV9tb2RlKQotCQlwZGF0YS0+cGh5X2lu
dGVyZmFjZSA9IHBoeV9nZXRfaW50ZXJmYWNlX2J5X25hbWUocGh5X21vZGUpOwotCWlmIChwZGF0
YS0+cGh5X2ludGVyZmFjZSA9PSAtMSkgewotCQlkZWJ1ZygiJXM6IEludmFsaWQgUEhZIGludGVy
ZmFjZSAnJXMnXG4iLCBfX2Z1bmNfXywgcGh5X21vZGUpOworCXBkYXRhLT5waHlfaW50ZXJmYWNl
ID0gZGV2X3JlYWRfcGh5X21vZGUoZGV2KTsKKwlpZiAocGRhdGEtPnBoeV9pbnRlcmZhY2UgPT0g
UEhZX0lOVEVSRkFDRV9NT0RFX05PTkUpCiAJCXJldHVybiAtRUlOVkFMOwotCX0KIAogCXJldHVy
biAwOwogfQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9uZXQvcmF2Yi5jIGIvZHJpdmVycy9uZXQvcmF2
Yi5jCmluZGV4IDQwNzhkMzNiYjUuLmY2ZDM4NmJkNmIgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvbmV0
L3JhdmIuYworKysgYi9kcml2ZXJzL25ldC9yYXZiLmMKQEAgLTY3NCwyMCArNjc0LDEzIEBAIHN0
YXRpYyBjb25zdCBzdHJ1Y3QgZXRoX29wcyByYXZiX29wcyA9IHsKIGludCByYXZiX29mX3RvX3Bs
YXQoc3RydWN0IHVkZXZpY2UgKmRldikKIHsKIAlzdHJ1Y3QgZXRoX3BkYXRhICpwZGF0YSA9IGRl
dl9nZXRfcGxhdChkZXYpOwotCWNvbnN0IGNoYXIgKnBoeV9tb2RlOwogCWNvbnN0IGZkdDMyX3Qg
KmNlbGw7Ci0JaW50IHJldCA9IDA7CiAKIAlwZGF0YS0+aW9iYXNlID0gZGV2X3JlYWRfYWRkcihk
ZXYpOwotCXBkYXRhLT5waHlfaW50ZXJmYWNlID0gLTE7Ci0JcGh5X21vZGUgPSBmZHRfZ2V0cHJv
cChnZC0+ZmR0X2Jsb2IsIGRldl9vZl9vZmZzZXQoZGV2KSwgInBoeS1tb2RlIiwKLQkJCSAgICAg
ICBOVUxMKTsKLQlpZiAocGh5X21vZGUpCi0JCXBkYXRhLT5waHlfaW50ZXJmYWNlID0gcGh5X2dl
dF9pbnRlcmZhY2VfYnlfbmFtZShwaHlfbW9kZSk7Ci0JaWYgKHBkYXRhLT5waHlfaW50ZXJmYWNl
ID09IC0xKSB7Ci0JCWRlYnVnKCIlczogSW52YWxpZCBQSFkgaW50ZXJmYWNlICclcydcbiIsIF9f
ZnVuY19fLCBwaHlfbW9kZSk7CisKKwlwZGF0YS0+cGh5X2ludGVyZmFjZSA9IGRldl9yZWFkX3Bo
eV9tb2RlKGRldik7CisJaWYgKHBkYXRhLT5waHlfaW50ZXJmYWNlID09IFBIWV9JTlRFUkZBQ0Vf
TU9ERV9OT05FKQogCQlyZXR1cm4gLUVJTlZBTDsKLQl9CiAKIAlwZGF0YS0+bWF4X3NwZWVkID0g
MTAwMDsKIAljZWxsID0gZmR0X2dldHByb3AoZ2QtPmZkdF9ibG9iLCBkZXZfb2Zfb2Zmc2V0KGRl
diksICJtYXgtc3BlZWQiLCBOVUxMKTsKQEAgLTY5Niw3ICs2ODksNyBAQCBpbnQgcmF2Yl9vZl90
b19wbGF0KHN0cnVjdCB1ZGV2aWNlICpkZXYpCiAKIAlzcHJpbnRmKGJiX21paXBoeV9idXNlc1sw
XS5uYW1lLCBkZXYtPm5hbWUpOwogCi0JcmV0dXJuIHJldDsKKwlyZXR1cm4gMDsKIH0KIAogc3Rh
dGljIGNvbnN0IHN0cnVjdCB1ZGV2aWNlX2lkIHJhdmJfaWRzW10gPSB7CmRpZmYgLS1naXQgYS9k
cml2ZXJzL25ldC9zaF9ldGguYyBiL2RyaXZlcnMvbmV0L3NoX2V0aC5jCmluZGV4IDQwNTVmMDdi
MmYuLjA0YzljMmQ5NjggMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvbmV0L3NoX2V0aC5jCisrKyBiL2Ry
aXZlcnMvbmV0L3NoX2V0aC5jCkBAIC05MTUsMjAgKzkxNSwxMyBAQCBzdGF0aWMgY29uc3Qgc3Ry
dWN0IGV0aF9vcHMgc2hfZXRoZXJfb3BzID0gewogaW50IHNoX2V0aGVyX29mX3RvX3BsYXQoc3Ry
dWN0IHVkZXZpY2UgKmRldikKIHsKIAlzdHJ1Y3QgZXRoX3BkYXRhICpwZGF0YSA9IGRldl9nZXRf
cGxhdChkZXYpOwotCWNvbnN0IGNoYXIgKnBoeV9tb2RlOwogCWNvbnN0IGZkdDMyX3QgKmNlbGw7
Ci0JaW50IHJldCA9IDA7CiAKIAlwZGF0YS0+aW9iYXNlID0gZGV2X3JlYWRfYWRkcihkZXYpOwot
CXBkYXRhLT5waHlfaW50ZXJmYWNlID0gLTE7Ci0JcGh5X21vZGUgPSBmZHRfZ2V0cHJvcChnZC0+
ZmR0X2Jsb2IsIGRldl9vZl9vZmZzZXQoZGV2KSwgInBoeS1tb2RlIiwKLQkJCSAgICAgICBOVUxM
KTsKLQlpZiAocGh5X21vZGUpCi0JCXBkYXRhLT5waHlfaW50ZXJmYWNlID0gcGh5X2dldF9pbnRl
cmZhY2VfYnlfbmFtZShwaHlfbW9kZSk7Ci0JaWYgKHBkYXRhLT5waHlfaW50ZXJmYWNlID09IC0x
KSB7Ci0JCWRlYnVnKCIlczogSW52YWxpZCBQSFkgaW50ZXJmYWNlICclcydcbiIsIF9fZnVuY19f
LCBwaHlfbW9kZSk7CisKKwlwZGF0YS0+cGh5X2ludGVyZmFjZSA9IGRldl9yZWFkX3BoeV9tb2Rl
KGRldik7CisJaWYgKHBkYXRhLT5waHlfaW50ZXJmYWNlID09IFBIWV9JTlRFUkZBQ0VfTU9ERV9O
T05FKQogCQlyZXR1cm4gLUVJTlZBTDsKLQl9CiAKIAlwZGF0YS0+bWF4X3NwZWVkID0gMTAwMDsK
IAljZWxsID0gZmR0X2dldHByb3AoZ2QtPmZkdF9ibG9iLCBkZXZfb2Zfb2Zmc2V0KGRldiksICJt
YXgtc3BlZWQiLCBOVUxMKTsKQEAgLTkzNyw3ICs5MzAsNyBAQCBpbnQgc2hfZXRoZXJfb2ZfdG9f
cGxhdChzdHJ1Y3QgdWRldmljZSAqZGV2KQogCiAJc3ByaW50ZihiYl9taWlwaHlfYnVzZXNbMF0u
bmFtZSwgZGV2LT5uYW1lKTsKIAotCXJldHVybiByZXQ7CisJcmV0dXJuIDA7CiB9CiAKIHN0YXRp
YyBjb25zdCBzdHJ1Y3QgdWRldmljZV9pZCBzaF9ldGhlcl9pZHNbXSA9IHsKZGlmZiAtLWdpdCBh
L2RyaXZlcnMvbmV0L3NuaV9hdmUuYyBiL2RyaXZlcnMvbmV0L3NuaV9hdmUuYwppbmRleCBhYjUx
NTUyZWQ4Li4wYTM2OGM2ZDAzIDEwMDY0NAotLS0gYS9kcml2ZXJzL25ldC9zbmlfYXZlLmMKKysr
IGIvZHJpdmVycy9uZXQvc25pX2F2ZS5jCkBAIC03MzgsNyArNzM4LDYgQEAgc3RhdGljIGludCBh
dmVfb2ZfdG9fcGxhdChzdHJ1Y3QgdWRldmljZSAqZGV2KQogCXN0cnVjdCBldGhfcGRhdGEgKnBk
YXRhID0gZGV2X2dldF9wbGF0KGRldik7CiAJc3RydWN0IGF2ZV9wcml2YXRlICpwcml2ID0gZGV2
X2dldF9wcml2KGRldik7CiAJc3RydWN0IG9mbm9kZV9waGFuZGxlX2FyZ3MgYXJnczsKLQljb25z
dCBjaGFyICpwaHlfbW9kZTsKIAljb25zdCB1MzIgKnZhbHA7CiAJaW50IHJldCwgbmMsIG5yOwog
CWNvbnN0IGNoYXIgKm5hbWU7CkBAIC03NDgsMTUgKzc0NywxMCBAQCBzdGF0aWMgaW50IGF2ZV9v
Zl90b19wbGF0KHN0cnVjdCB1ZGV2aWNlICpkZXYpCiAJCXJldHVybiAtRUlOVkFMOwogCiAJcGRh
dGEtPmlvYmFzZSA9IGRldl9yZWFkX2FkZHIoZGV2KTsKLQlwZGF0YS0+cGh5X2ludGVyZmFjZSA9
IC0xOwotCXBoeV9tb2RlID0gZmR0X2dldHByb3AoZ2QtPmZkdF9ibG9iLCBkZXZfb2Zfb2Zmc2V0
KGRldiksICJwaHktbW9kZSIsCi0JCQkgICAgICAgTlVMTCk7Ci0JaWYgKHBoeV9tb2RlKQotCQlw
ZGF0YS0+cGh5X2ludGVyZmFjZSA9IHBoeV9nZXRfaW50ZXJmYWNlX2J5X25hbWUocGh5X21vZGUp
OwotCWlmIChwZGF0YS0+cGh5X2ludGVyZmFjZSA9PSAtMSkgewotCQlkZXZfZXJyKGRldiwgIklu
dmFsaWQgUEhZIGludGVyZmFjZSAnJXMnXG4iLCBwaHlfbW9kZSk7CisKKwlwZGF0YS0+cGh5X2lu
dGVyZmFjZSA9IGRldl9yZWFkX3BoeV9tb2RlKGRldik7CisJaWYgKHBkYXRhLT5waHlfaW50ZXJm
YWNlID09IFBIWV9JTlRFUkZBQ0VfTU9ERV9OT05FKQogCQlyZXR1cm4gLUVJTlZBTDsKLQl9CiAK
IAlwZGF0YS0+bWF4X3NwZWVkID0gMDsKIAl2YWxwID0gZmR0X2dldHByb3AoZ2QtPmZkdF9ibG9i
LCBkZXZfb2Zfb2Zmc2V0KGRldiksICJtYXgtc3BlZWQiLApkaWZmIC0tZ2l0IGEvZHJpdmVycy9u
ZXQvc25pX25ldHNlYy5jIGIvZHJpdmVycy9uZXQvc25pX25ldHNlYy5jCmluZGV4IDQ5MDEzMjFk
MGMuLjY5M2ZkM2EzNWQgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvbmV0L3NuaV9uZXRzZWMuYworKysg
Yi9kcml2ZXJzL25ldC9zbmlfbmV0c2VjLmMKQEAgLTEwMjksMTkgKzEwMjksMTMgQEAgc3RhdGlj
IGludCBuZXRzZWNfb2ZfdG9fcGxhdChzdHJ1Y3QgdWRldmljZSAqZGV2KQogCXN0cnVjdCBldGhf
cGRhdGEgKnBkYXRhID0gZGV2X2dldF9wbGF0KGRldik7CiAJc3RydWN0IG5ldHNlY19wcml2ICpw
cml2ID0gZGV2X2dldF9wcml2KGRldik7CiAJc3RydWN0IG9mbm9kZV9waGFuZGxlX2FyZ3MgcGhh
bmRsZV9hcmdzOwotCWNvbnN0IGNoYXIgKnBoeV9tb2RlOwogCiAJcGRhdGEtPmlvYmFzZSA9IGRl
dl9yZWFkX2FkZHJfaW5kZXgoZGV2LCAwKTsKIAlwcml2LT5lZXByb21fYmFzZSA9IGRldl9yZWFk
X2FkZHJfaW5kZXgoZGV2LCAxKSAtIEVFUlBST01fTUFQX09GRlNFVDsKIAotCXBkYXRhLT5waHlf
aW50ZXJmYWNlID0gLTE7Ci0JcGh5X21vZGUgPSBkZXZfcmVhZF9wcm9wKGRldiwgInBoeS1tb2Rl
IiwgTlVMTCk7Ci0JaWYgKHBoeV9tb2RlKQotCQlwZGF0YS0+cGh5X2ludGVyZmFjZSA9IHBoeV9n
ZXRfaW50ZXJmYWNlX2J5X25hbWUocGh5X21vZGUpOwotCWlmIChwZGF0YS0+cGh5X2ludGVyZmFj
ZSA9PSAtMSkgewotCQlwcl9lcnIoIiVzOiBJbnZhbGlkIFBIWSBpbnRlcmZhY2UgJyVzJ1xuIiwg
X19mdW5jX18sIHBoeV9tb2RlKTsKKwlwZGF0YS0+cGh5X2ludGVyZmFjZSA9IGRldl9yZWFkX3Bo
eV9tb2RlKGRldik7CisJaWYgKHBkYXRhLT5waHlfaW50ZXJmYWNlID09IFBIWV9JTlRFUkZBQ0Vf
TU9ERV9OT05FKQogCQlyZXR1cm4gLUVJTlZBTDsKLQl9CiAKIAlpZiAoIWRldl9yZWFkX3BoYW5k
bGVfd2l0aF9hcmdzKGRldiwgInBoeS1oYW5kbGUiLCBOVUxMLCAwLCAwLAogCQkJCQkmcGhhbmRs
ZV9hcmdzKSkKZGlmZiAtLWdpdCBhL2RyaXZlcnMvbmV0L3N1bjhpX2VtYWMuYyBiL2RyaXZlcnMv
bmV0L3N1bjhpX2VtYWMuYwppbmRleCAyZTI0ZDEyMjE0Li41NjU0YTM0MzBlIDEwMDY0NAotLS0g
YS9kcml2ZXJzL25ldC9zdW44aV9lbWFjLmMKKysrIGIvZHJpdmVycy9uZXQvc3VuOGlfZW1hYy5j
CkBAIC04ODIsNyArODgyLDYgQEAgc3RhdGljIGludCBzdW44aV9lbWFjX2V0aF9vZl90b19wbGF0
KHN0cnVjdCB1ZGV2aWNlICpkZXYpCiAJc3RydWN0IHN1bjhpX2V0aF9wZGF0YSAqc3VuOGlfcGRh
dGEgPSBkZXZfZ2V0X3BsYXQoZGV2KTsKIAlzdHJ1Y3QgZXRoX3BkYXRhICpwZGF0YSA9ICZzdW44
aV9wZGF0YS0+ZXRoX3BkYXRhOwogCXN0cnVjdCBlbWFjX2V0aF9kZXYgKnByaXYgPSBkZXZfZ2V0
X3ByaXYoZGV2KTsKLQljb25zdCBjaGFyICpwaHlfbW9kZTsKIAljb25zdCBmZHQzMl90ICpyZWc7
CiAJaW50IG5vZGUgPSBkZXZfb2Zfb2Zmc2V0KGRldik7CiAJaW50IG9mZnNldCA9IDA7CkBAIC05
NDYsMTYgKzk0NSwxMCBAQCBzdGF0aWMgaW50IHN1bjhpX2VtYWNfZXRoX29mX3RvX3BsYXQoc3Ry
dWN0IHVkZXZpY2UgKmRldikKIAl9CiAJcHJpdi0+cGh5YWRkciA9IGZkdGRlY19nZXRfaW50KGdk
LT5mZHRfYmxvYiwgb2Zmc2V0LCAicmVnIiwgLTEpOwogCi0JcGh5X21vZGUgPSBmZHRfZ2V0cHJv
cChnZC0+ZmR0X2Jsb2IsIG5vZGUsICJwaHktbW9kZSIsIE5VTEwpOwotCi0JaWYgKHBoeV9tb2Rl
KQotCQlwZGF0YS0+cGh5X2ludGVyZmFjZSA9IHBoeV9nZXRfaW50ZXJmYWNlX2J5X25hbWUocGh5
X21vZGUpOworCXBkYXRhLT5waHlfaW50ZXJmYWNlID0gZGV2X3JlYWRfcGh5X21vZGUoZGV2KTsK
IAlwcmludGYoInBoeSBpbnRlcmZhY2UlZFxuIiwgcGRhdGEtPnBoeV9pbnRlcmZhY2UpOwotCi0J
aWYgKHBkYXRhLT5waHlfaW50ZXJmYWNlID09IC0xKSB7Ci0JCWRlYnVnKCIlczogSW52YWxpZCBQ
SFkgaW50ZXJmYWNlICclcydcbiIsIF9fZnVuY19fLCBwaHlfbW9kZSk7CisJaWYgKHBkYXRhLT5w
aHlfaW50ZXJmYWNlID09IFBIWV9JTlRFUkZBQ0VfTU9ERV9OT05FKQogCQlyZXR1cm4gLUVJTlZB
TDsKLQl9CiAKIAlpZiAocHJpdi0+dmFyaWFudCA9PSBIM19FTUFDKSB7CiAJCXJldCA9IHN1bjhp
X2hhbmRsZV9pbnRlcm5hbF9waHkoZGV2LCBwcml2KTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvbmV0
L3RpL2FtNjUtY3Bzdy1udXNzLmMgYi9kcml2ZXJzL25ldC90aS9hbTY1LWNwc3ctbnVzcy5jCmlu
ZGV4IDg3ZjUxYjNiOTkuLmMxZGEzMzQ3MzkgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvbmV0L3RpL2Ft
NjUtY3Bzdy1udXNzLmMKKysrIGIvZHJpdmVycy9uZXQvdGkvYW02NS1jcHN3LW51c3MuYwpAQCAt
NjAyLDIxICs2MDIsMTQgQEAgc3RhdGljIGludCBhbTY1X2Nwc3dfb2ZkYXRhX3BhcnNlX3BoeShz
dHJ1Y3QgdWRldmljZSAqZGV2KQogCXN0cnVjdCBldGhfcGRhdGEgKnBkYXRhID0gZGV2X2dldF9w
bGF0KGRldik7CiAJc3RydWN0IGFtNjVfY3Bzd19wcml2ICpwcml2ID0gZGV2X2dldF9wcml2KGRl
dik7CiAJc3RydWN0IG9mbm9kZV9waGFuZGxlX2FyZ3Mgb3V0X2FyZ3M7Ci0JY29uc3QgY2hhciAq
cGh5X21vZGU7CiAJaW50IHJldCA9IDA7CiAKIAlkZXZfcmVhZF91MzIoZGV2LCAicmVnIiwgJnBy
aXYtPnBvcnRfaWQpOwogCi0JcGh5X21vZGUgPSBkZXZfcmVhZF9zdHJpbmcoZGV2LCAicGh5LW1v
ZGUiKTsKLQlpZiAocGh5X21vZGUpIHsKLQkJcGRhdGEtPnBoeV9pbnRlcmZhY2UgPQotCQkJCXBo
eV9nZXRfaW50ZXJmYWNlX2J5X25hbWUocGh5X21vZGUpOwotCQlpZiAocGRhdGEtPnBoeV9pbnRl
cmZhY2UgPT0gLTEpIHsKLQkJCWRldl9lcnIoZGV2LCAiSW52YWxpZCBQSFkgbW9kZSAnJXMnLCBw
b3J0ICV1XG4iLAotCQkJCXBoeV9tb2RlLCBwcml2LT5wb3J0X2lkKTsKLQkJCXJldCA9IC1FSU5W
QUw7Ci0JCQlnb3RvIG91dDsKLQkJfQorCXBkYXRhLT5waHlfaW50ZXJmYWNlID0gZGV2X3JlYWRf
cGh5X21vZGUoZGV2KTsKKwlpZiAocGRhdGEtPnBoeV9pbnRlcmZhY2UgPT0gUEhZX0lOVEVSRkFD
RV9NT0RFX05PTkUpIHsKKwkJZGV2X2VycihkZXYsICJJbnZhbGlkIFBIWSBtb2RlLCBwb3J0ICV1
XG4iLCBwcml2LT5wb3J0X2lkKTsKKwkJcmV0dXJuIC1FSU5WQUw7CiAJfQogCiAJZGV2X3JlYWRf
dTMyKGRldiwgIm1heC1zcGVlZCIsICh1MzIgKikmcGRhdGEtPm1heF9zcGVlZCk7CmRpZmYgLS1n
aXQgYS9kcml2ZXJzL25ldC90aS9jcHN3LmMgYi9kcml2ZXJzL25ldC90aS9jcHN3LmMKaW5kZXgg
NjhmNDE5MWZlOS4uNWI3YmFiNzM0ZSAxMDA2NDQKLS0tIGEvZHJpdmVycy9uZXQvdGkvY3Bzdy5j
CisrKyBiL2RyaXZlcnMvbmV0L3RpL2Nwc3cuYwpAQCAtMTE5NCwxNSArMTE5NCwxMiBAQCBzdGF0
aWMgdm9pZCBjcHN3X2V0aF9vZl9wYXJzZV9zbGF2ZShzdHJ1Y3QgY3Bzd19wbGF0Zm9ybV9kYXRh
ICpkYXRhLAogewogCXN0cnVjdCBvZm5vZGVfcGhhbmRsZV9hcmdzIG91dF9hcmdzOwogCXN0cnVj
dCBjcHN3X3NsYXZlX2RhdGEgKnNsYXZlX2RhdGE7Ci0JY29uc3QgY2hhciAqcGh5X21vZGU7CiAJ
dTMyIHBoeV9pZFsyXTsKIAlpbnQgcmV0OwogCiAJc2xhdmVfZGF0YSA9ICZkYXRhLT5zbGF2ZV9k
YXRhW3NsYXZlX2luZGV4XTsKIAotCXBoeV9tb2RlID0gb2Zub2RlX3JlYWRfc3RyaW5nKHN1Ym5v
ZGUsICJwaHktbW9kZSIpOwotCWlmIChwaHlfbW9kZSkKLQkJc2xhdmVfZGF0YS0+cGh5X2lmID0g
cGh5X2dldF9pbnRlcmZhY2VfYnlfbmFtZShwaHlfbW9kZSk7CisJc2xhdmVfZGF0YS0+cGh5X2lm
ID0gb2Zub2RlX3JlYWRfcGh5X21vZGUoc3Vibm9kZSk7CiAKIAlyZXQgPSBvZm5vZGVfcGFyc2Vf
cGhhbmRsZV93aXRoX2FyZ3Moc3Vibm9kZSwgInBoeS1oYW5kbGUiLAogCQkJCQkgICAgIE5VTEws
IDAsIDAsICZvdXRfYXJncyk7CkBAIC0xMzQ4LDExICsxMzQ1LDggQEAgc3RhdGljIGludCBjcHN3
X2V0aF9vZl90b19wbGF0KHN0cnVjdCB1ZGV2aWNlICpkZXYpCiAJfQogCiAJcGRhdGEtPnBoeV9p
bnRlcmZhY2UgPSBkYXRhLT5zbGF2ZV9kYXRhW2RhdGEtPmFjdGl2ZV9zbGF2ZV0ucGh5X2lmOwot
CWlmIChwZGF0YS0+cGh5X2ludGVyZmFjZSA9PSAtMSkgewotCQlkZWJ1ZygiJXM6IEludmFsaWQg
UEhZIGludGVyZmFjZSAnJXMnXG4iLCBfX2Z1bmNfXywKLQkJICAgICAgcGh5X3N0cmluZ19mb3Jf
aW50ZXJmYWNlKHBkYXRhLT5waHlfaW50ZXJmYWNlKSk7CisJaWYgKHBkYXRhLT5waHlfaW50ZXJm
YWNlID09IFBIWV9JTlRFUkZBQ0VfTU9ERV9OT05FKQogCQlyZXR1cm4gLUVJTlZBTDsKLQl9CiAK
IAlyZXR1cm4gMDsKIH0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvbmV0L3RpL2tleXN0b25lX25ldC5j
IGIvZHJpdmVycy9uZXQvdGkva2V5c3RvbmVfbmV0LmMKaW5kZXggNWU4ZjY4M2MyOS4uYjU1ZTdk
YTRjMSAxMDA2NDQKLS0tIGEvZHJpdmVycy9uZXQvdGkva2V5c3RvbmVfbmV0LmMKKysrIGIvZHJp
dmVycy9uZXQvdGkva2V5c3RvbmVfbmV0LmMKQEAgLTY4Nyw3ICs2ODcsNiBAQCBzdGF0aWMgaW50
IGtzMl9ldGhfcGFyc2Vfc2xhdmVfaW50ZXJmYWNlKGludCBuZXRjcCwgaW50IHNsYXZlLAogCWlu
dCBwaHk7CiAJaW50IGRtYV9jb3VudDsKIAl1MzIgZG1hX2NoYW5uZWxbOF07Ci0JY29uc3QgY2hh
ciAqcGh5X21vZGU7CiAKIAlwcml2LT5zbGF2ZV9wb3J0ID0gZmR0ZGVjX2dldF9pbnQoZmR0LCBz
bGF2ZSwgInNsYXZlLXBvcnQiLCAtMSk7CiAJcHJpdi0+bmV0X3J4X2J1ZmZzLnJ4X2Zsb3cgPSBw
cml2LT5zbGF2ZV9wb3J0ICogODsKQEAgLTcyOCwyMCArNzI3LDE5IEBAIHN0YXRpYyBpbnQga3My
X2V0aF9wYXJzZV9zbGF2ZV9pbnRlcmZhY2UoaW50IG5ldGNwLCBpbnQgc2xhdmUsCiAJCXByaXYt
PnNnbWlpX2xpbmtfdHlwZSA9IFNHTUlJX0xJTktfTUFDX1BIWTsKIAkJcHJpdi0+aGFzX21kaW8g
PSB0cnVlOwogCX0gZWxzZSBpZiAocHJpdi0+bGlua190eXBlID09IExJTktfVFlQRV9SR01JSV9M
SU5LX01BQ19QSFkpIHsKLQkJcGh5X21vZGUgPSBmZHRfZ2V0cHJvcChmZHQsIHNsYXZlLCAicGh5
LW1vZGUiLCBOVUxMKTsKLQkJaWYgKHBoeV9tb2RlKSB7Ci0JCQlwcml2LT5waHlfaWYgPSBwaHlf
Z2V0X2ludGVyZmFjZV9ieV9uYW1lKHBoeV9tb2RlKTsKLQkJCWlmIChwcml2LT5waHlfaWYgIT0g
UEhZX0lOVEVSRkFDRV9NT0RFX1JHTUlJICYmCi0JCQkgICAgcHJpdi0+cGh5X2lmICE9IFBIWV9J
TlRFUkZBQ0VfTU9ERV9SR01JSV9JRCAmJgotCQkJICAgIHByaXYtPnBoeV9pZiAhPSBQSFlfSU5U
RVJGQUNFX01PREVfUkdNSUlfUlhJRCAmJgotCQkJICAgIHByaXYtPnBoeV9pZiAhPSBQSFlfSU5U
RVJGQUNFX01PREVfUkdNSUlfVFhJRCkgewotCQkJCXByX2VycigiaW52YWxpZCBwaHktbW9kZVxu
Iik7Ci0JCQkJcmV0dXJuIC1FSU5WQUw7Ci0JCQl9Ci0JCX0gZWxzZSB7CisJCXByaXYtPnBoeV9p
ZiA9IG9mbm9kZV9yZWFkX3BoeV9tb2RlKG9mZnNldF90b19vZm5vZGUoc2xhdmUpKTsKKwkJaWYg
KHByaXYtPnBoeV9pZiA9PSBQSFlfSU5URVJGQUNFX01PREVfTk9ORSkKIAkJCXByaXYtPnBoeV9p
ZiA9IFBIWV9JTlRFUkZBQ0VfTU9ERV9SR01JSTsKLQkJfQogCQlwZGF0YS0+cGh5X2ludGVyZmFj
ZSA9IHByaXYtPnBoeV9pZjsKKworCQlpZiAocHJpdi0+cGh5X2lmICE9IFBIWV9JTlRFUkZBQ0Vf
TU9ERV9SR01JSSAmJgorCQkgICAgcHJpdi0+cGh5X2lmICE9IFBIWV9JTlRFUkZBQ0VfTU9ERV9S
R01JSV9JRCAmJgorCQkgICAgcHJpdi0+cGh5X2lmICE9IFBIWV9JTlRFUkZBQ0VfTU9ERV9SR01J
SV9SWElEICYmCisJCSAgICBwcml2LT5waHlfaWYgIT0gUEhZX0lOVEVSRkFDRV9NT0RFX1JHTUlJ
X1RYSUQpIHsKKwkJCXByX2VycigiaW52YWxpZCBwaHktbW9kZVxuIik7CisJCQlyZXR1cm4gLUVJ
TlZBTDsKKwkJfQorCiAJCXByaXYtPmhhc19tZGlvID0gdHJ1ZTsKIAl9CiAKZGlmZiAtLWdpdCBh
L2RyaXZlcnMvbmV0L3RzZWMuYyBiL2RyaXZlcnMvbmV0L3RzZWMuYwppbmRleCBiZWNhODg2YjI1
Li5mZWMwNTFlYmI3IDEwMDY0NAotLS0gYS9kcml2ZXJzL25ldC90c2VjLmMKKysrIGIvZHJpdmVy
cy9uZXQvdHNlYy5jCkBAIC04MzQsNyArODM0LDYgQEAgaW50IHRzZWNfcHJvYmUoc3RydWN0IHVk
ZXZpY2UgKmRldikKIAlzdHJ1Y3Qgb2Zub2RlX3BoYW5kbGVfYXJncyBwaGFuZGxlX2FyZ3M7CiAJ
dTMyIHRiaWFkZHIgPSBDT05GSUdfU1lTX1RCSVBBX1ZBTFVFOwogCXN0cnVjdCB0c2VjX2RhdGEg
KmRhdGE7Ci0JY29uc3QgY2hhciAqcGh5X21vZGU7CiAJb2Zub2RlIHBhcmVudCwgY2hpbGQ7CiAJ
ZmR0X2FkZHJfdCByZWc7CiAJdTMyIG1heF9zcGVlZDsKQEAgLTg5NCwxMiArODkzLDggQEAgaW50
IHRzZWNfcHJvYmUoc3RydWN0IHVkZXZpY2UgKmRldikKIAogCXByaXYtPnRiaWFkZHIgPSB0Ymlh
ZGRyOwogCi0JcGh5X21vZGUgPSBkZXZfcmVhZF9wcm9wKGRldiwgInBoeS1jb25uZWN0aW9uLXR5
cGUiLCBOVUxMKTsKLQlpZiAoIXBoeV9tb2RlKQotCQlwaHlfbW9kZSA9IGRldl9yZWFkX3Byb3Ao
ZGV2LCAicGh5LW1vZGUiLCBOVUxMKTsKLQlpZiAocGh5X21vZGUpCi0JCXBkYXRhLT5waHlfaW50
ZXJmYWNlID0gcGh5X2dldF9pbnRlcmZhY2VfYnlfbmFtZShwaHlfbW9kZSk7Ci0JaWYgKHBkYXRh
LT5waHlfaW50ZXJmYWNlID09IC0xKQorCXBkYXRhLT5waHlfaW50ZXJmYWNlID0gZGV2X3JlYWRf
cGh5X21vZGUoZGV2KTsKKwlpZiAocGRhdGEtPnBoeV9pbnRlcmZhY2UgPT0gUEhZX0lOVEVSRkFD
RV9NT0RFX05PTkUpCiAJCXBkYXRhLT5waHlfaW50ZXJmYWNlID0gdHNlY19nZXRfaW50ZXJmYWNl
KHByaXYpOwogCiAJcHJpdi0+aW50ZXJmYWNlID0gcGRhdGEtPnBoeV9pbnRlcmZhY2U7CmRpZmYg
LS1naXQgYS9kcml2ZXJzL25ldC94aWxpbnhfYXhpX2VtYWMuYyBiL2RyaXZlcnMvbmV0L3hpbGlu
eF9heGlfZW1hYy5jCmluZGV4IGYyMWFkZGI0ZDAuLjAyZDEzYzNlMGEgMTAwNjQ0Ci0tLSBhL2Ry
aXZlcnMvbmV0L3hpbGlueF9heGlfZW1hYy5jCisrKyBiL2RyaXZlcnMvbmV0L3hpbGlueF9heGlf
ZW1hYy5jCkBAIC04MjEsNyArODIxLDYgQEAgc3RhdGljIGludCBheGlfZW1hY19vZl90b19wbGF0
KHN0cnVjdCB1ZGV2aWNlICpkZXYpCiAJc3RydWN0IGV0aF9wZGF0YSAqcGRhdGEgPSAmcGxhdC0+
ZXRoX3BkYXRhOwogCWludCBub2RlID0gZGV2X29mX29mZnNldChkZXYpOwogCWludCBvZmZzZXQg
PSAwOwotCWNvbnN0IGNoYXIgKnBoeV9tb2RlOwogCiAJcGRhdGEtPmlvYmFzZSA9IGRldl9yZWFk
X2FkZHIoZGV2KTsKIAlwbGF0LT5tYWN0eXBlID0gZGV2X2dldF9kcml2ZXJfZGF0YShkZXYpOwpA
QCAtODUwLDE0ICs4NDksOSBAQCBzdGF0aWMgaW50IGF4aV9lbWFjX29mX3RvX3BsYXQoc3RydWN0
IHVkZXZpY2UgKmRldikKIAkJCXBsYXQtPnBoeV9vZl9oYW5kbGUgPSBvZmZzZXQ7CiAJCX0KIAot
CQlwaHlfbW9kZSA9IGZkdF9nZXRwcm9wKGdkLT5mZHRfYmxvYiwgbm9kZSwgInBoeS1tb2RlIiwg
TlVMTCk7Ci0JCWlmIChwaHlfbW9kZSkKLQkJCXBkYXRhLT5waHlfaW50ZXJmYWNlID0gcGh5X2dl
dF9pbnRlcmZhY2VfYnlfbmFtZShwaHlfbW9kZSk7Ci0JCWlmIChwZGF0YS0+cGh5X2ludGVyZmFj
ZSA9PSAtMSkgewotCQkJcHJpbnRmKCIlczogSW52YWxpZCBQSFkgaW50ZXJmYWNlICclcydcbiIs
IF9fZnVuY19fLAotCQkJICAgICAgIHBoeV9tb2RlKTsKKwkJcGRhdGEtPnBoeV9pbnRlcmZhY2Ug
PSBkZXZfcmVhZF9waHlfbW9kZShkZXYpOworCQlpZiAocGRhdGEtPnBoeV9pbnRlcmZhY2UgPT0g
UEhZX0lOVEVSRkFDRV9NT0RFX05PTkUpCiAJCQlyZXR1cm4gLUVJTlZBTDsKLQkJfQogCiAJCXBs
YXQtPmV0aF9oYXNub2J1ZiA9IGZkdGRlY19nZXRfYm9vbChnZC0+ZmR0X2Jsb2IsIG5vZGUsCiAJ
CQkJCQkgICAgICJ4bG54LGV0aC1oYXNub2J1ZiIpOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9uZXQv
enlucV9nZW0uYyBiL2RyaXZlcnMvbmV0L3p5bnFfZ2VtLmMKaW5kZXggMzExOGQxNDcyNi4uMDA2
Mjg1MTEzNCAxMDA2NDQKLS0tIGEvZHJpdmVycy9uZXQvenlucV9nZW0uYworKysgYi9kcml2ZXJz
L25ldC96eW5xX2dlbS5jCkBAIC04MjcsNyArODI3LDYgQEAgc3RhdGljIGludCB6eW5xX2dlbV9v
Zl90b19wbGF0KHN0cnVjdCB1ZGV2aWNlICpkZXYpCiAJc3RydWN0IGV0aF9wZGF0YSAqcGRhdGEg
PSBkZXZfZ2V0X3BsYXQoZGV2KTsKIAlzdHJ1Y3QgenlucV9nZW1fcHJpdiAqcHJpdiA9IGRldl9n
ZXRfcHJpdihkZXYpOwogCXN0cnVjdCBvZm5vZGVfcGhhbmRsZV9hcmdzIHBoYW5kbGVfYXJnczsK
LQljb25zdCBjaGFyICpwaHlfbW9kZTsKIAogCXBkYXRhLT5pb2Jhc2UgPSAocGh5c19hZGRyX3Qp
ZGV2X3JlYWRfYWRkcihkZXYpOwogCXByaXYtPmlvYmFzZSA9IChzdHJ1Y3QgenlucV9nZW1fcmVn
cyAqKXBkYXRhLT5pb2Jhc2U7CkBAIC04NTksMTMgKzg1OCw5IEBAIHN0YXRpYyBpbnQgenlucV9n
ZW1fb2ZfdG9fcGxhdChzdHJ1Y3QgdWRldmljZSAqZGV2KQogCQl9CiAJfQogCi0JcGh5X21vZGUg
PSBkZXZfcmVhZF9wcm9wKGRldiwgInBoeS1tb2RlIiwgTlVMTCk7Ci0JaWYgKHBoeV9tb2RlKQot
CQlwZGF0YS0+cGh5X2ludGVyZmFjZSA9IHBoeV9nZXRfaW50ZXJmYWNlX2J5X25hbWUocGh5X21v
ZGUpOwotCWlmIChwZGF0YS0+cGh5X2ludGVyZmFjZSA9PSAtMSkgewotCQlkZWJ1ZygiJXM6IElu
dmFsaWQgUEhZIGludGVyZmFjZSAnJXMnXG4iLCBfX2Z1bmNfXywgcGh5X21vZGUpOworCXBkYXRh
LT5waHlfaW50ZXJmYWNlID0gZGV2X3JlYWRfcGh5X21vZGUoZGV2KTsKKwlpZiAocGRhdGEtPnBo
eV9pbnRlcmZhY2UgPT0gUEhZX0lOVEVSRkFDRV9NT0RFX05PTkUpCiAJCXJldHVybiAtRUlOVkFM
OwotCX0KIAlwcml2LT5pbnRlcmZhY2UgPSBwZGF0YS0+cGh5X2ludGVyZmFjZTsKIAogCXByaXYt
PmludF9wY3MgPSBkZXZfcmVhZF9ib29sKGRldiwgImlzLWludGVybmFsLXBjc3BtYSIpOwpkaWZm
IC0tZ2l0IGEvaW5jbHVkZS9kbS9vZm5vZGUuaCBiL2luY2x1ZGUvZG0vb2Zub2RlLmgKaW5kZXgg
ODE2NDM4NjA0My4uOGEzOGMxNDNmOSAxMDA2NDQKLS0tIGEvaW5jbHVkZS9kbS9vZm5vZGUuaAor
KysgYi9pbmNsdWRlL2RtL29mbm9kZS5oCkBAIC0xMiw2ICsxMiw3IEBACiAjaW5jbHVkZSA8ZG0v
b2YuaD4KICNpbmNsdWRlIDxkbS9vZl9hY2Nlc3MuaD4KICNpbmNsdWRlIDxsb2cuaD4KKyNpbmNs
dWRlIDxwaHlfaW50ZXJmYWNlLmg+CiAKIC8qIEVuYWJsZSBjaGVja3MgdG8gcHJvdGVjdCBhZ2Fp
bnN0IGludmFsaWQgY2FsbHMgKi8KICN1bmRlZiBPRl9DSEVDS1MKQEAgLTEyMTgsNCArMTIxOSwx
NiBAQCBjb25zdCBjaGFyICpvZm5vZGVfY29uZl9yZWFkX3N0cihjb25zdCBjaGFyICpwcm9wX25h
bWUpOwogICovCiBvZm5vZGUgb2Zub2RlX2dldF9waHlfbm9kZShvZm5vZGUgZXRoX25vZGUpOwog
CisvKioKKyAqIG9mbm9kZV9yZWFkX3BoeV9tb2RlKCkgLSBSZWFkIFBIWSBjb25uZWN0aW9uIHR5
cGUgZnJvbSBhIE1BQyBub2RlCisgKgorICogVGhpcyBmdW5jdGlvbiBwYXJzZXMgdGhlICJwaHkt
bW9kZSIgLyAicGh5LWNvbm5lY3Rpb24tdHlwZSIgcHJvcGVydHkgYW5kCisgKiByZXR1cm5zIHRo
ZSBjb3JyZXNwb25kaW5nIFBIWSBpbnRlcmZhY2UgdHlwZS4KKyAqCisgKiBAbWFjX25vZGU6CW9m
bm9kZSBjb250YWluaW5nIHRoZSBwcm9wZXJ0eQorICogUmV0dXJuOiBvbmUgb2YgUEhZX0lOVEVS
RkFDRV9NT0RFXyogY29uc3RhbnRzLCBQSFlfSU5URVJGQUNFX01PREVfTk9ORSBvbgorICoJICAg
ZXJyb3IKKyAqLworcGh5X2ludGVyZmFjZV90IG9mbm9kZV9yZWFkX3BoeV9tb2RlKG9mbm9kZSBt
YWNfbm9kZSk7CisKICNlbmRpZgpkaWZmIC0tZ2l0IGEvaW5jbHVkZS9kbS9yZWFkLmggYi9pbmNs
dWRlL2RtL3JlYWQuaAppbmRleCA4OTllYjgxM2ZkLi5iZmEyNjQ1OTY3IDEwMDY0NAotLS0gYS9p
bmNsdWRlL2RtL3JlYWQuaAorKysgYi9pbmNsdWRlL2RtL3JlYWQuaApAQCAtNzU3LDYgKzc1Nywx
OCBAQCBpbnQgZGV2X2RlY29kZV9kaXNwbGF5X3RpbWluZyhjb25zdCBzdHJ1Y3QgdWRldmljZSAq
ZGV2LCBpbnQgaW5kZXgsCiAgKi8KIG9mbm9kZSBkZXZfZ2V0X3BoeV9ub2RlKGNvbnN0IHN0cnVj
dCB1ZGV2aWNlICpkZXYpOwogCisvKioKKyAqIGRldl9yZWFkX3BoeV9tb2RlKCkgLSBSZWFkIFBI
WSBjb25uZWN0aW9uIHR5cGUgZnJvbSBhIE1BQworICoKKyAqIFRoaXMgZnVuY3Rpb24gcGFyc2Vz
IHRoZSAicGh5LW1vZGUiIC8gInBoeS1jb25uZWN0aW9uLXR5cGUiIHByb3BlcnR5IGFuZAorICog
cmV0dXJucyB0aGUgY29ycmVzcG9uZGluZyBQSFkgaW50ZXJmYWNlIHR5cGUuCisgKgorICogQGRl
djogZGV2aWNlIHJlcHJlc2VudGluZyB0aGUgTUFDCisgKiBSZXR1cm46IG9uZSBvZiBQSFlfSU5U
RVJGQUNFX01PREVfKiBjb25zdGFudHMsIFBIWV9JTlRFUkZBQ0VfTU9ERV9OT05FIG9uCisgKgkg
ICBlcnJvcgorICovCitwaHlfaW50ZXJmYWNlX3QgZGV2X3JlYWRfcGh5X21vZGUoY29uc3Qgc3Ry
dWN0IHVkZXZpY2UgKmRldik7CisKICNlbHNlIC8qIENPTkZJR19ETV9ERVZfUkVBRF9JTkxJTkUg
aXMgZW5hYmxlZCAqLwogI2luY2x1ZGUgPGFzbS9nbG9iYWxfZGF0YS5oPgogCkBAIC0xMTExLDYg
KzExMjMsMTEgQEAgc3RhdGljIGlubGluZSBvZm5vZGUgZGV2X2dldF9waHlfbm9kZShjb25zdCBz
dHJ1Y3QgdWRldmljZSAqZGV2KQogCXJldHVybiBvZm5vZGVfZ2V0X3BoeV9ub2RlKGRldl9vZm5v
ZGUoZGV2KSk7CiB9CiAKK3N0YXRpYyBpbmxpbmUgcGh5X2ludGVyZmFjZV90IGRldl9yZWFkX3Bo
eV9tb2RlKGNvbnN0IHN0cnVjdCB1ZGV2aWNlICpkZXYpCit7CisJcmV0dXJuIG9mbm9kZV9yZWFk
X3BoeV9tb2RlKGRldl9vZm5vZGUoZGV2KSk7Cit9CisKICNlbmRpZiAvKiBDT05GSUdfRE1fREVW
X1JFQURfSU5MSU5FICovCiAKIC8qKgpkaWZmIC0tZ2l0IGEvaW5jbHVkZS9waHkuaCBiL2luY2x1
ZGUvcGh5LmgKaW5kZXggYzY2ZmQ0M2VhOC4uZGVlOGZiNWYyZSAxMDA2NDQKLS0tIGEvaW5jbHVk
ZS9waHkuaAorKysgYi9pbmNsdWRlL3BoeS5oCkBAIC01NDIsMTQgKzU0Miw2IEBAIGludCBwaHlf
eGlsaW54X2dtaWkycmdtaWlfaW5pdCh2b2lkKTsKIGludCBib2FyZF9waHlfY29uZmlnKHN0cnVj
dCBwaHlfZGV2aWNlICpwaHlkZXYpOwogaW50IGdldF9waHlfaWQoc3RydWN0IG1paV9kZXYgKmJ1
cywgaW50IGFkZHIsIGludCBkZXZhZCwgdTMyICpwaHlfaWQpOwogCi0vKioKLSAqIHBoeV9nZXRf
aW50ZXJmYWNlX2J5X25hbWUoKSAtIExvb2sgdXAgYSBQSFkgaW50ZXJmYWNlIG5hbWUKLSAqCi0g
KiBAc3RyOglQSFkgaW50ZXJmYWNlIG5hbWUsIGUuZy4gIm1paSIKLSAqIEByZXR1cm46IFBIWV9J
TlRFUkZBQ0VfTU9ERV8uLi4gdmFsdWUsIG9yIC0xIGlmIG5vdCBmb3VuZAotICovCi1pbnQgcGh5
X2dldF9pbnRlcmZhY2VfYnlfbmFtZShjb25zdCBjaGFyICpzdHIpOwotCiAvKioKICAqIHBoeV9p
bnRlcmZhY2VfaXNfcmdtaWkgLSBDb252ZW5pZW5jZSBmdW5jdGlvbiBmb3IgdGVzdGluZyBpZiBh
IFBIWSBpbnRlcmZhY2UKICAqIGlzIFJHTUlJIChhbGwgdmFyaWFudHMpCmRpZmYgLS1naXQgYS9u
ZXQvbWRpby11Y2xhc3MuYyBiL25ldC9tZGlvLXVjbGFzcy5jCmluZGV4IGJlZjgyODBlMjEuLjg3
NGY1OTQxM2EgMTAwNjQ0Ci0tLSBhL25ldC9tZGlvLXVjbGFzcy5jCisrKyBiL25ldC9tZGlvLXVj
bGFzcy5jCkBAIC0xNSwxMSArMTUsNiBAQAogI2luY2x1ZGUgPGRtL3VjbGFzcy1pbnRlcm5hbC5o
PgogI2luY2x1ZGUgPGxpbnV4L2NvbXBhdC5oPgogCi0vKiBEVCBub2RlIHByb3BlcnRpZXMgZm9y
IE1BQy1QSFkgaW50ZXJmYWNlICovCi1zdGF0aWMgY29uc3QgY2hhciAqIGNvbnN0IHBoeV9tb2Rl
X3N0cltdID0gewotCSJwaHktbW9kZSIsICJwaHktY29ubmVjdGlvbi10eXBlIgotfTsKLQogdm9p
ZCBkbV9tZGlvX3Byb2JlX2RldmljZXModm9pZCkKIHsKIAlzdHJ1Y3QgdWRldmljZSAqaXQ7CkBA
IC0xOTUsMjYgKzE5MCwxNSBAQCBvdXQ6CiAvKiBDb25uZWN0IHRvIGEgUEhZIGxpbmtlZCBpbiBl
dGggRFQgbm9kZSAqLwogc3RydWN0IHBoeV9kZXZpY2UgKmRtX2V0aF9waHlfY29ubmVjdChzdHJ1
Y3QgdWRldmljZSAqZXRoZGV2KQogewotCWNvbnN0IGNoYXIgKmlmX3N0cjsKIAlwaHlfaW50ZXJm
YWNlX3QgaW50ZXJmYWNlOwogCXN0cnVjdCBwaHlfZGV2aWNlICpwaHk7Ci0JaW50IGk7CiAKIAlp
ZiAoIWRldl9oYXNfb2Zub2RlKGV0aGRldikpIHsKIAkJZGVidWcoIiVzOiBzdXBwbGllZCBldGgg
ZGV2IGhhcyBubyBEVCBub2RlIVxuIiwgZXRoZGV2LT5uYW1lKTsKIAkJcmV0dXJuIE5VTEw7CiAJ
fQogCi0JaW50ZXJmYWNlID0gUEhZX0lOVEVSRkFDRV9NT0RFX05PTkU7Ci0JZm9yIChpID0gMDsg
aSA8IEFSUkFZX1NJWkUocGh5X21vZGVfc3RyKTsgaSsrKSB7Ci0JCWlmX3N0ciA9IGRldl9yZWFk
X3N0cmluZyhldGhkZXYsIHBoeV9tb2RlX3N0cltpXSk7Ci0JCWlmIChpZl9zdHIpIHsKLQkJCWlu
dGVyZmFjZSA9IHBoeV9nZXRfaW50ZXJmYWNlX2J5X25hbWUoaWZfc3RyKTsKLQkJCWJyZWFrOwot
CQl9Ci0JfQotCWlmIChpbnRlcmZhY2UgPCAwKQotCQlpbnRlcmZhY2UgPSBQSFlfSU5URVJGQUNF
X01PREVfTk9ORTsKKwlpbnRlcmZhY2UgPSBkZXZfcmVhZF9waHlfbW9kZShldGhkZXYpOwogCWlm
IChpbnRlcmZhY2UgPT0gUEhZX0lOVEVSRkFDRV9NT0RFX05PTkUpCiAJCWRldl9kYmcoZXRoZGV2
LCAiY2FuJ3QgZmluZCBpbnRlcmZhY2UgbW9kZSwgZGVmYXVsdCB0byBOT05FXG4iKTsKIAotLSAK
Mi4zNC4xCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpV
Ym9vdC1zdG0zMiBtYWlsaW5nIGxpc3QKVWJvb3Qtc3RtMzJAc3QtbWQtbWFpbG1hbi5zdG9ybXJl
cGx5LmNvbQpodHRwczovL3N0LW1kLW1haWxtYW4uc3Rvcm1yZXBseS5jb20vbWFpbG1hbi9saXN0
aW5mby91Ym9vdC1zdG0zMgo=
